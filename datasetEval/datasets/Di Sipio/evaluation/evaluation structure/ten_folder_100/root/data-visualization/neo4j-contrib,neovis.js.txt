b'# neovis.js\n\n[![CircleCI](https://circleci.com/gh/neo4j-contrib/neovis.js/tree/master.svg?style=svg)](https://circleci.com/gh/neo4j-contrib/neovis.js/tree/master)  [![npm version](https://badge.fury.io/js/neovis.js.svg)](https://badge.fury.io/js/neovis.js)\n\nGraph visualizations powered by vis.js with data from Neo4j.\n\n![](img/example-viz.png)\n\n## Features\n\n- [x] Connect to Neo4j instance to get live data\n- [x] User specified labels and property to be displayed\n- [x] User specified Cypher query to populate \n- [ ] Specify node property for url of image for node\n- [x] Specify edge property for edge thickness\n- [x] Specify node property for community / clustering\n- [x] Specify node property for node size\n- [ ] Configure popover\n\n\n## Install\n\nNeovis.js can be installed via npm:\n\n```\nnpm install --save neovis.js\n```\n\nyou can also obtain neovis.js via CDN:\n\n## CDN\n\nFor ease of use Neovis.js can be obtained from Neo4jLabs CDN:\n\n*Most recent release*\n\n```\n<script src="https://cdn.neo4jlabs.com/neovis.js/v1.2.1/neovis.js"></script>\n```\n\n*Version without neo4j-driver dependency*\n\n```\n<script src="https://cdn.neo4jlabs.com/neovis.js/v1.2.1/neovis-without-dependencies.js"></script>\n```\n\n## Quickstart Example\n\nLet\'s go through the steps to reproduce this visualization:\n\n![](img/example-viz.png)\n\n### Prepare Neo4j\n\nStart with a blank Neo4j instance, or spin up a blank [Neo4j Sandbox](https://neo4jsandbox.com). We\'ll load the Game of Thrones dataset, run:\n\n```\nLOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/mathbeveridge/asoiaf/master/data/asoiaf-all-edges.csv" AS row\nMERGE (src:Character {name: row.Source})\nMERGE (tgt:Character {name: row.Target})\nMERGE (src)-[r:INTERACTS]->(tgt) ON CREATE SET r.weight = toInteger(row.weight)\n```\n\nWe\'ve pre-calculated PageRank and ran a community detection algorithm to assign community ids for each Character. Let\'s load those next:\n\n```\nLOAD CSV WITH HEADERS FROM "https://raw.githubusercontent.com/johnymontana/neovis.js/master/examples/data/got-centralities.csv" AS row\nMATCH (c:Character {name: row.name})\nSET c.community = toInteger(row.community),\n    c.pagerank  = toFloat(row.pagerank)\n```\n\nOur graph now consists of `Character` nodes that are connected by an `INTERACTS` relationships. We can visualize the whole graph in Neo4j Browser by running:\n\n```\nMATCH p=(:Character)-[:INTERACTS]->(:Character)\nRETURN p\n```\n\n![](/img/got-neo4j-browser.png)\n\nWe can see characters that are connected and with the help of the force directed layout we can begin to see clusters in the graph. However, we want to visualize the centralities (PageRank) and community detection results that we also imported.\n\nSpecifically we would like:\n\n* Node size to be proportional to the Character\'s `pagerank` score. This will allow us to quickly identify important nodes in the network.\n* Node color to determined by the `community` property. This will allow us to visualize clusters.\n* Relationship thickeness should be proportional to the `weight` property on the `INTERACTS` relationship.\n\nNeovis.js, by combining the JavaScript driver for Neo4j and the vis.js visualization library will allow us to build this visualization.\n\n### index.html\n\nCreate a new html file:\n\n``` html\n<!doctype html>\n<html>\n    <head>\n        <title>Neovis.js Simple Example</title>\n        <style type="text/css">\n            html, body {\n                font: 16pt arial;\n            }\n    \n            #viz {\n                width: 900px;\n                height: 700px;\n                border: 1px solid lightgray;\n                font: 22pt arial;\n            }\n        </style>\n    </head>\n    <body onload="draw()">\n        <div id="viz"></div>\n    </body>    \n</html>\n\n```\n\nWe define some basic CSS to specify the boundaries of a `div` and then create a single `div` in the body. We also specify `onload="draw()"` so that the `draw()` function is called as soon as the body is loaded. \n\nWe need to pull in `neovis.js`:\n\n``` html\n<script src="https://rawgit.com/neo4j-contrib/neovis.js/master/dist/neovis.js"></script>\n```\n\nAnd define our draw() function:\n\n```\n<script type="text/javascript">\n\n        var viz;\n\n        function draw() {\n            var config = {\n                container_id: "viz",\n                server_url: "bolt://localhost:7687",\n                server_user: "neo4j",\n                server_password: "sorts-swims-burglaries",\n                labels: {\n                    "Character": {\n                        "caption": "name",\n                        "size": "pagerank",\n                        "community": "community"\n                    }\n                },\n                relationships: {\n                    "INTERACTS": {\n                        "thickness": "weight",\n                        "caption": false\n                    }\n                },\n                initial_cypher: "MATCH (n)-[r:INTERACTS]->(m) RETURN *"\n            };\n\n            viz = new NeoVis.default(config);\n            viz.render();\n        }\n    </script>\n```\n\nThis function creates a `config` object that specifies how to connect to Neo4j, what data to fetch, and how to configure the visualization.\n\n![](/img/example-viz.png)\n\n\nSee [simple-example.html](/examples/simple-example.html) for the full code.\n\n### module usage\nyou can also use it as module, but it would require you have a way to import css files\n\n```javascript\nimport NeoVis from \'neovis.js\';\n```\n\nor you can import the version with bundled dependency\n\n```javascript\nimport NeoVis from \'neovis.js/dist/neovis.js\';\n```\n\n## Build\n\nThis project uses git submodules to include the dependencies for neo4j-driver and vis.js. This project uses webpack to build a bundle that includes all project dependencies. `webpack.config.js` contains the configuration for webpack. After cloning the repo:\n\n```\nnpm install\nnpm run build\n```\n\nwill build `dist/neovis.js` and `dist/neovis-without-dependencies.js` \n\n## Documentation\n\n* `Neovis.default(config)`\n* `Neovis.clearNetwork()`\n* `Neovis.reinit(config)`\n* `Neovis.reload()`\n* `Neovis.stabilize()`\n* `Neovis.renderWithCypher(statement)`\n\n* `config`\n\n### `Neovis.default(config)`\n\nConstructor for Neovis. Creates new Neovis object, given configuration. See [config]()\n\n### `Neovis.clearNetwork()`\n\nClears network visualization\n\n### `Neovis.reinit(config)`\n\nReinitializes the network visualization with a new `config` object. See [config]()\n\n### `Neovis.reload()`\n\nReload the visualization. Will fetch data again from Neo4j per `initial_cypher` in the config object.\n\n### `Neovis.stabilize()`\n\nStop the physics simulation.\n\n### `Neovis.renderWithCypher(statement)`\n\nRender a new visualization with results from a Cypher statement. Any `Node` and `Relationship` objects returned in the Cypher query will be rendered in the visualization. Paths are not currently supported. \n\n### `config`\n\nA configuration object that defines:\n\n* how to connect to Neo4j (required)\n* an initial Cypher query for loading data for the visualization (optional)\n* the DOM element in which the visualization should be rendered (required)\n* how to style elements of the visualization (`labels` and `relationships`) (required)\n\nExample:\n\n~~~ js\nvar config = {\n                container_id: "viz",\n                server_url: "bolt://localhost:7687",\n                server_user: "neo4j",\n                server_password: "sorts-swims-burglaries",\n                labels: {\n                    //"Character": "name",\n                    "Character": {\n                        "caption": "name",\n                        "size": "pagerank",\n                        "community": "community"\n                        //"sizeCypher": "MATCH (n) WHERE id(n) = {id} MATCH (n)-[r]-() RETURN sum(r.weight) AS c"\n                    }\n                },\n                relationships: {\n                    "INTERACTS": {\n                        "thickness": "weight",\n                        "caption": false\n                    }\n                },\n                initial_cypher: "MATCH (n)-[r:INTERACTS]->(m) RETURN n,r,m"\n            };\n\n            viz = new NeoVis.default(config);\n            viz.render();\n~~~\n\n#### `config.container_id`\n\n#### `config.server_url`\n\n#### `config.server_user`\n\n#### `config.server_password`\n\n#### `config.labels`\n\n```\n"Character": {\n    "caption": "name",\n    "size": "pagerank",\n    "community": "community",\n    sizeCypher: "MATCH (n) WHERE id(n) = {id} MATCH (n)-[r]-() RETURN sum(r.weight) AS c"\n}\n```\n\n#### `config.relationships`\n\n```\n{\n    "INTERACTS": {\n        "thickness": "weight",\n        "caption": false\n    }\n}\n```\n\n#### `config.arrows`\n\nBoolean. Defaults to false.\n\n#### `config.hierarchical`\n\nBoolean. Default to false.\n\n#### `config.hierarchical_sort_method`\n\nWhen hierarchical layout is enabled you may choose betweeen `"hubsize"` (default) and `"directed"`.\n\n#### `config.initial_cypher`\n\n#### `config.console_debug`\n\nDefaults to not showing console messages\n\n#### `config.encrypted`\n\n`"ENCRYPTION_OFF"` (default) or `"ENCRYPTION_ON"`\n\nThis must be set to `"ENCRYPTION_ON"` when using a secure WebSocket connection, such as with Neo4j Aura.\n\n#### `config.trust`\n\n`"TRUST_ALL_CERTIFICATES"` (default) or `"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"`\n\n\n'