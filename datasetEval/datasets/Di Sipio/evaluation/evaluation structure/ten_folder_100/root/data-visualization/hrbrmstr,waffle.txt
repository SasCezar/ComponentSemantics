b'\n[![Build\nStatus](https://travis-ci.org/hrbrmstr/waffle.svg)](https://travis-ci.org/hrbrmstr/waffle)\n[![CRAN\\_Status\\_Badge](https://www.r-pkg.org/badges/version/waffle)](https://cran.r-project.org/package=waffle)\n![downloads](https://cranlogs.r-pkg.org/badges/grand-total/waffle)\n\n# waffle\n\nCreate Waffle Chart Visualizations\n\n## Description\n\nSquare pie charts (a.k.a. waffle charts) can be used to communicate\nparts of a whole for categorical quantities. To emulate the percentage\nview of a pie chart, a 10x10 grid should be used with each square\nrepresenting 1% of the total. Modern uses of waffle charts do not\nnecessarily adhere to this rule and can be created with a grid of any\nrectangular shape. Best practices suggest keeping the number of\ncategories small, just as should be done when creating pie charts. Tools\nare provided to create waffle charts as well as stitch them together,\nand to use glyphs for making isotype pictograms.\n\nIt uses ggplot2 and returns a ggplot2 object.\n\n## What\xe2\x80\x99s Inside the Tin\n\nThe following functions are implemented:\n\n  - `waffle`: Make waffle (square pie) charts\n  - `draw_key_pictogram`: Legend builder for pictograms\n  - `fa_grep`: Search Font Awesome glyph names for a pattern\n  - `fa_list`: List all Font Awesome glyphs\n  - `geom_pictogram`: Pictogram Geom\n  - `geom_waffle`: Waffle (Square pie chart) Geom\n  - `install_fa_fonts`: Install Font Awesome 5 Fonts\n  - `iron`: Veritical, left-aligned layout for waffle plots\n  - `scale_label_pictogram`: Used with geom\\_pictogram() to map Font\n    Awesome fonts to labels\n  - `theme_enhance_waffle`: Waffle chart theme cruft remover that can be\n    used with any other theme\n\n## Installation\n\n``` r\ninstall.packages("waffle", repos = "https://cinc.rud.is")\n# or\ndevtools::install_git("https://git.rud.is/hrbrmstr/waffle.git")\n# or\ndevtools::install_git("https://git.sr.ht/~hrbrmstr/waffle")\n# or\ndevtools::install_gitlab("hrbrmstr/waffle")\n# or\ndevtools::install_bitbucket("hrbrmstr/waffle")\n# or\ndevtools::install_github("hrbrmstr/waffle")\n```\n\n## Usage\n\n``` r\nlibrary(waffle)\nlibrary(magrittr)\nlibrary(hrbrthemes)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(waffle)\n\n# current verison\npackageVersion("waffle")\n## [1] \'1.0.1\'\n```\n\n### Some new bits up first\n\n``` r\ndata.frame(\n  parts = factor(rep(month.abb[1:3], 3), levels=month.abb[1:3]),\n  vals = c(10, 20, 30, 6, 14, 40, 30, 20, 10),\n  col = rep(c("blue", "black", "red"), 3),\n  fct = c(rep("Thing 1", 3),\n          rep("Thing 2", 3),\n          rep("Thing 3", 3))\n) -> xdf\n\nxdf %>%\n  count(parts, wt = vals) %>%\n  ggplot(aes(fill = parts, values = n)) +\n  geom_waffle(n_rows = 20, size = 0.33, colour = "white", flip = TRUE) +\n  scale_fill_manual(\n    name = NULL,\n    values = c("#a40000", "#c68958", "#ae6056"),\n    labels = c("Fruit", "Sammich", "Pizza")\n  ) +\n  coord_equal() +\n  theme_ipsum_rc(grid="") +\n  theme_enhance_waffle()\n```\n\n<img src="README_files/figure-gfm/unnamed-chunk-2-1.png" width="768" />\n\n``` r\n\nxdf %>%\n  count(parts, wt = vals) %>%\n  ggplot(aes(label = parts, values = n)) +\n  geom_pictogram(n_rows = 10, aes(colour = parts), flip = TRUE, make_proportional = TRUE) +\n  scale_color_manual(\n    name = NULL,\n    values = c("#a40000", "#c68958", "#ae6056"),\n    labels = c("Fruit", "Sammich", "Pizza")\n  ) +\n  scale_label_pictogram(\n    name = NULL,\n    values = c("apple-alt", "bread-slice", "pizza-slice"),\n    labels = c("Fruit", "Sammich", "Pizza")\n  ) +\n  coord_equal() +\n  theme_ipsum_rc(grid="") +\n  theme_enhance_waffle() +\n  theme(legend.key.height = unit(2.25, "line")) +\n  theme(legend.text = element_text(size = 10, hjust = 0, vjust = 0.75))\n```\n\n<img src="README_files/figure-gfm/unnamed-chunk-2-2.png" width="768" />\n\n``` r\n\nxdf %>%\n  count(parts, wt = vals) %>%\n  ggplot(aes(label = parts, values = n)) +\n  geom_pictogram(\n    n_rows = 20, size = 6, aes(colour = parts), flip = TRUE,\n    family = "FontAwesome5Brands-Regular"\n  ) +\n  scale_color_manual(\n    name = NULL,\n    values = c("#073f9c", "black", "#f34323"),\n    labels = c("BitBucket", "GitHub", "Other")\n  ) +\n  scale_label_pictogram(\n    name = NULL,\n    values = c("bitbucket", "github", "git-alt"),\n    labels = c("BitBucket", "GitHub", "Other")\n  ) +\n  coord_equal() +\n  theme_ipsum_rc(grid="") +\n  theme_enhance_waffle() +\n  theme(legend.text = element_text(hjust = 0, vjust = 1))\n```\n\n<img src="README_files/figure-gfm/unnamed-chunk-2-3.png" width="768" />\n\n### Geoms\\!\n\n``` r\nlibrary(hrbrthemes)\nlibrary(waffle)\nlibrary(tidyverse)\n\ntibble(\n  parts = factor(rep(month.abb[1:3], 3), levels=month.abb[1:3]),\n  values = c(10, 20, 30, 6, 14, 40, 30, 20, 10),\n  fct = c(rep("Thing 1", 3), rep("Thing 2", 3), rep("Thing 3", 3))\n) -> xdf\n\nggplot(xdf, aes(fill=parts, values=values)) +\n  geom_waffle(color = "white", size=1.125, n_rows = 6) +\n  facet_wrap(~fct, ncol=1) +\n  scale_x_discrete(expand=c(0,0)) +\n  scale_y_discrete(expand=c(0,0)) +\n  ggthemes::scale_fill_tableau(name=NULL) +\n  coord_equal() +\n  labs(\n    title = "Faceted Waffle Geoms"\n  ) +\n  theme_ipsum_rc(grid="") +\n  theme_enhance_waffle()\n```\n\n<img src="README_files/figure-gfm/geoms-1.png" width="576" />\n\n### Waffle Bar Charts with scales\\!\n\n``` r\nlibrary(dplyr)\nlibrary(waffle)\n\nstorms %>% \n  filter(year >= 2010) %>% \n  count(year, status) -> storms_df\n\nggplot(storms_df, aes(fill = status, values = n)) +\n  geom_waffle(color = "white", size = .25, n_rows = 10, flip = TRUE) +\n  facet_wrap(~year, nrow = 1, strip.position = "bottom") +\n  scale_x_discrete() + \n  scale_y_continuous(labels = function(x) x * 10, # make this multiplyer the same as n_rows\n                     expand = c(0,0)) +\n  ggthemes::scale_fill_tableau(name=NULL) +\n  coord_equal() +\n  labs(\n    title = "Faceted Waffle Bar Chart",\n    subtitle = "{dplyr} storms data",\n    x = "Year",\n    y = "Count"\n  ) +\n  theme_minimal(base_family = "Roboto Condensed") +\n  theme(panel.grid = element_blank(), axis.ticks.y = element_line()) +\n  guides(fill = guide_legend(reverse = TRUE))\n```\n\n<img src="README_files/figure-gfm/waffle-bars-1.png" width="672" />\n\n### Basic example\n\n``` r\nparts <- c(80, 30, 20, 10)\nwaffle(parts, rows = 8)\n```\n\n<img src="README_files/figure-gfm/fig0-1.png" width="576" />\n\n### Use a data frame\n\n``` r\nparts <- data.frame(\n  names = LETTERS[1:4],\n  vals = c(80, 30, 20, 10)\n)\n\nwaffle(parts, rows = 8)\n```\n\n<img src="README_files/figure-gfm/fig1-1.png" width="576" />\n\n### Slightly more complex example\n\n``` r\nparts <- c(`Un-breached\\nUS Population` = (318 - 11 - 79), `Premera` = 11, `Anthem` = 79)\n```\n\n``` r\nwaffle(\n  parts, rows = 8, size = 1, \n  colors = c("#969696", "#1879bf", "#009bda"), legend_pos = "bottom"\n)\n```\n\n**Health records breaches as fraction of US Population**\n<img src="README_files/figure-gfm/fig2-1.png" width="576" />\n\n<span style="font-size:8pt">One square == 1m ppl</span>\n\n``` r\nwaffle(\n  parts / 10, rows = 3,\n  colors = c("#969696", "#1879bf", "#009bda")\n)\n```\n\n**Health records breaches as fraction of US Population**\n<img src="README_files/figure-gfm/fig3-1.png" width="576" />\n\n<span style="font-size:8pt">(One square == 10m ppl)</span>\n\n``` r\nlibrary(extrafont)\n\nwaffle(\n  parts / 10, rows = 3, colors = c("#969696", "#1879bf", "#009bda"),\n  use_glyph = "medkit", size = 8\n) + expand_limits(y = c(0, 4))\n```\n\n<img src="README_files/figure-gfm/medkit-1.png" width="576" />\n\n### Replicating an old favourite\n\n![](https://graphics8.nytimes.com/images/2008/07/20/business/20debtgraphic.jpg)\n\nVia: <https://www.nytimes.com/2008/07/20/business/20debt.html>\n\n``` r\nsavings <- c(\n  `Mortgage\\n($84,911)` = 84911, `Auto and\\ntuition loans\\n($14,414)` = 14414,\n  `Home equity loans\\n($10,062)` = 10062, `Credit Cards\\n($8,565)` = 8565\n)\n```\n\n``` r\nwaffle(\n  savings / 392, rows = 7, size = 0.5, legend_pos = "bottom",\n  colors = c("#c7d4b6", "#a3aabd", "#a0d0de", "#97b5cf")\n)\n```\n\n**Average Household Savings Each Year**\n<img src="README_files/figure-gfm/fig4a-1.png" width="768" />\n\n<span style="font-size:8pt">(1 square == $392)</span>\n\n### More replication\n\nSimilar to <https://eagereyes.org/techniques/square-pie-charts>\n\n``` r\nprofessional <- c(`Male` = 44, `Female (56%)` = 56)\n```\n\n``` r\nwaffle(\n  professional, rows = 10, size = 0.5,\n  colors = c("#af9139", "#544616")\n)\n```\n\n### Keeps factor by default levels now\n\nWith:\n\n``` r\niron(\n  waffle(c(thing1 = 0, thing2 = 100), rows = 5),\n  waffle(c(thing1 = 25, thing2 = 75), rows = 5)\n)\n```\n\n<img src="README_files/figure-gfm/fct-1.png" width="576" />\n\nWithout (you can disable this via `keep` parameter now):\n\n``` r\niron(\n  waffle(c(thing1 = 0, thing2 = 100), rows = 5, keep = FALSE),\n  waffle(c(thing1 = 25, thing2 = 75), rows = 5, keep = FALSE)\n)\n```\n\n<img src="README_files/figure-gfm/no_fct-1.png" width="576" />\n\n**Professional Workforce Makeup**\n\n<img src="README_files/figure-gfm/f5-1.png" width="384" />\n\nIron example (left-align & padding for multiple plots)\n\n``` r\npain.adult.1997 <- c(`YOY (406)` = 406, `Adult (24)` = 24)\n\nwaffle(\n  pain.adult.1997 / 2, rows = 7, size = 0.5,\n  colors = c("#c7d4b6", "#a3aabd"),\n  title = "Paine Run Brook Trout Abundance (1997)",\n  xlab = "1 square = 2 fish", pad = 3\n) -> A\n\npine.adult.1997 <- c(`YOY (221)` = 221, `Adult (143)` = 143)\n\nwaffle(\n  pine.adult.1997 / 2, rows = 7, size = 0.5,\n  colors = c("#c7d4b6", "#a3aabd"),\n  title = "Piney River Brook Trout Abundance (1997)",\n  xlab = "1 square = 2 fish", pad = 8\n) -> B\n\nstan.adult.1997 <- c(`YOY (270)` = 270, `Adult (197)` = 197)\n\nwaffle(\n  stan.adult.1997 / 2, rows = 7, size = 0.5,\n  colors = c("#c7d4b6", "#a3aabd"),\n  title = "Staunton River Trout Abundance (1997)",\n  xlab = "1 square = 2 fish"\n) -> C\n\niron(A, B, C)\n```\n\n<img src="README_files/figure-gfm/f8-1.png" width="672" />\n\n## Package Code Metrics\n\n``` r\ncloc::cloc_pkg_md()\n```\n\n| Lang | \\# Files |  (%) | LoC |  (%) | Blank lines |  (%) | \\# Lines | (%) |\n| :--- | -------: | ---: | --: | ---: | ----------: | ---: | -------: | --: |\n| R    |       16 | 0.89 | 628 | 0.62 |         209 | 0.61 |      430 | 0.7 |\n| Rmd  |        2 | 0.11 | 383 | 0.38 |         135 | 0.39 |      184 | 0.3 |\n\n## Code of Conduct\n\nPlease note that this project is released with a [Contributor Code of\nConduct](CONDUCT.md). By participating in this project you agree to\nabide by its terms.\n'