b'# crystal-mysql [![Build Status](https://travis-ci.org/crystal-lang/crystal-mysql.svg?branch=master)](https://travis-ci.org/crystal-lang/crystal-mysql)\n\n\nMySQL driver implement natively in Crystal, without relying on external libraries.\n\nCheck [crystal-db](https://github.com/crystal-lang/crystal-db) for general db driver documentation. crystal-mysql driver is registered under `mysql://` uri.\n\n## Why\n\nUsing a natively implemented library has a significant performance improvement over working with an external library, since there is no need to copy data to and from the Crystal space and the native code. Initial tests with the library have shown a 2x-3x performance boost, though additional testing is required.\n\nAlso, going through the MySQL external library *blocks* the Crystal thread using it, thus imposing a significant penalty to concurrent database accesses, such as those in web servers. We aim to overcome this issue through a full Crystal implementation of the MySQL driver that plays nice with non-blocking IO.\n\n## Status\n\nThis driver is a work in progress. \nIt implements mysql\'s binary protocol to create prepared statements.\nContributions are most welcome.\n\n## Installation\n\nAdd this to your application\'s `shard.yml`:\n\n```yml\ndependencies:\n  mysql:\n    github: crystal-lang/crystal-mysql\n```\n\n## Usage\n\n```crystal\nrequire "mysql"\n\n# connect to localhost mysql test db\nDB.open "mysql://root@localhost/test" do |db|\n  db.exec "drop table if exists contacts"\n  db.exec "create table contacts (name varchar(30), age int)"\n  db.exec "insert into contacts values (?, ?)", "John Doe", 30\n\n  args = [] of DB::Any\n  args << "Sarah"\n  args << 33\n  db.exec "insert into contacts values (?, ?)", args\n\n  puts "max age:"\n  puts db.scalar "select max(age) from contacts" # => 33\n\n  puts "contacts:"\n  db.query "select name, age from contacts order by age desc" do |rs|\n    puts "#{rs.column_name(0)} (#{rs.column_name(1)})"\n    # => name (age)\n    rs.each do\n      puts "#{rs.read(String)} (#{rs.read(Int32)})"\n      # => Sarah (33)\n      # => John Doe (30)\n    end\n  end\nend\n```\n\nWhen running this example, if you get the following exception:\n\n> Unhandled exception: Client does not support authentication protocol requested by server; consider upgrading MySQL client (Exception)\n\nYou have two options, set a password for root, or (most recommended option) create another user with access to `test` database.\n\n```mysql\nCREATE USER \'test\'@\'localhost\' IDENTIFIED WITH mysql_native_password BY \'yourpassword\';\nGRANT ALL PRIVILEGES ON test.* TO \'test\'@\'localhost\' WITH GRANT OPTION;\nFLUSH PRIVILEGES;\nquit\n```\n\nThen use the example above changing the `DB.open` line to\n\n```crystal\nDB.open "mysql://test:yourpassword@localhost/test" do |db|\n```\n'