b'# Plex Plugin for Homebridge\n[![npm](https://img.shields.io/npm/v/homebridge-plex.svg)](https://www.npmjs.com/package/homebridge-plex)\n[![npm](https://img.shields.io/npm/dt/homebridge-plex.svg)](https://www.npmjs.com/package/homebridge-plex)\n\nUse the active sessions on your Plex server as a sensor in Homebridge. Enable your cozy cinema light scene when Plex starts playing and go back to your normal lighting when playback stops.\n\n## Installation\n\nYou install the plugin the same way you installed Homebridge - as a global NPM module:\n\n```bash\nsudo npm install -g homebridge-plex\n```\n\nIf you don\'t have a Homebridge installation yet, head over to the [project documetation](https://github.com/nfarina/homebridge) for more information.\n\n## Configuration\n\nThe plugin uses the following config values:\n\nVariable | Description\n-------- | -----------\n`accessory` | Must be `Plex`\n`name` | Whatever you want the accessory to be named in Homekit\n`plex_token` | The X-Plex-Token used to access your Plex server API. See [Finding an authentication token / X-Plex-Token](https://support.plex.tv/hc/en-us/articles/204059436-Finding-an-authentication-token-X-Plex-Token)\n`host` | The hostname / IP address of your Plex server. Defaults to `localhost`, can be omitted if Homebridge runs on the same server as your Plex.\n`port` | The port of your Plex server. Defaults to `32400`\n`filter` |\xc2\xa0An array of filter rules. See [filtering sessions](#filtering-sessions)\n`polling_interval` | Interval in seconds in which the play state is checked. Default is `3`, lower values are discuraged.\n`debug` | Set this to true to receive detailed debug information about active sessions and filtering. This is not recommended for permanent installations as it [fills up your log files pretty quickly](https://github.com/mpbzh/homebridge-plex/issues/6).\n\nTypical config example:\n```json\n{\n  "accessories": [\n    {\n      "accessory": "Plex",\n      "name": "Plex",\n      "plex_token": "...",\n      "filter": [\n        {\n            "user": "your-plex-username",\n            "player": "your-favorite-player"\n        }\n      ]\n    }\n  ]\n}\n```\n\n## Filtering Sessions\n\nPlex will show up in your [Home app](https://www.apple.com/ios/home/) as an "Occupancy Sensor". You can use this sensor in any automation you like.\n\nLet\'s assume you have a home cinema with an Apple TV and the Plex app installed. You want to switch to your cinema light scene when you start watching a movie, so that all the lights dim down.\nNow you probably also have a smartphone or a tablet from which you occasionally stream a movie. To avoid these devices or even other users triggering the light scene in your home cinema, you can configure your sensor ignore everything other than the Apple TV.\n\nYou can configure an array of objects (we\'ll call that object a "filter rule"), each containing either a `user` or a `player` key or both. If any of the filter rules match an active session on your Plex server, the sensor in your Homekit will trigger and keep being triggered until you pause or stop the playback. So you can attach a scene to the "occupancy detected" event as well as the "occupancy stopped being detected" event.\n\nIf you define a filter rule only containing a `user` value, any device of that user will trigger the sensor. If you only define a `player` (e.g. my-apple-tv), then any player with that name will trigger the sensor, regardless of the user (This makes sense if multiple users use the same Apple TV).\n\n### Finding your user and player name\n\nJust start a movie on the device you want to trigger the sensor and head over to the [Plex web app](https://app.plex.tv/desktop). Navigate to Status -> Dashoard -> Current playback. Toggle "show details" on the top right and find the player name here:\n\n![Now Playing in the Plex web app](doc/now-playing.png)\n\nThe `player` is in the upper left corner (in this example it\'s "TVBox") and the `name` is next to your profile picture in the bottom (not depicted).\n'