b'# homebridge-mi-aqara\r\n[![npm version](https://badge.fury.io/js/homebridge-mi-aqara.svg)](https://badge.fury.io/js/homebridge-mi-aqara)\r\n[![npm version](https://img.shields.io/badge/releases-0.8.0-blue.svg)](https://github.com/YinHangCode/homebridge-mi-aqara)\r\n[![npm version](https://img.shields.io/badge/dev-0.8.0-yellow.svg)](https://github.com/YinHangCode/homebridge-mi-aqara/tree/dev)\r\n[![npm version](https://img.shields.io/badge/donate-AliPay-green.svg)](https://github.com/YinHangCode/homebridge-mi-aqara/blob/master/images/Donate-AliPay.jpg)\r\n[![npm version](https://img.shields.io/badge/donate-WeChat-green.svg)](https://github.com/YinHangCode/homebridge-mi-aqara/blob/master/images/Donate-WeChat.jpg)\r\n[![npm version](https://img.shields.io/badge/donate-PayPal-green.svg)](https://www.paypal.me/yhdeserteagle)\r\n\r\nhomebridge plugin for XiaoMi Aqara plugin.   \r\n\r\nThanks for \r\n[nfarina](https://github.com/nfarina)(the author of [homebridge](https://github.com/nfarina/homebridge)), \r\n[snOOrz](https://github.com/snOOrz)(the author of [homebridge-aqara](https://github.com/snOOrz/homebridge-aqara)), \r\n[licuhui](https://github.com/licuhui), \r\n[\xe6\x94\x80\xe6\x97\xba\xe6\x99\xba\xe8\x83\xbd](https://pwzn.taobao.com/), \r\n[magaHH](https://github.com/magaHH), \r\n[isundaylee](https://github.com/isundaylee), \r\n[ileler](https://github.com/ileler), \r\n[myriky](https://github.com/myriky), \r\nall other developer and testers.   \r\n\r\n**Note: I have only a part of these devices, so some devices don\'t have tested. If you find bugs, please submit them to [issues](https://github.com/YinHangCode/homebridge-mi-aqara/issues) or [QQ Group: 107927710](//shang.qq.com/wpa/qunwpa?idkey=8b9566598f40dd68412065ada24184ef72c6bddaa11525ca26c4e1536a8f2a3d).**\r\n   \r\n**Note: According to aqara local network protocol use UDP port 9898, please notice the relevant configuration of firewall.**   \r\n   \r\n**Note: 0.5.x update to 0.6.x must be [clear register accessories](#clear-register-accessories) and update [configuration](#configuration) file content.**   \r\n   \r\n**Note: About AcPartner, This project only provides gateway functionality. If you want the use air conditioning function, please refer to the project for [homebridge-mi-acPartner](https://github.com/LASER-Yi/homebridge-mi-acPartner).**   \r\n   \r\nThis repository contains the Aqara plugin for homebridge.   \r\nAqara is a ZigBee gateway with a few sensors.   \r\n\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/Gateway.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/ContactSensor.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/MotionSensor.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/Button.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/TemperatureAndHumiditySensor.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/SingleSwitch.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/DuplexSwitch.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/SingleSwitchLN.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/DuplexSwitchLN.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/SingleButton86.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/DuplexButton86.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/PlugBase.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/PlugBase86.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/MagicSquare.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/SmokeDetector.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/NatgasDetector.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/ElectricCurtain.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/ContactSensor2.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/MotionSensor2.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/Button2.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/TemperatureAndHumiditySensor2.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/WaterDetector.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/Lock.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/AcPartner.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/Button3.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/DuplexButton862.jpg)\r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/Vibration.jpg)\r\n\r\n## Supported Devices\r\n||Device Name|Protocol Model Value|\r\n|:-:|:-|:-|\r\n|1|Gateway(\xe7\xbd\x91\xe5\x85\xb3)|gateway<br>gateway.v3|\r\n|2|ContactSensor(\xe9\x97\xa8\xe7\xa3\x81\xe6\x84\x9f\xe5\xba\x94)|magnet<br>sensor_magnet|\r\n|3|MotionSensor(\xe4\xba\xba\xe4\xbd\x93\xe6\x84\x9f\xe5\xba\x94)|motion|\r\n|4|Button(\xe6\x8c\x89\xe9\x92\xae)|switch<br>sensor_switch|\r\n|5|TemperatureAndHumiditySensor(\xe6\xb8\xa9\xe5\xba\xa6\xe6\xb9\xbf\xe5\xba\xa6\xe4\xbc\xa0\xe6\x84\x9f\xe5\x99\xa8)|sensor_ht|\r\n|6|SingleSwitch(\xe5\x8d\x95\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3)|ctrl_neutral1|\r\n|7|DuplexSwitch(\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3)|ctrl_neutral2|\r\n|8|SingleSwitchLN(\xe5\x8d\x95\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3\xe9\x9b\xb6\xe7\x81\xab\xe7\x89\x88)|ctrl_ln1<br>ctrl_ln1.aq1|\r\n|9|DuplexSwitchLN(\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3\xe9\x9b\xb6\xe7\x81\xab\xe7\x89\x88)|ctrl_ln2<br>ctrl_ln2.aq1|\r\n|10|SingleButton86(86\xe5\x9e\x8b\xe6\x97\xa0\xe7\xba\xbf\xe5\x8d\x95\xe6\x8c\x89\xe9\x92\xae\xe5\xbc\x80\xe5\x85\xb3)|86sw1<br>sensor_86sw1.aq1<br>sensor_86sw1|\r\n|11|DuplexButton86(86\xe5\x9e\x8b\xe6\x97\xa0\xe7\xba\xbf\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xbc\x80\xe5\x85\xb3)|86sw2<br>sensor_86sw2.aq1<br>sensor_86sw2|\r\n|12|PlugBase(\xe6\x8f\x92\xe5\xba\xa7)|plug|\r\n|13|PlugBase86(86\xe5\x9e\x8b\xe5\xa2\x99\xe5\xa3\x81\xe6\x8f\x92\xe5\xba\xa7)|86plug<br>ctrl_86plug<br>ctrl_86plug.aq1|\r\n|14|MagicSquare(\xe9\xad\x94\xe6\x96\xb9)|cube<br>sensor_cube<br>sensor_cube.aqgl01|\r\n|15|SmokeDetector(\xe7\x83\x9f\xe9\x9b\xbe\xe6\x8a\xa5\xe8\xad\xa6\xe5\x99\xa8)|smoke<br>sensor_smoke|\r\n|16|NatgasDetector(\xe5\xa4\xa9\xe7\x84\xb6\xe6\xb0\x94\xe6\x8a\xa5\xe8\xad\xa6\xe5\x99\xa8)|natgas<br>sensor_natgas|\r\n|17|ElectricCurtain(\xe7\x94\xb5\xe5\x8a\xa8\xe7\xaa\x97\xe5\xb8\x98)|curtain|\r\n|18|ContactSensor2(\xe9\x97\xa8\xe7\xa3\x81\xe6\x84\x9f\xe5\xba\x94\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|sensor_magnet.aq2|\r\n|19|MotionSensor2(\xe4\xba\xba\xe4\xbd\x93\xe6\x84\x9f\xe5\xba\x94\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|sensor_motion.aq2|\r\n|20|Button2(\xe6\x8c\x89\xe9\x92\xae\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|sensor_switch.aq2|\r\n|21|TemperatureAndHumiditySensor2(\xe6\xb8\xa9\xe5\xba\xa6\xe6\xb9\xbf\xe5\xba\xa6\xe4\xbc\xa0\xe6\x84\x9f\xe5\x99\xa8\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|weather.v1<br>weather|\r\n|22|WaterDetector(\xe6\xb0\xb4\xe6\xb5\xb8\xe4\xbc\xa0\xe6\x84\x9f\xe5\x99\xa8)|sensor_wleak.aq1|\r\n|23|Lock(\xe9\x97\xa8\xe9\x94\x81)|lock.aq1|\r\n|24|AcPartner(\xe7\xa9\xba\xe8\xb0\x83\xe4\xbc\xb4\xe4\xbe\xa3\xe5\x8d\x87\xe7\xba\xa7\xe7\x89\x88)|acpartner.v3|\r\n|25|Button3(\xe6\x8c\x89\xe9\x92\xae\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3\xe5\x8d\x87\xe7\xba\xa7\xe7\x89\x88)|sensor_switch.aq3|\r\n|26|DuplexButton862(86\xe5\x9e\x8b\xe6\x97\xa0\xe7\xba\xbf\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xbc\x80\xe5\x85\xb3\xe5\x8d\x87\xe7\xba\xa7\xe7\x89\x88)|remote.b286acn01|\r\n|27|VibrationSensor(\xe5\x8a\xa8\xe9\x9d\x99\xe8\xb4\xb4)|vibration|\r\n\r\n\r\n## Pre-Requirements\r\n1. Make sure your IOS version is ios11 or later.   \r\n2. Make sure you have gateway v2 or acpartner v3. gateway v1 has limited space so can\'t support this feature.   \r\n3. Update gateway firmware to **1.4.1_155.0143(gateway v2)**, **1.4.1_148.019(acpartner v3)** or later.   \r\n\r\n## Installation\r\n1. Install HomeBridge, please follow it\'s [README](https://github.com/nfarina/homebridge/blob/master/README.md).   \r\nIf you are using Raspberry Pi, please read [Running-HomeBridge-on-a-Raspberry-Pi](https://github.com/nfarina/homebridge/wiki/Running-HomeBridge-on-a-Raspberry-Pi).   \r\n2. Make sure you can see HomeBridge in your iOS devices, if not, please go back to step 1.   \r\n3. Download homebridge-mi-aqara to your HomeBridge path or installation through NPM:\r\n```\r\nnpm install -g homebridge-mi-aqara\r\n```\r\n   \r\n\r\n## Configuration\r\n||Name|Required|Value Type|Description|Value Example|\r\n|:-:|:-|:-|:-|:-|:-|\r\n|1|platform|True|String||It must be \'MiAqaraPlatform\'|\r\n|2|[gateways](#gateways-configuration)|True|Object|set gateway information.|{ "6409802da3b3": "02i44k56zrgg578b" }|\r\n|3|[bindAddress](#bindaddress-configuration)|False|String|specified network.|"10.0.1.1"|\r\n|4|[defaultValue](#defaultvalue-configuration)|False|Object|set device default value.||\r\n|5|[manage](#manage-configuration)|False|Object|open manage and manage configs.|{ "port": 11128, "password": "107927710" }|\r\n|6|[mqtt](#mqtt-configuration)|False|Object|open mqtt and mqtt configs.|{ "username": "mqtt", "password": "107927710" }|\r\n\r\nFor more information about config, Please refer to file `sampleConfig.json`.   \r\n\r\n### gateways configuration\r\nOpen aqara gateway\'s settings, enable [local network protocol](https://github.com/louisZL/lumi-gateway-local-api).  \r\nPlease follow the steps in this thread: http://wiki.yinhh.com/Wiki.jsp?page=Homebridge-mi-aqara or http://bbs.xiaomi.cn/t-13198850. It\'s in Chinese so you might need a translator to read it.  \r\nTo control the devices, put gateway\'s MAC address (**lower case without colon**) and password (**keep original and case sensitive**) to ~/.homebridge/config.json.   \r\n   \r\nWarning: gateway\'s MAC address (**lower case without colon**) and password (**keep original and case sensitive**).   \r\nWarning: gateway\'s MAC address (**lower case without colon**) and password (**keep original and case sensitive**).   \r\nWarning: gateway\'s MAC address (**lower case without colon**) and password (**keep original and case sensitive**).   \r\nImportant things are to be repeated for 3 times.\r\n   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b"\r\n        }\r\n    }]\r\n}\r\n```\r\nIf you have more than one gateways, fill them in right order, like below.  \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        }\r\n    }]\r\n}\r\n```\r\nHere is a way to search for gateways instead of multicast, because of some friends do not respond to information from gateway in their network environment.   \r\nThat is to say, we can config the IP address of the gateway to replace search gateway by multicast.   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": {\r\n                "password": "02i44k56zrgg578b",\r\n                "ip": "10.3.3.1"\r\n            },\r\n            "f0b4299a5b2b": {\r\n                "password": "2F92E7DA90C66B86",\r\n                "ip": "10.3.3.2"\r\n            },\r\n            "f0b4299a77dd": {\r\n                "password": "syu3oasva3uqd5qd",\r\n                "ip": "10.3.3.3"\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\nIt can also be mixed config, but without full configuration of ip, multicast packets will still be sent to search for other gateways which do not config ip.   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": {\r\n                "password": "2F92E7DA90C66B86",\r\n                "ip": "10.3.3.2"\r\n            },\r\n            "f0b4299a77dd": {\r\n                "password": "syu3oasva3uqd5qd",\r\n                "ip": "10.3.3.3"\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### bindAddress configuration\r\nIf your device(which running homebridge) has multiple network, please add the bindAddress configuration item to decide to listen which network, like below.   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "bindAddress": "10.0.1.1",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### defaultValue configuration\r\nIf you want to specify the default value, such as specify the name of the accessory, hide the accessory, any other configs. You can add a defaultValue mapping table to your config.json.   \r\nThe config supported are as follows:   \r\n\r\n||Name|Value Type|Description|Default Value|Recommended Value|Value Example|\r\n|:-:|:-|:-|:-|:-|:-|:-|\r\n|1|[name](#defaultvalue-name-configuration)|String|set accessory name.|DeviceAccessoryType_device SID last four bits||"living room temperature"|\r\n|2|[serviceType](#defaultvalue-servicetype-configuration)|String|set accessory type for Switch or Lightbulb. <br>Currently only supported: SingleSwitch, DuplexSwitch, SingleSwitchLN, DuplexSwitchLN.|"Switch"|"Switch"|"Lightbulb"|\r\n|3|[disable](#defaultvalue-disable-configuration)|Boolean|disable accessory|false|the accessories that do not need to be set to true, such as virtual press.|true|\r\n|4|[syncValue](#defaultvalue-syncvalue-configuration)|Boolean|accessory will synchronization value when homebridge call the get function, if it\'s true.|false|fasle|false|\r\n|5|[ignoreWriteResult](#defaultvalue-ignorewriteresult-configuration)|Boolean|if set to true, the result of control is not detected.|true|If your network is awful, it\'s recommended to be set true.|false|\r\n|6|[disableNoResponse](#defaultvalue-disablenoresponse-configuration)|Boolean|use jump back the last value to replace show NoResponse, you can set it true.|false|false|true|\r\n\r\nThe rules are as follows:\r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "device1 sid": {\r\n                "DeviceAccessoryType1": {\r\n                    "config1": "config1 value"\r\n                }\r\n            },\r\n            "device2 sid": {\r\n                "DeviceAccessoryType1": {\r\n                    "config1": "config1 value"\r\n                    "config2": "config2 value"\r\n                },\r\n                "DeviceAccessoryType2": {\r\n                    "config1": "config1 value"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\nexamples:   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001000001": {\r\n                "ContactSensor_ContactSensor": {\r\n                    "name": "entrance door"\r\n                }\r\n            },\r\n            "158d0001000002": {\r\n                "MotionSensor2_MotionSensor": {\r\n                    "name": "study room motion sensor"\r\n                },\r\n                "MotionSensor2_LightSensor": {\r\n                    "name": "study room light sensor"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n   \r\nThe rules of A DeviceAccessoryType:   \r\n```\r\nDeviceName_HomeBridgeAccessoryType(_ExtraMessage)\r\n```\r\ndetail:   \r\n\r\n||Device Name|DeviceAccessoryType|\r\n|:-:|:-|:-|\r\n|1|Gateway(\xe7\xbd\x91\xe5\x85\xb3)|Gateway_Lightbulb<br>Gateway_LightSensor<br>Gateway_Switch_JoinPermission|\r\n|2|ContactSensor(\xe9\x97\xa8\xe7\xa3\x81\xe6\x84\x9f\xe5\xba\x94)|ContactSensor_ContactSensor|\r\n|3|MotionSensor(\xe4\xba\xba\xe4\xbd\x93\xe6\x84\x9f\xe5\xba\x94)|MotionSensor_MotionSensor|\r\n|4|Button(\xe6\x8c\x89\xe9\x92\xae)|Button_StatelessProgrammableSwitch<br>Button_Switch_VirtualSinglePress<br>Button_Switch_VirtualDoublePress|\r\n|5|TemperatureAndHumiditySensor(\xe6\xb8\xa9\xe5\xba\xa6\xe6\xb9\xbf\xe5\xba\xa6\xe4\xbc\xa0\xe6\x84\x9f\xe5\x99\xa8)|TemperatureAndHumiditySensor_TemperatureSensor<br>TemperatureAndHumiditySensor_HumiditySensor|\r\n|6|SingleSwitch(\xe5\x8d\x95\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3)|SingleSwitch_Switch|\r\n|7|DuplexSwitch(\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3)|DuplexSwitch_Switch_Left<br>DuplexSwitch_Switch_Right|\r\n|8|SingleSwitchLN(\xe5\x8d\x95\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3\xe9\x9b\xb6\xe7\x81\xab\xe7\x89\x88)|SingleSwitchLN_Switch|\r\n|9|DuplexSwitchLN(\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xa2\x99\xe5\xa3\x81\xe5\xbc\x80\xe5\x85\xb3\xe9\x9b\xb6\xe7\x81\xab\xe7\x89\x88)|DuplexSwitchLN_Switch_Left<br>DuplexSwitchLN_Switch_Right|\r\n|10|SingleButton86(86\xe5\x9e\x8b\xe6\x97\xa0\xe7\xba\xbf\xe5\x8d\x95\xe6\x8c\x89\xe9\x92\xae\xe5\xbc\x80\xe5\x85\xb3)|SingleButton86_StatelessProgrammableSwitch<br>SingleButton86_Switch_VirtualSinglePress|\r\n|11|DuplexButton86(86\xe5\x9e\x8b\xe6\x97\xa0\xe7\xba\xbf\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xbc\x80\xe5\x85\xb3)|DuplexButton86_StatelessProgrammableSwitch_Left<br>DuplexButton86_Switch_VirtualSinglePress_Left<br>DuplexButton86_StatelessProgrammableSwitch_Right<br>DuplexButton86_Switch_VirtualSinglePress_Right<br>DuplexButton86_StatelessProgrammableSwitch_Both<br>DuplexButton86_Switch_VirtualSinglePress_Both|\r\n|12|PlugBase(\xe6\x8f\x92\xe5\xba\xa7)|PlugBase_Outlet|\r\n|13|PlugBase86(86\xe5\x9e\x8b\xe5\xa2\x99\xe5\xa3\x81\xe6\x8f\x92\xe5\xba\xa7)|PlugBase86_Outlet|\r\n|14|MagicSquare(\xe9\xad\x94\xe6\x96\xb9)|MagicSquare_StatelessProgrammableSwitch_Flip90<br>MagicSquare_StatelessProgrammableSwitch_Flip180<br>MagicSquare_StatelessProgrammableSwitch_Move<br>MagicSquare_StatelessProgrammableSwitch_TapTwice<br>MagicSquare_StatelessProgrammableSwitch_ShakeAir<br>MagicSquare_StatelessProgrammableSwitch_Rotate<br>MagicSquare_Switch_VirtualFlip90<br>MagicSquare_Switch_VirtualFlip180<br>MagicSquare_Switch_VirtualMove<br>MagicSquare_Switch_VirtualTapTwice<br>MagicSquare_Switch_VirtualShakeAir|\r\n|15|SmokeDetector(\xe7\x83\x9f\xe9\x9b\xbe\xe6\x8a\xa5\xe8\xad\xa6\xe5\x99\xa8)|SmokeDetector_SmokeSensor|\r\n|16|NatgasDetector(\xe5\xa4\xa9\xe7\x84\xb6\xe6\xb0\x94\xe6\x8a\xa5\xe8\xad\xa6\xe5\x99\xa8)|NatgasDetector_SmokeSensor|\r\n|17|ElectricCurtain(\xe7\x94\xb5\xe5\x8a\xa8\xe7\xaa\x97\xe5\xb8\x98)|ElectricCurtain_WindowCovering|\r\n|18|ContactSensor2(\xe9\x97\xa8\xe7\xa3\x81\xe6\x84\x9f\xe5\xba\x94\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|ContactSensor2_ContactSensor|\r\n|19|MotionSensor2(\xe4\xba\xba\xe4\xbd\x93\xe6\x84\x9f\xe5\xba\x94\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|MotionSensor2_MotionSensor<br>MotionSensor2_LightSensor|\r\n|20|Button2(\xe6\x8c\x89\xe9\x92\xae\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|Button2_StatelessProgrammableSwitch<br>Button2_Switch_VirtualSinglePress<br>Button2_Switch_VirtualDoublePress|\r\n|21|TemperatureAndHumiditySensor2(\xe6\xb8\xa9\xe5\xba\xa6\xe6\xb9\xbf\xe5\xba\xa6\xe4\xbc\xa0\xe6\x84\x9f\xe5\x99\xa8\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3)|TemperatureAndHumiditySensor2_TemperatureSensor<br>TemperatureAndHumiditySensor2_HumiditySensor|\r\n|22|WaterDetector(\xe6\xb0\xb4\xe6\xb5\xb8\xe4\xbc\xa0\xe6\x84\x9f\xe5\x99\xa8)|WaterDetector_LeakSensor|\r\n|23|Lock(\xe9\x97\xa8\xe9\x94\x81)|Lock_MotionSensor<br>Lock_MotionSensor_{UserID}|\r\n|24|AcPartner(\xe7\xa9\xba\xe8\xb0\x83\xe4\xbc\xb4\xe4\xbe\xa3\xe5\x8d\x87\xe7\xba\xa7\xe7\x89\x88)|AcPartner_LightSensor<br>AcPartner_Switch_JoinPermission|\r\n|25|Button3(\xe6\x8c\x89\xe9\x92\xae\xe7\xac\xac\xe4\xba\x8c\xe4\xbb\xa3\xe5\x8d\x87\xe7\xba\xa7\xe7\x89\x88)|Button3_StatelessProgrammableSwitch<br>Button3_StatelessProgrammableSwitch_Shake<br>Button3_Switch_VirtualSinglePress<br>Button3_Switch_VirtualDoublePress<br>Button3_Switch_VirtualShare|\r\n|26|DuplexButton862(86\xe5\x9e\x8b\xe6\x97\xa0\xe7\xba\xbf\xe5\x8f\x8c\xe6\x8c\x89\xe9\x92\xae\xe5\xbc\x80\xe5\x85\xb3\xe5\x8d\x87\xe7\xba\xa7\xe7\x89\x88)|DuplexButton862_StatelessProgrammableSwitch_Left<br>DuplexButton862_Switch_VirtualSinglePress_Left<br>DuplexButton862_Switch_VirtualDoublePress_Left<br>DuplexButton862_StatelessProgrammableSwitch_Right<br>DuplexButton862_Switch_VirtualSinglePress_Right<br>DuplexButton862_Switch_VirtualDoublePress_Right<br>DuplexButton862_StatelessProgrammableSwitch_Both<br>DuplexButton862_Switch_VirtualSinglePress_Both|\r\n|27|VibrationSensor(\xe5\x8a\xa8\xe9\x9d\x99\xe8\xb4\xb4)|VibrationSensor_MotionSensor_Vibrate<br>VibrationSensor_MotionSensor_Tilt<br>VibrationSensor_MotionSensor_FreeFall|\r\n\r\n\r\nAbout Global:   \r\nSome similar configurations and repeated multiple copies are boring things. So I provided a global writing method.   \r\nThe following two methods of writing are equivalent:   \r\n```\r\n....\r\n"158d0001000008": {\r\n    "DuplexSwitch_Switch_Left": {\r\n        "name": "master bedroom room light",\r\n        "serviceType": "Lightbulb"\r\n    },\r\n    "DuplexSwitch_Switch_Right": {\r\n        "name": "study room light",\r\n        "serviceType": "Lightbulb"\r\n    }\r\n}\r\n....\r\n```\r\n```\r\n....\r\n"158d0001000008": {\r\n    "Global": {\r\n        "serviceType": "Lightbulb"\r\n    },\r\n    "DuplexSwitch_Switch_Left": {\r\n        "name": "master bedroom room light"\r\n    },\r\n    "DuplexSwitch_Switch_Right": {\r\n        "name": "study room light"\r\n    }\r\n}\r\n....\r\n```\r\nIn the same way, the following two kinds of writing are alse equivalent:   \r\n```\r\n....\r\n"158d0001000003": {\r\n    "Button_StatelessProgrammableSwitch": {\r\n        "name": "living room button"\r\n    },\r\n    "Button_Switch_VirtualSinglePress": {\r\n        "name": "living room button virtual single press",\r\n        "disable": true\r\n    },\r\n    "Button_Switch_VirtualDoublePress": {\r\n        "name": "living room button virtual double press",\r\n        "disable": true\r\n    }\r\n}\r\n....\r\n```\r\n```\r\n....\r\n"158d0001000003": {\r\n    "Global": {\r\n        "disable": true \r\n    },\r\n    "Button_StatelessProgrammableSwitch": {\r\n        "name": "living room button",\r\n        "disable": false\r\n    },\r\n    "Button_Switch_VirtualSinglePress": {\r\n        "name": "living room button virtual single press"\r\n    },\r\n    "Button_Switch_VirtualDoublePress": {\r\n        "name": "living room button virtual double press"\r\n    }\r\n}\r\n....\r\n```\r\nIt also provides a higher level of way, the following three kinds of writing are alse equivalent:   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light",\r\n                    "ignoreWriteResult": true\r\n                }\r\n            },\r\n            "158d0001000008": {\r\n                "DuplexSwitch_Switch_Left": {\r\n                    "name": "master bedroom room light",\r\n                    "ignoreWriteResult": true\r\n                },\r\n                "DuplexSwitch_Switch_Right": {\r\n                    "name": "study room light",\r\n                    "ignoreWriteResult": true\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light",\r\n                    "ignoreWriteResult": true\r\n                }\r\n            },\r\n            "158d0001000008": {\r\n                "Global": {\r\n                    "ignoreWriteResult": true\r\n                },\r\n                "DuplexSwitch_Switch_Left": {\r\n                    "name": "master bedroom room light"\r\n                },\r\n                "DuplexSwitch_Switch_Right": {\r\n                    "name": "study room light"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "Global": {\r\n                "ignoreWriteResult": true\r\n            },\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light"\r\n                }\r\n            },\r\n            "158d0001000008": {\r\n                "DuplexSwitch_Switch_Left": {\r\n                    "name": "master bedroom room light"\r\n                },\r\n                "DuplexSwitch_Switch_Right": {\r\n                    "name": "study room light"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### defaultValue name configuration\r\nIf you want to specify the default name of the device, add a mapping table to your config.json like this.\r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001000001": {\r\n                "ContactSensor_ContactSensor": {\r\n                    "name": "entrance door"\r\n                }\r\n            },\r\n            "158d0001000002": {\r\n                "MotionSensor2_MotionSensor": {\r\n                    "name": "study room motion sensor"\r\n                },\r\n                "MotionSensor2_LightSensor": {\r\n                    "name": "study room light sensor"\r\n                }\r\n            },\r\n            "158d0001000004": {\r\n                "TemperatureAndHumiditySensor_TemperatureSensor": {\r\n                    "name": "living room temperature"\r\n                },\r\n                "TemperatureAndHumiditySensor_HumiditySensor": {\r\n                    "name": "living room humidity"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### defaultValue serviceType configuration\r\nIf you like to use Light Bulb type for Light Switch to make grandma Siri happy, like snOOrz, you can set the following in the config.   \r\nCurrently only supported: SingleSwitch, DuplexSwitch, SingleSwitchLN, DuplexSwitchLN.   \r\n**If you changed serviceType config, Please [clear register accessories](#clear-register-accessories).**   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light",\r\n                    "serviceType": "Lightbulb"\r\n                }\r\n            },\r\n            "158d0001000008": {\r\n                "Global": {\r\n                    "serviceType": "Lightbulb"\r\n                },\r\n                "DuplexSwitch_Switch_Left": {\r\n                    "name": "master bedroom room light"\r\n                },\r\n                "DuplexSwitch_Switch_Right": {\r\n                    "name": "study room light"\r\n                }\r\n            },\r\n            "158d10010000001": {\r\n                "DuplexSwitch_Switch_Left": {\r\n                    "name": "master bedroom room light",\r\n                    "serviceType": "Lightbulb"\r\n                },\r\n                "DuplexSwitch_Switch_Right": {\r\n                    "name": "study room light"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### defaultValue disable configuration\r\nIf you want to disable accessories, you can add disable attribute to config.   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light",\r\n                    "serviceType": "Lightbulb"\r\n                }\r\n            },\r\n            "158d0001000008": {\r\n                "DuplexSwitch_Switch_Left": {\r\n                    "name": "master bedroom room light",\r\n                    "serviceType": "Lightbulb",\r\n                    "disable": false\r\n                },\r\n                "DuplexSwitch_Switch_Right": {\r\n                    "name": "study room light",\r\n                    "serviceType": "Lightbulb",\r\n                    "disable": true\r\n                }\r\n            },\r\n            "158d0001000004": {\r\n                "TemperatureAndHumiditySensor_TemperatureSensor": {\r\n                    "name": "living room temperature"\r\n                },\r\n                "TemperatureAndHumiditySensor_HumiditySensor": {\r\n                    "name": "living room humidity",\r\n                    "disable": true\r\n                }\r\n            },\r\n            "158d0001000012": {\r\n                "Global": {\r\n                    "disable": true\r\n                }\r\n            },\r\n            "158d0001000015": {\r\n                "Global": {\r\n                    "disable": true\r\n                },\r\n                "MagicSquare_StatelessProgrammableSwitch_Flip90": {\r\n                    "name": "study room magic square flip90",\r\n                    "disable": false\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### defaultValue syncValue configuration\r\nIf you want to accessory value exact, you can set syncValue is true.   \r\nwhen syncValue is true, accessory will synchronization value when homebridge call the get function. At the same time, it\'s going to waste more time.   \r\nwhen syncValue is false, accessory will use the device last reported value. It\'s going to respond quickly.   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light",\r\n                    "serviceType": "Lightbulb",\r\n                    "syncValue": true\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### defaultValue ignoreWriteResult configuration\r\nIf you control device always timeout, but in fact it\'s already working.   \r\nyou can set ignoreWriteResult is true.   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "Global": {\r\n                "ignoreWriteResult": true\r\n            },\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light",\r\n                    "serviceType": "Lightbulb",\r\n                    "syncValue": true\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n   \r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/syncValue.png)\r\n   \r\n### defaultValue disableNoResponse configuration\r\nIf you don\'t like "No Response", you can set disableNoResponse is true.   \r\nWhen the device is no pesponse and disableNoResponse is true, the accessory value will auto jump back to before the control.   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "Global": {\r\n                "disableNoResponse": true\r\n            },\r\n            "158d0001000007": {\r\n                "SingleSwitch_Switch": {\r\n                    "name": "living room light",\r\n                    "serviceType": "Lightbulb",\r\n                    "syncValue": true\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n\r\n### defaultValue other configuration\r\nIf you want to use Aqara lock,you need add some configuration like this:   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "LockDeviceID": {\r\n                "Lock_MotionSensor": {\r\n                    "name": "door"\r\n                },\r\n                "Lock_MotionSensor_{User1ID}": {\r\n                    "name": "User1Name"\r\n                },\r\n                "Lock_MotionSensor_{User2ID}": {\r\n                    "name": "User2Name"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```\r\n`{UserID}` is user identification from lock.   \r\nThe value can get from `Aqara Lock Plugin` in `MIHOME` APP. The user ID contains the ID type.   \r\nThe integer value obtained by dividing the user ID by 65536 is the ID type. The ID type value is:   \r\n1 fingerprint   \r\n2 password   \r\n3 proximity card   \r\n5 check-in password   \r\nExample:   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        },\r\n        "defaultValue": {\r\n            "158d0001dd0289": {\r\n                "Lock_MotionSensor": {\r\n                    "name": "door"\r\n                },\r\n                "Lock_MotionSensor_65536": {\r\n                    "name": "Administrator"\r\n                },\r\n                "Lock_MotionSensor_65537": {\r\n                    "name": "Finger"\r\n                },\r\n                "Lock_MotionSensor_196608": {\r\n                    "name": "Card"\r\n                }\r\n            }\r\n        }\r\n    }]\r\n}\r\n```  \r\n   \r\n### manage configuration\r\nBefore version 0.7.x, the addition and deletion of accessories are automatic. The rules are as follows:   \r\n**find new accessories every one hour, delete accessories which did not receive heartbeat over 7 days.**   \r\nObviously, this is not easy to use. So version 0.7.0 added http web manage(if you do not set manage item, then http web manage is close.). config add these:   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "manage": {\r\n            "port": 11128,\r\n            "password": "107927710"\r\n        },\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        }\r\n    }]\r\n}\r\n```\r\nConfig items description:   \r\n\r\n||Name|Required|Value Type|Description|Recommended Value|Value Example|\r\n|:-:|:-|:-|:-|:-|:-|:-|\r\n|1|port|True|Integer|set manage web port.|11128|11128|\r\n|2|password|True|String|set manage web password.|"107927710"|"107927710"|\r\n    \r\n![](https://raw.githubusercontent.com/YinHangCode/homebridge-mi-aqara/master/images/httpWebManage.png)\r\n    \r\n### mqtt configuration\r\nconfig add these:   \r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "mqtt": {\r\n        },\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        }\r\n    }]\r\n}\r\n```\r\nOr\r\n```\r\n{\r\n    "platforms": [{\r\n        "platform": "MiAqaraPlatform",\r\n        "mqtt": {\r\n            "server": "10.0.1.1",\r\n            "username": "mqtt",\r\n            "password": "mqtt"\r\n        },\r\n        "gateways": {\r\n            "6409802da3b3": "02i44k56zrgg578b",\r\n            "f0b4299a5b2b": "2F92E7DA90C66B86",\r\n            "f0b4299a77dd": "syu3oasva3uqd5qd"\r\n        }\r\n    }]\r\n}\r\n```\r\nConfig items description:   \r\n\r\n||Name|Required|Value Type|Description|Default Value|Value Example|\r\n|:-:|:-|:-|:-|:-|:-|:-|\r\n|1|server|False|String|set mqtt server ip.|"127.0.0.1"|"10.0.1.1"|\r\n|2|username|False|String|set mqtt username.|"mqtt"|"mqtt"|\r\n|3|password|False|String|set mqtt password.|"mqtt"|"mqtt"|\r\n    \r\nplugin will send these topic:   \r\n1. `/homebridge-mi-aqara`: all message.   \r\n2. `/homebridge-mi-aqara/{cmd}`: all message after `{cmd}` filter.   \r\n3. `/homebridge-mi-aqara/{sid}`: all message after `{sid}` filter.   \r\n4. `/homebridge-mi-aqara/{sid}/{cmd}`: all message after `{sid}` and `{cmd}` filter.   \r\n   \r\n`{cmd}` is iam/get_id_list_ack/discovery_rsp/write_ack/write_rsp/read_ack/read_rsp/report.   \r\n`{sid}` is device\'s sid.   \r\n   \r\nplugin will accept these topic:   \r\n1. `/homebridge-mi-aqara/write`: write device.   \r\nabout write key, send the `${key}` is okay, this plugin will automatically calculate the key value, for example:   \r\n`{"cmd": "write", "model": "ctrl_neutral2", "sid": "158d00014a1bcd", "params": [{"channel_0": "off"}], "key": "${key}"}`\r\n    \r\n## Some explanation\r\nButton/Button2 StatelessProgrammableSwitch support SinglePress, DoublePress, LongPress.   \r\nSingleButton86/DuplexButton86(Left, Right, Both) StatelessProgrammableSwitch only support SinglePress.   \r\nMagicSquare(Flip90, Flip180, Move, TapTwice, ShakeAir, Rotate) StatelessProgrammableSwitch only support SinglePress.   \r\n   \r\n## Run it\r\nhomebridge -D   \r\n   \r\n## Clear register accessories\r\ncd ~/.homebridge/accessories/   \r\nmv cachedAccessories cachedAccessories_\\`date \'+%Y%m%d_%H%M%S\'\\`.bak   \r\necho [] > cachedAccessories   \r\n\r\n## Version Logs\r\n### 0.8.0 (2018-11-04)\r\n1. add mqtt support.   \r\n### 0.7.3 (2018-10-27)\r\n1. add support for VibrationSensor.   \r\n### 0.7.2 (2018-10-09)\r\n1. fixed bug that move \'sensor_switch\' type form Button2 to Button.   \r\n2. add support for Button3(sensor_switch.aq3).   \r\n3. add support for DuplexButton862(remote.b286acn01).   \r\n### 0.7.1 (2018-09-14)\r\n1. fixed bug that delete orphan accessory list item fail in http web manage.   \r\n### 0.7.0 (2018-09-13)\r\n1. fixed bug that DuplexSwitchLN right switch not work.   \r\n2. fixed bug that sometimes Gateway, AcPartner and MotionSensor2 light senor no response.   \r\n3. fixed bug that MagicSquare Rotate StatelessProgrammableSwitch not work.   \r\n4. fixed bug that crash when auto remove accessory.   \r\n5. add http web manage.   \r\n### 0.6.9 (2018-06-23)\r\n1. fixed bug that config \'defaultValue\' can not support: Button2, MotionSensor2, ContactSensor2, PlugBase86.   \r\n2. fixed bug that MotionSensor not work in aqara local network protocol 2.x version.   \r\n3. support config gateway ip feature.   \r\n### 0.6.9_beta (2018-03-26)\r\n1. optimized some of the basic code to facilitate the subsequent support of new hardware.   \r\n2. supports aqara local network protocol 2.x version.   \r\n3. add support for lock device.   \r\n4. add support for acpartner accessory.   \r\n### 0.6.8 (2018-01-21)\r\n1. fixed bug that sometimes DuplexSwitchLN and DuplexSwitch no response.   \r\n2. fixed bug that it still show battery low power after replacing the battery.   \r\n3. fixed bug that TemperatureAndHumiditySensor and TemperatureAndHumiditySensor2 temperature sensor accessory can\'t show the negative number.   \r\n4. remove a duplicated function.   \r\n5. add the choice bindAddress feature.\r\n### 0.6.7 (2017-12-10)\r\n1. optimizing log content.   \r\n### 0.6.6 (2017-12-10)\r\n1. fixed bug that sometimes DuplexSwitchLN and DuplexSwitch no response.   \r\n2. fixed bug that sometimes Gateway and MotionSensor2 light senor no response.   \r\n3. fixed bug that global config not work in some cases.   \r\n4. add setting "ignoreWriteResult" feature.   \r\n5. remove the SingleButton86, DuplexButton86, MagicSquare redundant event action.   \r\n### 0.6.5 (2017-10-31)\r\n1. optimizing log content.   \r\n2. optimizing read/write device response timeout rules.   \r\n3. optimizing read/write device no response rules.   \r\n4. add gateway join permission switch accessory.   \r\n5. add setting disable "No Response" feature.   \r\n### 0.6.4 (2017-10-27)\r\n1. add virtual switch accessory can trigger homekit click events.   \r\n2. optimizing log content.   \r\n3. optimizing HomeBridge startup read device info algorithm.   \r\n### 0.6.3 (2017-10-26)\r\n1. fixed bug that ElectricCurtain can\'t work.   \r\n2. remove synchronization value when homebridge call the get function(only electrify device) and add setting synchronization value feature.   \r\n3. add config Global mode.   \r\n### 0.6.2 (2017-10-25)\r\n1. fixed bug that MotionSensor motion sonser accessory status is error.   \r\n2. fixed bug that MotionSensor2 motion sonser accessory status is error.   \r\n### 0.6.1 (2017-10-23)\r\n1. fixed bug that MotionSensor2 light sonser accessory value is error.   \r\n### 0.6.0 (2017-10-22)\r\n1. refactoring code.   \r\n2. add feedback when control accessory.   \r\n3. synchronization value when homebridge call the get function. (only electrify device)   \r\n4. optimizing program structure, send fewer packets.   \r\n5. optimizing config item name, easier to read.   \r\n6. fixed some bug.   \r\n7. add Button(single press, double press) virtual switch accessory.   \r\n8. add Button2(single press, double press) virtual switch accessory.   \r\n9. add SingleButton86(single press) virtual switch accessory.   \r\n10. add DuplexButton86(left button single press, right button single press, both press) virtual switch accessory.   \r\n11. add MagicSquare(flip90, flip180, move, tapTwice, shakeAir) virtual switch accessory.   \r\n### 0.5.3 (2017-08-26)\r\n1. optimized code.   \r\n### 0.5.2 (2017-08-23)\r\n1. fixed bug that gateway light brightness is 100 when it light up.   \r\n### 0.5.1 (2017-08-14)\r\n1. fixed bug that natgas detector is not alarm.   \r\n### 0.5.0 (2017-08-13)\r\n1. add support for water detector accessory.   \r\n2. fixed bug that natgas detector is not alarm.   \r\n3. fixed bug that smoke detector is not alarm.   \r\n### 0.4.4 (2017-08-09)\r\n1. add log content that show plugin version when homebridge started.   \r\n2. fixed bug that run homebridge error there is no MiAqaraPlatform in config.json file.   \r\n### 0.4.3 (2017-08-01)\r\n1. fixed bug that gateway light sensor not support when value is 0;   \r\n2. fixed bug that motion sensor version 2 light sensor not support when value is 0;   \r\n### 0.4.2 (2017-07-29)\r\n1. adjustment gateway light sensor value(subtract 279).   \r\n2. delete PlugBase, PlugBase86, SingleSwitch, DuplexSwitch, SingleSwitchLN, DuplexSwitchLN battery information.   \r\n3. add motion sensor version 2 light sensor battery information.   \r\n4. add setting accessory disable feature.   \r\n5. fixed bug that electric curtain can\'t work, but there is no current operation state information now.   \r\n### 0.4.1 (2017-07-26)\r\n1. code collation.   \r\n### 0.4.0 (2017-07-26)\r\n1. add support for electric curtain accessory.   \r\n2. add support for contact sensor version 2 accessory.   \r\n3. add support for motion sensor version 2 accessory.   \r\n4. add support for button version 2 accessory.   \r\n5. add support for temperature and humidity sensor version 2 accessory.   \r\n6. optimize log content.   \r\n7. add setting default name feature.   \r\n8. add setting default service type feature.   \r\n9. fixed motion sensor bug that wrong trigger when homebridge start.   \r\n10.adjustment gateway light sensor value(subtract 300).   \r\n### 0.3.3 (2017-06-16)\r\n1. add single button 86 long press event.   \r\n2. add duplex button 86 long press event.   \r\n3. changed button click event value from Characteristic.ProgrammableSwitchEvent.CLICK back to Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS.   \r\n4. changed single button 86 click event value from Characteristic.ProgrammableSwitchEvent.CLICK back to Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS.   \r\n5. changed duplex button 86 click event value from Characteristic.ProgrammableSwitchEvent.CLICK back to Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS.   \r\n### 0.3.2 (2017-06-15)\r\n1. fixed bug that duplex switch LN charging state.   \r\n2. fixed bug that single switch LN charging state.   \r\n3. fixed bug that single button 86 charging state.   \r\n4. changed button click event value from Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS to Characteristic.ProgrammableSwitchEvent.CLICK.   \r\n5. changed single button 86 click event value from Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS to Characteristic.ProgrammableSwitchEvent.CLICK.   \r\n6. changed duplex button 86 click event value from Characteristic.ProgrammableSwitchEvent.SINGLE_PRESS to Characteristic.ProgrammableSwitchEvent.CLICK.   \r\n7. fixed bug that natgas detector is not alarm.   \r\n8. fixed bug that smoke detector is not alarm.   \r\n### 0.3.1 (2017-06-14)\r\n1. code collation.   \r\n### 0.3.0 (2017-06-14)\r\n1. add support for single switch LN accessory.   \r\n2. add support for duplex switch LN accessory.   \r\n3. add support for plug base 86 accessory.   \r\n4. add support for smoke detector accessory.   \r\n5. add support for natgas detector accessory.   \r\n### 0.2.1 (2017-06-14)\r\n1. change accessory registration mechanism, fixed bug that new accessory can\'t correlate associated with gateway.   \r\n### 0.2.0 (2017-06-14)\r\n1. add support for duplex switch accessory.   \r\n2. add support for single button 86 accessory.   \r\n3. add support for duplex button 86 accessory.   \r\n### 0.1.0 (2017-06-13)\r\n1. add support for plug base accessory.   \r\n2. add support for magic square accessory.   \r\n### 0.0.6 (2017-06-12)\r\n1. add some logs.\r\n### 0.0.5 (2017-06-08)\r\n1. fixed bug.\r\n### 0.0.4 (2017-06-08)\r\n1. fixed bug.\r\n### 0.0.3 (2017-06-08)\r\n1. add support for gateway accessory: light sensor, hue light.\r\n### 0.0.2 (2017-06-07)\r\n1. add support for single switch accessory.   \r\n### 0.0.1 (2017-06-07)\r\n1. supported contact sensor accessory.   \r\n2. supported motion sensor accessory.   \r\n3. supported button accessory.   \r\n4. supported temperature and humidity sensor accessory.   \r\n'