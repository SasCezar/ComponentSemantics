b'# homebridge plugin and webapp for smarthome\n[![npm package](https://nodei.co/npm/homebridge-smarthome.png?downloads=true&downloadRank=true&stars=true)](https://nodei.co/npm/homebridge-smarthome/)\n\n[![npm](https://img.shields.io/npm/dt/homebridge-smarthome.svg)](https://www.npmjs.com/package/homebridge-smarthome) \n[![npm](https://img.shields.io/npm/v/homebridge-smarthome.svg)](https://www.npmjs.com/package/homebridge-smarthome)\n[![Dependency Status](https://img.shields.io/versioneye/d/nodejs/homebridge-smarthome.svg)](https://www.versioneye.com/nodejs/homebridge-smarthome/)\n\n\n## mijia & broadlink & more...\n\nThanks for \n1. [snOOrz](https://github.com/snOOrz)(the author of [homebridge-aqara](https://github.com/snOOrz/homebridge-aqara))\n2. [YinHangCode](https://github.com/YinHangCode/homebridge-mi-aqara)(the author of [homebridge-mi-aqara](https://github.com/YinHangCode/homebridge-mi-aqara))\n3. [aholstenson](https://github.com/aholstenson/miio)(the author of [miio](https://github.com/aholstenson/miio))\n4. all other developer and testers.   \n\n**Note: I have only a part of these devices, some devices do not have been tested. If you find bugs, please submit them to [issues](https://github.com/rench/homebridge-smarthome/issues).**\n\n## Mijia & Aqara Accessory for homebridge.   \n\n### Zigbee\n![](http://7fv93h.com1.z0.glb.clouddn.com/Gateway.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/ContactSensor.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/MotionSensor.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/Button.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/TemperatureAndHumiditySensor.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/SingleSwitch.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/DuplexSwitch.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/SingleSwitchLN.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/DuplexSwitchLN.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/SingleButton86.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/DuplexButton86.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/PlugBase.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/PlugBase86.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/MagicSquare.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/SmokeDetector.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/NatgasDetector.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/ElectricCurtain.jpg)\n\n### Wifi\n![](http://7fv93h.com1.z0.glb.clouddn.com/AirPurifier.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/MiCamera.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/MiRobotVacuum.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/Yeelight.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/Yeelight2.png)\n![](http://7fv93h.com1.z0.glb.clouddn.com/Yeelight3.png)\n\n### Supported Devices\n1. Gateway(LightSensor/Lightbulb[hue])\n2. Magent(ContactSensor)\n3. TemperatureAndHumiditySensor(HumiditySensor/TemperatureSensor)\n4. Motion(MotionSensor)\n5. Switch(StatelessProgrammableSwitch)\n6. Plug(Outlet)\n7. CtrlNeutral1/CtrlNeutral2(Switch)\n8. CtrlLN1/CtrlLN2(Switch)\n9. 86SW1/86SW2(StatelessProgrammableSwitch)\n10. 86Plug(Outlet)\n11. Smoke(SmokeSensor)\n12. Natgas(SmokeSensor)\n13. Curtain(WindowCovering)\n14. AirPurifier(AirPurifier/AirQualitySensor/TemperatureSensor/HumiditySensor/Lightbulb)\n15. Vacuum(Fan)\n16. PowerPlug(Outlet)\n17. PowerStrip(Outlet)\n18. Yeelight(Lightbulb[hue])\n19. Aqara Switch(Switch)\n20. Aqara Magent(ContactSensor)\n21. Aqara TemperatureAndHumiditySensorAndPressure(HumiditySensor/TemperatureSensor/`CommunityTypes.AtmosphericPressureSensor`)\n22. Aqara Motion(MotionSensor)\n\n## Broadlink Accessory for homebridge.\n![](http://7fv93h.com1.z0.glb.clouddn.com/Broadlink_MP1.jpg)\n![](http://7fv93h.com1.z0.glb.clouddn.com/Broadlink_MP2.jpg)\n\n### Supported Devices\n1. MP1(Outlet)\n2. MP2(Outlet)\n\n\n## Pre-Requirements\n1. Make sure you have V2 of the gateway. V1 has limited space so can\'t support this feature.  \n2. Update gateway firmware to 1.4.1_141.0141 or later. You can contact [@babymoney666](https://github.com/babymoney666) if your firmware is not up to date.  \n\n## Installation\n1. Install HomeBridge, please follow it\'s [README](https://github.com/nfarina/homebridge/blob/master/README.md).  \nIf you are using Raspberry Pi, please read [Running-HomeBridge-on-a-Raspberry-Pi](https://github.com/nfarina/homebridge/wiki/Running-HomeBridge-on-a-Raspberry-Pi).  \n2. Make sure you can see HomeBridge in your iOS devices, if not, please go back to step 1.  \n3. Download homebridge-smarthome to your local folder or `npm i homebridge-smarthome`.  \n\n## Configuration\n1. Open Aqara gateway\'s settings, enable [local network protocol](https://github.com/louisZL/lumi-gateway-local-api).  \nPlease follow the steps in this thread: http://bbs.xiaomi.cn/t-13198850. It\'s in Chinese so you might need a translator to read it.  \n2. To control the devices, put gateway\'s MAC address (lower case without colon) and password to ~/.homebridge/config.json.  \n3. How to get device ip and token? see [miio](https://github.com/aholstenson/miio/blob/master/docs/protocol.md).\n```\n{\n  "bridge": {\n    "name": "SmartHome",\n    "username": "CC:22:3D:E3:CE:30",\n    "port": 51826,\n    "pin": "031-45-154"\n  },\n    "platforms": [\n    {\n      "platform": "smarthome-mijia",\n      "web": {\n        "port": 8888\n      },\n      "mijia": {\n        "sids": [\n          "34ce0088faed"\n        ],\n        "passwords": [\n          "75ED5A235C4A44D4"\n        ],\n        "devices": [\n          {\n            "sid": "Air Purifier 001",\n            "name": "Air Purifier",\n            "type": "wifi",\n            "model": "air-purifier"\n          },\n          {\n            "sid": "Power Plug 001",\n            "name": "Power Plug",\n            "type": "wifi",\n            "model": "power-plug"\n          },\n          {\n            "sid": "Power Strip 001",\n            "name": "Power Strip",\n            "type": "wifi",\n            "model": "power-strip"\n          },\n          {\n            "sid": "Yeelight 001",\n            "name": "Yeelight",\n            "type": "wifi",\n            "model": "light"\n          },\n          {\n            "sid": "Vacuum Cleaner 001",\n            "name": "Vacuum Cleaner",\n            "ip": "192.168.2.200",\n            "token": "4ac2cd21f3e9272ab21a5c1fd4053ed9",\n            "type": "wifi",\n            "model": "vacuum"\n          }\n        ]\n      }\n    },\n    {\n      "platform": "smarthome-broadlink",\n      "broadlink": {\n        "devices": [\n          {\n            "name": "MP2",\n            "type": "MP2",\n            "mac": "34:EA:34:D9:FE:B3"\n          }\n        ]\n      }\n    }\n  ]\n}\n```\n    \n## Run it\nhomebridge -D  \n\n## Version Logs \n\n### 1.1.3\n1. `mijia` fix purifier type error.\n2. `mijia` fix multi getways.\n\n### 1.1.2\n1. `mijia` fix yeelight missing miio require.\n\n### 1.1.1\n1. `mijia` fix gateway lighthub.\n\n### 1.1.0\n\n1. `mijia` fix air-purifier accessory(fix multi callback).\n\n### 1.0.7\n\n1. `mijia` fix air-purifier accessory(remove some duplicated code).\n\n### 1.0.6\n1. `aqara` magnet,motion,switch,temperature-humidity-pressure accessory.\n2. `mijia` change monitor.js->motion.js.\n3. `mijia` update miio.\n\n### 1.0.5\n1. `mijia` yeelight accessory(bugfix).\n\n### 1.0.4\n1. `mijia` yeelight accessory.\n2. `mijia` fix wifi device bug.\n\n### 1.0.3\n1. `mijia` vacuum accessory.\n2. `mijia` powerplug accessory.\n3. `mijia` powerstrip accessory.\n\n### 1.0.2\n1. `mijia` magnet sensor accessory.\n2. `mijia` ctrln1/ctrln2 switch accessory.\n3. `mijia` ctrlneutral1/ctrlneutral2 switch accessory.\n4. `mijia` motion sensor accessory.\n5. `mijia` plug/86plug plug accessory.\n6. `mijia` 86sw1/86sw2 switch accessory.\n7. `mijia` switch accessory.\n8. `mijia` smoke sensor accessory.\n9. `mijia` natgas sensor accessory.\n10. `mijia` air-purifier accessory.\n11. `broadlink` mp1/mp2 plug accessory.\n### 1.0.1\n1. `mijia` gateway sensor accessory.\n2. `mijia` door and window sensor accessory.\n3. `mijia` temperature and humidity sensor accessory.'