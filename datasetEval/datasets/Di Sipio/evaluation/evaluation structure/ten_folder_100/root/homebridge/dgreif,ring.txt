b"# ring-client-api\n \n[![Actions Status](https://github.com/dgreif/ring/workflows/Node%20CI/badge.svg)](https://github.com/dgreif/ring/actions)\n[![Donate](https://img.shields.io/badge/Donate-PayPal-green.svg)](https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=HD9ZPB34FY428&currency_code=USD&source=url)\n \nThis is an unofficial TypeScript api for [Ring Doorbells](https://shop.ring.com/pages/doorbell-cameras),\n[Ring Cameras](https://shop.ring.com/pages/security-cameras),\nthe [Ring Alarm System](https://shop.ring.com/pages/security-system),\n[Ring Smart Lighting](https://shop.ring.com/pages/smart-lighting),\nand third party devices that connect to the Ring Alarm System.\nBuilt to support the [homebridge-ring Plugin](./homebridge)\n \n## Installation\n\n`npm i ring-client-api`\n\n\n## Setup and Config\n```js\nimport { RingApi } from 'ring-client-api'\n\nconst ringApi = new RingApi({\n  // without 2fa\n  email: 'some.one@website.com',\n  password: 'abc123!#',\n  \n  // with 2fa or if you dont want to store your email/password in your config\n  refreshToken: 'token generated with ring-auth-cli.  See https://github.com/dgreif/ring/wiki/Two-Factor-Auth',\n\n  // The following are all optional. See below for details\n  cameraStatusPollingSeconds: 20,\n  cameraDingsPollingSeconds: 2,\n  locationIds: ['488e4800-fcde-4493-969b-d1a06f683102', '4bbed7a7-06df-4f18-b3af-291c89854d60']\n});\n```\n\nFor accounts with 2fa enabled, see the [Two Factor Auth Wiki](https://github.com/dgreif/ring/wiki/Two-Factor-Auth)\n\n### Optional Parameters\n\nOption | Default | Explanation\n--- | --- | ---\n`refreshToken` | `undefined` | An alternate authentication method for accounts with 2fa enabled, or if you don't want to store your email/password in a config file.  See the [Two Factor Auth Wiki](https://github.com/dgreif/ring/wiki/Two-Factor-Auth).\n`cameraStatusPollingSeconds` | `undefined` (No Polling) | How frequently to poll for updates to your cameras (in seconds).  Information like light/siren status do not update in real time and need to be requested periodically.\n`cameraDingsPollingSeconds` | `undefined` (No Polling) | How frequently to poll for new events from your cameras (in seconds).  These include motion and doorbell presses.  Without this option, cameras will not emit any information about motion and doorbell presses.  \n`locationIds` | All Locations | Allows you to limit the results to a specific set of locations. This is mainly useful for the [homebridge-ring Plugin](./homebridge), but can also be used if you only care about listening for events at a subset of your locations and don't want to create websocket connections to _all_ of your locations. This will also limit the results for `ringApi.getCameras()` to the configured locations. If this option is not included, all locations will be returned.\n`debug` | false | Turns on additional logging.  In particular, ffmpeg logging.\n\n## Locations\n```typescript\nconst locations = await ringApi.getLocations()\nconst location = locations[0]\nlocation.hasHubs // does this location have an alarm and/or lighting bridge\nlocation.disarm()\nlocation.armHome([/* optional array of zids for devices to bypass */])\nlocation.armAway([/* bypass zids */])\nlocation.getAlarmMode() // returns Promise<'all' | 'some' | 'none'>\nlocation.soundSiren()\nlocation.silenceSiren()\nlocation.cameras // array of cameras at this location\nconst rooms = await location.getRoomList() // array of rooms { id: number, name: string }\n```\n\n`locations` is an array of your Ring locations. Each location can be armed or disarmed,\nand used to interact with all devices in that location.\n\n## Devices\nOnce you have acquired the desired location, you can start\nto interact with associated devices. These devices include ring alarm, ring lighting,\nand third party devices connected to ring alarm\n```js\nimport { RingDeviceType } from 'ring-client-api'\n\nconst devices = await location.getDevices()\nconst baseStation = devices.find(device => device.data.deviceType === RingDeviceType.BaseStation)\nbaseStation.setVolume(.75) // base station and keypad support volume settings between 0 and 1\nconsole.log(baseStation.data) // object containing properties like zid, name, roomId, faulted, tamperStatus, etc.\nbaseStation.onData.subscribe(data => {\n    // called any time data is updated for this specific device\n})\n```\n\n## Cameras\nYou can get all cameras using `await ringApi.getCameras()` or cameras for a particular\nlocation with `location.cameras`\n\n```typescript\nconst camera = location.cameras[0]\ncamera.data // camera info including motion zones, light status, battery, etc.\ncamera.onData.subscribe(data => {\n  // called every time new data is fetched for this camera\n})\ncamera.setLight(true) // turn light on/off\ncamera.setSiren(true) // turn siren on/off\ncamera.getHealth() // fetch health info like wifi status\ncamera.startVideoOnDemand() // ask the camera to start a new video stream\ncamera.createSipSession() // creates a new SipSession which allows you to control RTP flow\ncamera.getHistory(50) // fetch ding history (like motion and doorbell presses)\ncamera.getRecording()\ncamera.getSnapshot() // returns a Promise<Buffer> of the latest snapshot from the camera \n```\n\nCamera also includes the following observables:\n* `onNewDing`: this will include the sip info and ding information every time a new ding is created\n* `onActiveDings`: dings created within the last 65 seconds\n* `onDoorbellPressed`: emits a ding every time the doorbell is pressed\n* `onMotionDetected`: `true` or `false` based on `onActiveDings` containing a motion ding\n\nSome other useful propeties\n* `id`\n* `name`: same as `description` from `data`\n* `hasLight`: does this camera have a light\n* `hasSiren`: does this camera have a siren\n* `isDoorbot`: is this camera a doorbell\n\nSee the `examples` directory for additional code examples.\n\n## Upgrading from v3 to v4\n\nSee https://github.com/dgreif/ring/wiki/Upgrading-from-v3-to-v4\n\n## homebridge-ring\n\nThe `homebridge-ring` is also maintained in this repo.  Its readme can be found in [the `homebridge` directory](./homebridge)\n\n## Credits\n\nI'd like to give a big thanks to a number developers who have put a lot of hard work into analyzing the\nRing api and building similar libraries which were extremely valuable in my creation of this project.  Thank you all\nfor your hard work!\n\n * @davglass - https://github.com/davglass/doorbot - The original node project that proved we can interact with Ring's api\n * @jimhigson - https://github.com/jimhigson/ring-api - A promisified api for Ring's original line of products\n * @tchellomello - https://github.com/tchellomello/python-ring-doorbell - A python api which is widely used for Ring integrations\n * @mrose17 - https://github.com/homespun/homebridge-platform-ring-video-doorbell - The original Ring camera homebridge plugin\n * @codahq - Thanks for all your help debugging the Ring api\n * @joeyberkovitz - Great discovery work on the Ring Alarm websockets api\n"