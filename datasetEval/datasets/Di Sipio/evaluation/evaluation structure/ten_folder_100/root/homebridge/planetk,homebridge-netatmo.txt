b'[![Build Status](https://secure.travis-ci.org/planetk/homebridge-netatmo.png?branch=master)](http://travis-ci.org/planetk/homebridge-netatmo)\n[![downloads][downloads-image]][downloads-url]\nLike this? Please buy me a beer ...\n[![Donate](https://img.shields.io/badge/Donate-PayPal-blue.svg)](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=7ZGEPWHG5UH6S)\n\n[downloads-image]: https://img.shields.io/npm/dm/homebridge-netatmo.svg?style=flat\n[downloads-url]: https://npmjs.org/package/homebridge-netatmo\n\n# homebridge-netatmo\n\nThis is a plugin for homebridge. It\'s a working implementation for several netatmo devices:\n\n* **netatmo weather station**\n* **netatmo thermostat**\n* **netatmo welcome** \n\n_Please check [notes on devices](#notes) below for detailed information on supported modules_.\n\n# Installation\n\n1. Install homebridge using: npm install -g homebridge\n2. Install this plugin using: npm install -g homebridge-netatmo\n3. Update your configuration file. See sample-config.json in this repository for a sample. \n\n# Configuration\n\n## Simple Configuration\n\n\nConfiguration sample:\n\n```\n"platforms": [\n        {\n            "platform": "netatmo",\n            "name": "netatmo platform",\n            "ttl": 10,\n            "auth": {\n    \t        "client_id": "XXXXX Create at https://dev.netatmo.com/",\n                "client_secret": "XXXXX Create at https://dev.netatmo.com/",\n                "username": "your netatmo username",\n                "password": "your netatmo password"\n            }\n        }\n    ],\n\n```\n\nTo retrieve client id and secret please follow following guide:\n\n1. Register at http://dev.netatmo.com as a developer\n2. After successful registration create your own app by using the menu entry "CREATE AN APP"\n3. On the following page, enter a name for your app. Any name can be chosen. All other fields of the form (like callback url, etc.) can be left blank.\n4. After successfully submitting the form the overview page of your app should show client id and secret.\n\n\n## Advanced Configuration\n\nThere are some optional configuration options in the netatmo section of the config which provide finer control about what device and services to use to create accessories.\n\n### API Refresh and timings\n\nCommunication towards netatmo API is time by three parameters:\n\n<dl>\n <dt>ttl</dt>\n <dd>Time in seconds, how long data will be kept in the internal cache. Mainly useful to avoide duplicated requests for different values from the same device. Defaults to 10 seconds if left out in config.</dd>\n <dt>refresh_check</dt>\n <dd>Time in milliseconds, how often the api will be automatically polled to check for changes. Defaults to 900000 which is 15 Minutes. Do not take values much lower, or you risk, that you put to much traffic to the netatmo API. In worst case netatmo might temporarilly exclude your app from the api.</dd>\n <dt> refresh_run </dt>\n <dd>Time in milliseconds, how often the the module checks if there was a request to refresh the data, either from the automatic polling or due to changes in the homekit app. This allows to have regular checks as well as refreshes after changes were done in the app. Defaults to 20000 which is 20 Seconds.</dd>\n</dl>\n\n<pre>\n\n    "platforms": [\n        {\n            "platform": "netatmo",\n            \n            ...\n            \n\t\t\t  <b>"ttl": 10,\n\t\t\t  "refresh_check": 900000\n\t\t\t  "refresh_run": 20000</b>\n            ...\n            \n        }\n    ],\n\n</pre>\n\n\n\n\n### Control Accessories by device type\n\n<pre>\n\n    "platforms": [\n        {\n            "platform": "netatmo",\n            \n            ...\n            \n            <b>"deviceTypes": [\n              "weatherstation",\n              "thermostat",\n              "camera"\n            ],</b>\n\n            ...\n            \n        }\n    ],\n\n</pre>\n\nThis allows you to include/exclude devices of a certain type in your accessories.\nThe device types marked **bold** are the **default types**, if this config section is left out.\n\nPlease note, that welcome support is by default switched off, since it is not fully implemented yet.\n\n###  Control Accessories by device ID\n\nControlling devices can be done pn a finer level by id. The id of a netatmo device or module basically is it\'s mac address.\n\nIn order to include or exclude a specific device, the corresponding id can be included in a whitelist resp. blacklist.\n\nIf the whitelist contains at least one entry, all oter ids will be excluded.\n\n<pre>\n\n    "platforms": [\n        {\n            "platform": "netatmo",\n            \n            ...\n            \n            <b>"whitelist": [\n              "aa:bb:cc:11:22:33"\n            ],\n            "blacklist": [\n              "01:02:03:04:05:06",\n              "01:23:45:67:89:ab"\n            ],</b>\n\n            ...\n            \n        }\n    ],\n\n</pre>\n\n###  Control Services\n\nTBD (Needs description here)\n\n<!-- \n"options_weather": {\n"device_id": "XX:XX:XX:XX:XX:XX"\n},\n-->\n\n#<a name="notes"></a> Notes on devices\n## Weather station\nThe indoor module and outdoor module are fully supported.\nThe rain gauge and the wind gauge are in general supported, but these devices use characteristics, which are not supported by the home app.\n\nFor this reason the home app shows the devices as not supported. If you want to use this devices you should consider to use a different homekit app. For example elgato\'s <a href="https://itunes.apple.com/us/app/elgato-eve/id917695792" target="blank">eve</a> app is a good free alternative.\n\n## Thermostat\nThe thermostat is fully supported. There are a few things to know:\n\n* The allowed temperature ranges differ between netatmo themostat and apple home app. This results in a narrower range of possible temperatures.\n* Mapping of Temperature Modes between netatmo and apple is done as good as possible, but might be slightly confusing under certain conditions.\n* After setting a temperature, the thermostat might return to automatic mode. Check your netatmo settings.\n\n## Cameras (Welcome and Presence)\nThe camera devices are currently only supported as simple motion sensors.\nMotion detection might be delayed, since the polling is required an netatmo has strict request rate limits.\n\nAny events of Type "movement", "person" and "outdoor" will be considered as a motion.\n\nThis implementation will most likely be refactored in future.\n\n#FAQ\n\n##My rain/wind gauge shows up as not supported\nThis is due to limmited support of the home app. Try to use a different homekit app. Check [notes on devices](#notes) for further info.\n\n##I only get notifications when home app is opened\nThis themes to ba an issue with ios and hap lib. There is nothing I can do about it. Possible you should check the hombridge ifttt plugin with pushover app for notifications.\n\n##Updates of vlaues are delayed\nThis is due to rate limits from netatmo. If polling rate is increased your account might get blocked by netatmo\n\n##netatmo authentication failes\nPlease recheck your config settings and your netatmo account.\nSometimes the used netatmo API seems to have connection problems. Often a reload is enough\n\n##Things are messed up. How do I start from scratch?\nIn short:\n\n* stop homebridge.\n* reset your homekit config on the phone (delete the Home in home app).\n* remove the .hombridge/persist folder\n* check the .hombridge/config file\n* start homebridge\n\n##This is cool, how can I support?\nIf you like this, your welcome to give a small donation. Check button at top/bottom of page.\nIf you like to join development check the sources, open issues and pull requests.\nThanx!\n\n\n# Changes\n\n## 0.2.1\n* JSHint code checks\n* Configurable API Timing\n* Changed default request ratio to 1 per 15 minutes\n\n## 0.2.0\n* Version 0.2.0 is a complete refactoring, some config changes might be required\n* thermostat implementation is now supported in "home" App\n* Regular polling for updates (Trying to be nice to the API, so update may take a while to be seen on the phone)\n* Fully refactored, cleaner classes\n* renamed "welcome" devices to "camera"\n* support for "presence" devices\n* new motion detection \n* Using ES6\n* new homekit 0.4\n* netatmo API update\n* new logging API\n\n# Development\n\nFollowing information is not relevant for users who just want to access netatmo via homekit.\nIt is intented for software developers who want to modify / enhance the functionality of the software.\n\n## Terms\n\n<dl>\n <dt>Device</dt>\n <dd>A device in this context is a netatmo hadware device.</dd>\n\n <dt>Device Type</dt>\n <dd>Describes the type of the netatmo device i.e. weatherstation, thermostat or welcome.</dd>\n\n\n <dt>Module</dt>\n <dd>Some devices contain several modules (e.g. weatherstation: main module, rain gauge, outside module, wind gauge). A device or module results in an accessory</dd>\n \n</dl>\n\n## Concepts\n\nNew deviceTypes should be put into the */devices* folder. It might be helpful to use the existing deviceTypess as template and to inherit the NetatmoDevice. Each device provides one or more accessories which provide one or more services.\n\nServices are defined inside the */services* folder. The naming convention is, that a service source code file starts with the device name.\n\nThe default set of devices and services that are used is the one which resulted from earlier versions.\n\nPlease see Chapter **Advanced Configuration** on details about how to add a device or a service.\n\n## Mock API & Testing\n\nNew features should be developed with a test scenario. Tests are executed via travis-ci or npm test.\n\nFor debugging and test purposes the software contains a support for a mock netatmo api.\n\nThe mock-api is activate by putting a\n\n    mockapi: "name"\n\ninto the netatmo section of the config file.\n\nWhen activated there will be no calls to the netatmo API. Instead raw json data is read from file located in the */mockapi_calls* folder.\n\nThe file name is *[apimethod]-[name].json* where\n \n* *[apimethod]* is the name of the netatmo method to be called (e.g. getstationsdata )\n* *[name]* is the name given in the config file (e.g. wind)\n \nIf this file is not found a *[apimethod]-default.json* file is read.\nIf this is not found as well, empty data is returned.\n\n# TODO / Next Features\nFollowing things are to be developed next.\n\n* static code checks\n* release management\n* recheck thermostat ranges\n* enhance support for netatmo welcome (images?, callbacks?,)\n* complete tests (config, unit tests, devices)\n* add optional eve services including history data\n* recheck temperature units (Celsius - Fahrenheit)\n* support for min/max temperature\n* add Radio Link Quality characteristic\n* I18N for service and accessory names (config)\n* add SoftwareRevision characteristic -> plugin version\n* log callbacks with error != null\n* Review all //TODO comments from sources\n* document extended config (switch on/off devices/services)\n* fix env/tests\n* names in config\n* trigger switches (-> pushover, enigma, virtual switch for scenes -> push)\n\n----\n\nIs this plugin useful for you? Please buy me a beer ...\n[![Donate](https://img.shields.io/badge/Donate-PayPal-blue.svg)](https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=7ZGEPWHG5UH6S)\n\n<small>\nThank you for buying me a beer to follwing users:\n\n* 2016-07-18: Samuel J.\n* 2016-09-03: Alexis A. \n* 2016-09-16: Sylvain D. \n* 2016-11-01: Sebastian K.\n* 2016-11-04: Frank H.\n* 2017-02-25: Peter B.\n</small>\n'