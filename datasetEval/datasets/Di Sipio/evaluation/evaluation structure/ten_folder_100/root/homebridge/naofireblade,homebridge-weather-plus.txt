b'# homebridge-weather-plus\n[![npm](https://img.shields.io/npm/v/homebridge-weather-plus.svg?style=flat-square)](https://www.npmjs.com/package/homebridge-weather-plus)\n[![npm](https://img.shields.io/npm/dt/homebridge-weather-plus.svg?style=flat-square)](https://www.npmjs.com/package/homebridge-weather-plus)\n[![GitHub last commit](https://img.shields.io/github/last-commit/naofireblade/homebridge-weather-plus.svg?style=flat-square)](https://github.com/naofireblade/homebridge-weather-plus)\n[![Weather](https://img.shields.io/badge/weather-sunny-edd100.svg?style=flat-square)](https://github.com/naofireblade/homebridge-weather-plus)\n\nThis is a weather plugin for [homebridge](https://github.com/nfarina/homebridge) that features current observations, daily forecasts and history graphs for multiple locations and services. You can download it via [npm](https://www.npmjs.com/package/homebridge-weather-plus).  \n\n![Screenshots](https://user-images.githubusercontent.com/12081369/69379083-feb05300-0caf-11ea-9a0d-cf8e1879d007.png)\n\n>Screenshots 2 and 3 are taken from the Elgato Eve app.\n\nIf you like this plugin and find it useful, I would be forever grateful for your support:\n\n<a href="https://www.buymeacoffee.com/2D1nUuK36" target="_blank"><img width="140" src="https://bmc-cdn.nyc3.digitaloceanspaces.com/BMC-button-images/custom_images/orange_img.png" alt="Buy Me A Coffee"></a>\n\nFeel free to leave any feedback [here](https://github.com/naofireblade/homebridge-weather-plus/issues).\n\n## Features\n- Get [18 observation and forecast](#observations-and-forecasts) values for up to 7 days\n- Choose from 3 different weather [services](#choose-your-weather-service)\n- Add [multiple](#multiple-stations-configuration) locations/services\n- See the weather [history](#screenshots) in the Eve App\n- See translations and [icons](#screenshots) in the Eve App\n- Use all values in HomeKit rules with the Eve App\n\n## Choose your Weather Service\n\nThis plugin supports multiple weather services. Each has it\'s own advantages. The following table shows a comparison to help you choosing one.\n\n|                            |            Dark Sky (recommended)            |                   OpenWeatherMap                                 |            Weather Underground <sup>[1](#a1)</sup>               |\n|----------------------------|:--------------------------------------------:|:----------------------------------------------------------------:|:----------------------------------------------------------------:|\n| Current observation values |                      17                      |                                9                                 |                                12                                |\n| Forecast values            |                      18                      |                                11                                 |                                 0                                |\n| Forecast days              |                       7                      |                                 5                                |                                 0                                |\n| Location                   |                geo-coordinates               |                city name, city id, geo-coordinates               |                           station id                             |\n| Personal weather stations  |                      :x:                     |                        :heavy_check_mark:                        |                        :heavy_check_mark:                        |\n| Free                       |               :heavy_check_mark:             |                        :heavy_check_mark:                        |           :heavy_check_mark: (only if you own a station)         |\n| Register                   | [here](https://darksky.net/dev/register)     | [here](https://openweathermap.org/appid)                         | [here](https://www.wunderground.com/member/api-keys)             |\n*You can add more services easily by forking the project and submitting a pull request for a new api file.*\n\n> <b name="a1">1</b> You can use the weather underground service only if you can provide weather data from your own station in exchange.\n\n\n## Installation\n\n1. Install homebridge using: `npm install -g homebridge`\n2. Install this plugin using: `npm install -g homebridge-weather-plus` *Note: The installation might take 5 minutes.*\n3. Gather an API key for a weather service from the register link in the table above\n4. Update your configuration file. See the samples below.\n\n## Observations and Forecasts\n\nThe following observation and forecast values can be displayed and used in HomeKit rules.  \nI recommend using the Eve app to see all the values. However, if you don\'t want to use a 3rd party app, use the [compatibility mode](#compatibility) `home` for displaying most values in the Apple home app.\n\n- Air Pressure\n- Cloud Cover\n- Condition\n- Condition Category <sup>[2](#a2), </sup><sup>[3](#a3)</sup>\n- Dew Point\n- Humidity\n- Ozone\n- Rain Currently\n- Rain Last Hour\n- Rain All Day\n- Rain Chance\n- Snow Currently\n- Solar Radiation\n- Temperature\n- Temperature Min\n- Temperature Max\n- UV-Index\n- Visibility\n- Wind Direction\n- Wind Speed\n- Wind Speed Maximum\n- *Observation Time*\n- *Observation Station*\n- *Day of the forecast*\n\n> <b name="a2">2</b> Simple: clear (0), overcast (1), rain (2), snow (3)  \n> <b name="a3">3</b> Detailed: clear (0), few clouds (1), broken clouds (2), overcast (3), fog (4), drizzle (5), rain (6), hail (7), snow (8), severe weather (9)\n\n## Configuration\n\nBelow are example configurations for all weather apis.\n\n### Dark Sky\n\n**key**  \nThe API key that you get by [registering](https://darksky.net/dev/register) for the Dark Sky service.\n\n**locationGeo**  \nList with the latitude and longitude for your location (don\'t forget the square brackets). You can get your coordinates: [here](http://www.mapcoordinates.net/en).\n\n```json\n"platforms": [\n\t{\n\t\t"platform": "WeatherPlus",\n\t\t"service": "darksky",\n\t\t"key": "YOUR_API_KEY",\n\t\t"locationGeo": [52.5200066, 13.404954]\n\t}\n]\n```\n\n### OpenWeatherMap\n\n**key**  \nThe API key that you get by [registering](https://openweathermap.org/appid) for the Dark Sky service.\n\n**locationId**<sup>[4](#a4)</sup>  \nNumerical city id, can be found [here](https://openweathermap.org/find).\n\n**locationCity**<sup>[4](#a4)</sup>  \nCity name and optional country code, can be found [here](https://openweathermap.org/find).\n\n**locationGeo**<sup>[4](#a4)</sup>  \nList with the latitude and longitude for your location (don\'t forget the square brackets). You can get your coordinates: [here](http://www.mapcoordinates.net/en).\n\n> <b name="a4">4</b> You need only **one** of these location options.\n\n```json\n"platforms": [\n\t{\n\t\t"platform": "WeatherPlus",\n\t\t"service": "openweathermap",\n\t\t"key": "YOUR_API_KEY",\n\t\t"locationId": 2950159,\n\t\t"locationCity": "Berlin, DE",\n\t\t"locationGeo": [52.5200066, 13.404954]\n\t}\n]\n```\n\n### Weather Underground\n\nSince March 2019 you need to register your own weather station with Weather Underground to get weather data in exchange. After you registered your weather device ([here](https://www.wunderground.com/member/devices)), you can use the API.\n\n**key**  \nThe API key that you get by [registering](https://www.wunderground.com/member/api-keys) for the Weather Underground service.\n\n**stationId**  \nYour personal StationID.\n\n```json\n"platforms": [\n    {\n        "platform": "WeatherPlus",\n        "service": "weatherunderground",\n        "key": "YOUR_API_KEY",\n        "stationId": "YOUR_STATION_ID"\n    }\n]\n```\n\n## Advanced Configuration\n\nBelow are explanations for a lot of advanced parameters to adjust the plugin to your needs. All parameters are *optional*.\n\n<b name="compatibility">compatibility</b>  \nCompatibility for the Apple Home app, the Eve app or both. This is required due to limitations in the Apple Home app recognized weather conditions. The default is `"eve"`.  \n`"eve"` **(recommended)** Use this for the Eve app or another 3rd party HomeKit App. All conditions will be displayed. The Apple Home app will show only temperature and humidity.   \n`"eve2"` Same as above but the values for temperature, humidity and pressure will be grouped into a single row. The Apple Home app will show nothing.  \n`"home"` Use this if you don\'t want to install a 3rd party HomeKit App but want to see as many values as possible in the Apple Home app<sup>[5](#a4)</sup>. 3rd party apps will show some useless sensors that are required for Home app support.  \n`"both"` Combines eve and home. You will need to hide some useless sensors in the Eve app that are required for Home app support. But after that you will get a solution that looks nice in the Home app and in 3rd party apps at the same time.\n> <b name="a5">5</b> The following values will be represented as occupancy sensors that trigger on specific limits: CloudCover > 20%, UVIndex > 2, WindSpeed > 4 m/s, Rain, Snow\n\n**conditionCategory**  \nDetail level of the condition category. Not available for WeatherUnderground. Default is `"simple"`.  \n`"simple"` [4 different categories](#a2)  \n`"detailed"` [10 different categories](#a3)\n\n**extraHumidity**  \nSeparate humidity from the weather accessory to an own accessory if set to `true`. Default is `false`. Only available for compatibility modes `"eve"` and `"both"`.\n\n**forecast**  \nList of forecast days with 0 for today, 1 for tomorrow, 2 for in 2 days etc. Default are none `[]`. Maximum depends on the choosen [weather service](#choose-your-weather-service).\n\n**hidden**  \nList of observation and forecast values that should not be displayed. Possible options are `["AirPressure", "CloudCover", "Condition", "ConditionCategory", "DewPoint", "ForecastDay", "Humidity", "ObservationStation", "ObservationTime", "Ozone", "Rain1h", "RainBool", "RainChance", "RainDay", "SnowBool", "SolarRadiation", "TemperatureMin", "UVIndex", "Visibility", "WindDirection", "WindSpeed", "WindSpeedMax"]`. Don\'t forget the square brackets.\n\n**interval**  \nUpdate interval in minutes. The default is `4` minutes because the rate for free API keys is limited.\n\n**language**  \nTranslation for the current day and the weather report. Available languages can be found [here](https://github.com/darkskyapp/translations/tree/master/lib/lang). The default is `en`.\n\n**nameNow**  \nName for the current condition accessory. The default is `"Now"`. You could set this to your city name or weather service type.\n\n**nameForecast**  \nName for the forecast accessories. Adds a prefix to the forecast days. You could set this to your city name or weather service type as well.\n\n**now**\nOption to hide the Now accessory if you only need forecasts. Default is `true` which shows the Now accessory. Set to `false` to hide it.\n\n**units**  \nConversions used for reporting values. The default is `"metric"`. The options are:  \n`"si"` or `"metric"`  \n`"us"` or `"imperial"`  \n`"ca"` to report wind speeds in km/h instead of m/s  \n`"uk"` to report visibility in miles and wind speeds in km/h instead of m/s\n\n**fakegatoParameters**  \nCustomization of the history storage system. By default the history is persisted on the filesystem. You can set your own option using this parameter. In order to change the [location of the persisted file](https://github.com/simont77/fakegato-history#file-system) or to use [GoogleDrive](https://github.com/simont77/fakegato-history#google-drive).\n **Do not** modify the parameter for the fakegato internal timer.\n\n### Example\n\n```json\n"platforms": [\n    {\n        "platform": "WeatherPlus",\n        "service": "darksky",\n        "key": "XXXXXXXXXXXXXXX",\n        "locationGeo": [52.5200066,13.404954],\n        "compatibility": "both",\n        "conditionCategory": "detailed",\n        "forecast": [0,1,2,3,4,5,6],\n        "hidden": ["CloudCover", "DewPoint"],\n        "interval": 5,\n        "language": "en",\n        "nameNow": "Berlin",\n        "nameForecast": "Berlin Forecast",\n        "now": true,\n        "units": "metric",\n    }\n]\n```\n\n## Multiple Stations Configuration\n\nYou can set up multiple stations for different locations and weather services by putting your configuration in a **stations** array.\nThe following parameters are global and must be placed outside of the array: `platform`, `interval`, `units`.\n\nEach stations must have a unique displayName. If you don\'t set one, the plugin will take care of that.\n\n### Example\n\n```json\n"platforms": [\n    {\n        "platform": "WeatherPlus",\n        "interval": 5,\n        "units": "si",\n        "stations": [\n            {\n                "displayName": "Berlin",\n                "displayNameForecast": "Berlin forefacst",\n                "service": "darksky",\n                "key": "YOUR_API_KEY",\n                "forecast": [0,1,2,3,4,5,6],\n                "locationGeo": [52.5200066,13.404954]\n            },\n            {\n                "displayName": "Los Angeles",\n                "displayNameForecast": "Los Angeles forecast",\n                "service": "darksky",\n                "key": "YOUR_API_KEY",\n                "forecast": [1],\n                "locationGeo": [34.0536909,-118.2427666]\n            }\n        ]\n    }\n]\n```\n\n## Example Use Cases\n\n- Switch on a blue light in the morning when the chance for rain is above 20% today (or white when the forecast condition is snow / yellow when it\'s sunny).\n- Start your automatic garden irrigation in the evening, depending on the amount of rain today and the forecast for tomorrow.\n\n**Hint:** To trigger rules based on time and weather condition you will need a plugin like [homebridge-delay-switch](https://www.npmjs.com/package/homebridge-delay-switch). Create a dummy switch that resets after some seconds. Set this switch to on with a timed rule. Then create a condition rule that triggers when the switch goes on depending on weather conditions of your choice.\n\n## Contributors\nMany thanks go to\n- [simont77](https://github.com/simont77) for his fakegato-history library, the eve weather emulation, the multiple stations feature and several other great improvements\n- [GatoPharaoh](https://github.com/GatoPharaoh) for his interval option pull request\n- [David Werth](https://github.com/werthdavid) for integrating the OpenWeatherMap and Yahoo apis\n- [Marshall T. Rose](https://github.com/mrose17) for adding support for imperial units and the displayName parameter\n- [Bill Waggoner](https://github.com/ctgreybeard) for his fix for the crashing wunderground api\n- [Russell Sonnenschein](https://github.com/ctgreybeard) for adding the new 2019 weatherunderground api\n\nThis plugin is a fork of [homebridge-weather-station](https://github.com/kcharwood/homebridge-weather-station) which is no longer being developed. That one was a fork of [homebridge-wunderground](https://www.npmjs.com/package/homebridge-wunderground).\n\n## Attribution\n- [Powered by Dark Sky](https://darksky.net/poweredby/)\n- [Powered by Weather Underground](https://www.wunderground.com/)\n- [Powered by OpenWeatherMap](https://openweathermap.org/)\n'