b'# NativeScript NFC plugin\n\n[![Build Status][build-status]][build-url]\n[![NPM version][npm-image]][npm-url]\n[![Downloads][downloads-image]][npm-url]\n[![Twitter Follow][twitter-image]][twitter-url]\n\n[build-status]:https://travis-ci.org/EddyVerbruggen/nativescript-nfc.svg?branch=master\n[build-url]:https://travis-ci.org/EddyVerbruggen/nativescript-nfc\n[npm-image]:http://img.shields.io/npm/v/nativescript-nfc.svg\n[npm-url]:https://npmjs.org/package/nativescript-nfc\n[downloads-image]:http://img.shields.io/npm/dm/nativescript-nfc.svg\n[twitter-image]:https://img.shields.io/twitter/follow/eddyverbruggen.svg?style=social&label=Follow%20me\n[twitter-url]:https://twitter.com/eddyverbruggen\n\n<img src="https://raw.githubusercontent.com/EddyVerbruggen/nativescript-nfc/master/screenshots/ios-demo-before-scan.PNG" width="180px" height="320px"/> <img src="https://raw.githubusercontent.com/EddyVerbruggen/nativescript-nfc/master/screenshots/ios-demo-after-scan.PNG" width="180px" height="320px"/> <img src="https://raw.githubusercontent.com/EddyVerbruggen/nativescript-nfc/master/screenshots/android-demo.png" width="180px" height="320px"/>\n\n## Installation\nFrom the command prompt go to your app\'s root folder and execute:\n\n```\ntns plugin add nativescript-nfc\n```\n\n## iOS Setup\niOS requires you to enable \'NFC Tag Reading\' for your App ID [here](https://developer.apple.com/account/ios/identifier/bundle).\n\nAlso, add this to your `App_Resources/iOS/app.entitlements` (mind the name!) file:\n \n```xml\n<key>com.apple.developer.nfc.readersession.formats</key>\n<array>\n\t<string>NDEF</string>\n</array>\n``` \n\nThe [demo app](demo) has this:\n\n```xml\n<?xml version="1.0" encoding="UTF-8"?>\n<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n<plist version="1.0">\n<dict>\n\t<key>com.apple.developer.nfc.readersession.formats</key>\n\t<array>\n\t\t<string>NDEF</string>\n\t</array>\n</dict>\n</plist>\n```\n\n## Android Setup\n> \xe2\x9a\xa0\xef\xb8\x8f Since plugin version 4.0.0 this section is no longer needed, but you\'ll  HAVE to run NativeScript 5.4.0 or newer. If you\'re using an older NativeScript, please stick to a plugin version < 4.0.0.\n\nUpdate the `activity` entry in your `App_Resources/Android/AndroidManifest.xml` file:\n\n```xml\n<activity\n        android:name="com.tns.NativeScriptNfcActivity"\n        android:label="@string/title_activity_kimera"\n        android:configChanges="keyboardHidden|orientation|screenSize">\n``` \n\nSo replace `com.tns.NativeScriptActivity` with `com.tns.NativeScriptNfcActivity`.\n\n#### Webpack (again, no longer needed from plugin version 4.0.0)\nIf you\'re using Webpack to bundle your app you\'ll need to add 1 line of configuration in case you\'re targeting Android.\n\n- Open `webpack.config.js` (it\'s in the root of your project).\n- Look for an Array named `appComponents`, which likely contains stuff like `"tns-core-modules/ui/frame"`.\n- Add `resolve(__dirname, "node_modules/nativescript-nfc/nfc-activity.android.js")` [as shown here](https://github.com/EddyVerbruggen/nativescript-nfc/blob/6dfa0ff4f77cab5ab7f494ac3055f728ce51d131/demo/webpack.config.js#L17).\n\n## Demo app (those screenshots above)\nWant to dive in quickly? Check out [the demo](https://github.com/EddyVerbruggen/nativescript-nfc/tree/master/demo)!\n\nYou can run the demo app from the root of the project by typing `npm run demo.ios.device` or `npm run demo.android`.\n\n> [This is what it looks like in action on iOS](https://twitter.com/eddyverbruggen/status/899617497741185025)!\n\n## API\n\n### `available`\nNot all devices have an NFC chip we can tap in to (and on iOS you need to build with Xcode 9+), so check this beforehand:\n\n##### JavaScript\n```js\n// require the plugin\nvar Nfc = require("nativescript-nfc").Nfc;\n\n// instantiate the plugin\nvar nfc = new Nfc();\n\nnfc.available().then(\n  function(avail) {\n    console.log(avail ? "Yes" : "No");\n  }\n);\n```\n\n##### TypeScript\n```typescript\n// require the plugin\nimport { Nfc } from "nativescript-nfc";\n\n// instantiate the plugin\nlet nfc = new Nfc();\n\nnfc.available().then((avail) => {\n    console.log(avail ? "Yes" : "No");\n});\n```\n\n### `enabled`\nA device may have an NFC chip, but it needs to be turned on \xe2\x9c\x85 in order to be available for this plugin. So if `available` returns `true` and `enabled` returns `false` you should prompt the user to turn NFC on in the device settings.\n\n##### JavaScript\n```js\nnfc.enabled().then(\n  function(on) {\n    console.log(on ? "Yes" : "No");\n  }\n);\n```\n\n##### TypeScript\n```typescript\nnfc.enabled().then((on) => {\n    console.log(on ? "Yes" : "No");\n});\n```\n\n### `setOnNdefDiscoveredListener`\nYou may want to get notified when an Ndef tag was discovered. You can pass in a callback function that gets invoked when that is the case.\n\nNote that blank/erased NFC tags are not returned here, but through `setOnTagDiscoveredListener` instead.\n\nSee the [definition of NfcNdefData](https://github.com/EddyVerbruggen/nativescript-nfc/blob/master/nfc.common.d.ts#L27-L33) to learn what is returned to the callback function.\n\nFor iOS you can pass in these options (see the TypeScript example below):\n* `stopAfterFirstRead: boolean` (default `false`): don\'t continue scanning after a tag was read. \n* `scanHint: string` (default `undefined`): Show a little hint in the scan UI.\n\n##### JavaScript\n```js\nnfc.setOnNdefDiscoveredListener(function(data) {\n    // see the TypeScript example below\n}).then(\n  function() {\n    console.log("OnNdefDiscovered listener added");\n  }\n);\n```\n\n##### TypeScript\n```typescript\nimport { NfcNdefData } from "nativescript-nfc";\n\nnfc.setOnNdefDiscoveredListener((data: NfcNdefData) => {\n  // data.message is an array of records, so:\n  if (data.message) {\n    for (let m in data.message) {\n      let record = data.message[m];\n      console.log("Ndef discovered! Message record: " + record.payloadAsString);\n    }\n  }\n}, {\n  // iOS-specific options\n  stopAfterFirstRead: true,\n  scanHint: "Scan a tag, baby!"\n}).then(() => {\n    console.log("OnNdefDiscovered listener added");\n});\n```\n\nYou can pass in `null` instead of a callback function if you want to remove the listener.\n\n##### TypeScript\n```typescript\nnfc.setOnNdefDiscoveredListener(null).then(() => {\n    console.log("OnNdefDiscovered listener removed");\n});\n```\n\n### `setOnTagDiscoveredListener` (Android only)\nYou may want to get notified when an NFC tag was discovered.\nYou can pass in a callback function that gets invoked when that is the case.\n\nNote that Ndef tags (which you may have previously written data to) are not returned here,\nbut through `setOnNdefDiscoveredListener` instead.\n\nSee the [definition of NfcTagData](https://github.com/EddyVerbruggen/nativescript-nfc/blob/master/nfc.common.d.ts#L14-L17) to learn what is returned to the callback function.\n\n##### JavaScript\n```js\nnfc.setOnTagDiscoveredListener(function(data) {\n  console.log("Discovered a tag with ID " + data.id);\n}).then(\n  function() {\n    console.log("OnTagDiscovered listener added");\n  }\n);\n```\n\n##### TypeScript\n```typescript\nimport { NfcTagData } from "nativescript-nfc";\n\nnfc.setOnTagDiscoveredListener((data: NfcTagData) => {\n  console.log("Discovered a tag with ID " + data.id);  \n}).then(() => {\n    console.log("OnTagDiscovered listener added");\n});\n```\n\nYou can pass in `null` instead of a callback function if you want to remove the listener.\n\n##### TypeScript\n```typescript\nnfc.setOnTagDiscoveredListener(null).then(() => {\n    console.log("OnTagDiscovered listener removed");\n});\n```\n\n### `writeTag` (Android only)\nYou can write to a tag as well with this plugin. At the moment you can write either plain text or a Uri. The latter will launch the browser on an Android device if the tag is scanned (unless an app handling Ndef tags itself is active at that moment, like an app with this plugin - so just close the app to test this feature).\n\nNote that you can write multiple items to an NFC tag so the input is an object with Arrays of various types (`textRecord` and `uriRecord` are currently supported). See the [TypeScript definition](https://github.com/EddyVerbruggen/nativescript-nfc/blob/master/nfc.common.d.ts#L10-L13) for details, but these examples should get you going:\n\n##### Writing 2 textRecords in JavaScript\n```js\nnfc.writeTag({\n    textRecords: [\n        {\n          id: [1],\n          text: "Hello"\n        },\n        {\n          id: [3,7],\n          text: "Goodbye"\n        }\n    ]\n}).then(function() {\n    console.log("Wrote text records \'Hello\' and \'Goodbye\'");\n}, function(err) {\n    alert(err);\n});\n```\n\n##### Writing a uriRecord in TypeScript\n```typescript\nnfc.writeTag({\n    uriRecords: [\n        {\n          id: [100],\n          uri: "https://www.progress.com"\n        }\n    ]\n}).then(() => {\n    console.log("Wrote Uri record \'https://www.progress.com");\n}, (err) => {\n    alert(err);\n});\n```\n\n### `eraseTag` (Android only)\nAnd finally, you can erase all content from a tag if you like.\n\n##### JavaScript\n```js\nnfc.eraseTag().then(\n  function() {\n    console.log("Tag erased");\n  }\n);\n```\n\n##### TypeScript\n```typescript\nnfc.eraseTag().then(() => {\n    console.log("Tag erased");\n});\n```\n\n## Tips\n### Writing to an empty tag\nYou first need to "discover" it with `setOnTagDiscoveredListener` (see below). While you\'re still "near" the tag you can call `writeTag`.\n\n### Writing to a non-empty tag\nSame as above, but discovery is done through `setOnNdefDiscoveredListener`.\n\n## Future work\n* Peer to peer communication between two NFC-enabled devices.\n* Support for writing other types in addition to \'text\' and \'uri\'.\n'