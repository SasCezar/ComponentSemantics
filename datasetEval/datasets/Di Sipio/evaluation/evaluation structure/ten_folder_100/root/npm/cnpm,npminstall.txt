b'# npminstall\n\n[![NPM version][npm-image]][npm-url]\n[![build status][travis-image]][travis-url]\n[![appveyor build status][appveyor-image]][appveyor-url]\n[![Test coverage][codecov-image]][codecov-url]\n[![David deps][david-image]][david-url]\n[![Known Vulnerabilities][snyk-image]][snyk-url]\n[![npm download][download-image]][download-url]\n\n[npm-image]: https://img.shields.io/npm/v/npminstall.svg?style=flat-square\n[npm-url]: https://npmjs.org/package/npminstall\n[travis-image]: https://img.shields.io/travis/cnpm/npminstall.svg?style=flat-square\n[travis-url]: https://travis-ci.org/cnpm/npminstall\n[appveyor-image]: https://ci.appveyor.com/api/projects/status/xyn5tj86tvdy4cfe/branch/master?svg=true\n[appveyor-url]: https://ci.appveyor.com/project/eggjs/npminstall\n[codecov-image]: https://codecov.io/gh/cnpm/npminstall/branch/master/graph/badge.svg\n[codecov-url]: https://codecov.io/gh/cnpm/npminstall\n[david-image]: https://img.shields.io/david/cnpm/npminstall.svg?style=flat-square\n[david-url]: https://david-dm.org/cnpm/npminstall\n[snyk-image]: https://snyk.io/test/npm/npminstall/badge.svg?style=flat-square\n[snyk-url]: https://snyk.io/test/npm/npminstall\n[download-image]: https://img.shields.io/npm/dm/npminstall.svg?style=flat-square\n[download-url]: https://npmjs.org/package/npminstall\n\nLet `npm install` fast and easy.\n\n## Use as Cli\n\n### Install\n\n```bash\n$ npm install npminstall -g\n```\n\n### Usage\n\n#### In cnpm\n\nIt is integrated in [cnpm](https://github.com/cnpm/cnpm).\n\n```bash\n$ npm install cnpm -g\n$ cnpm install  // will use npminstall\n```\n\n#### npminstall\n\n```bash\nUsage:\n\n  npminstall\n  npminstall <pkg>\n  npminstall <pkg>@<tag>\n  npminstall <pkg>@<version>\n  npminstall <pkg>@<version range>\n  npminstall <folder>\n  npminstall <tarball file>\n  npminstall <tarball url>\n  npminstall <git:// url>\n  npminstall <github username>/<github project>\n\nCan specify one or more: npm install ./foo.tgz bar@stable /some/folder\nIf no argument is supplied, installs dependencies from ./package.json.\n\nOptions:\n\n  --production: won\'t install devDependencies\n  --save, --save-dev, --save-optional: save installed dependencies into package.json\n  -g, --global: install devDependencies to global directory which specified in `$ npm config get prefix`\n  -r, --registry: specify custom registry\n  -c, --china: specify in china, will automatically using chinese npm registry and other binary\'s mirrors\n  -d, --detail: show detail log of installation\n  --trace: show memory and cpu usages traces of installation\n  --ignore-scripts: ignore all preinstall / install and postinstall scripts during the installation\n  --no-optional: ignore optionalDependencies during the installation\n  --forbidden-licenses: forbit install packages which used these licenses\n  --engine-strict: refuse to install (or even consider installing) any package that claims to not be compatible with the current Node.js version.\n  --flatten: flatten dependencies by matching ancestors dependencies\n  --registry-only: make sure all packages install from registry. Any package is installed from remote(e.g.: git, remote url) cause install fail.\n  --cache-strict: use disk cache even on production env\n```\n\n#### npmuninstall\n\n```bash\nUsage:\n\n  npmuninstall <pkg>\n  npmuninstall <pkg>@<version>\n  npmuninstall <pkg>@<version> [<pkg>@<version>]\n```\n\n#### npmlink\n\n```bash\nUsage:\n\n  npmlink <folder>\n```\n\n## Use as Lib\n\n### Install\n\n```bash\n$ npm install npminstall --save\n```\n\n### Usage\n\n```js\nconst npminstall = require(\'npminstall\');\n\n(async () => {\n  await npminstall({\n    // install root dir\n    root: process.cwd(),\n    // optional packages need to install, default is package.json\'s dependencies and devDependencies\n    // pkgs: [\n    //   { name: \'foo\', version: \'~1.0.0\' },\n    // ],\n    // install to specific directory, default to root\n    // targetDir: \'/home/admin/.global/lib\',\n    // link bin to specific directory (for global install)\n    // binDir: \'/home/admin/.global/bin\',\n    // registry, default is https://registry.npmjs.org\n    // registry: \'https://registry.npmjs.org\',\n    // debug: false,\n    // storeDir: root + \'node_modules\',\n    // ignoreScripts: true, // ignore pre/post install scripts, default is `false`\n    // forbiddenLicenses: forbit install packages which used these licenses\n  });\n})().catch(err => {\n  console.error(err);\n});\n```\n\n## Support Features\n\n- [x] all types of npm package\n  - [x] a) a folder containing a program described by a package.json file (`npm install file:eslint-rule`)\n  - [x] b) a gzipped tarball containing (a) (`npm install ./rule.tgz`)\n  - [x] c) a url that resolves to (b) (`npm install https://github.com/indexzero/forever/tarball/v0.5.6`)\n  - [x] d) a <name>@<version> that is published on the registry with (c)\n  - [x] e) a <name>@<tag> (see npm-dist-tag) that points to (d)\n  - [x] f) a <name> that has a "latest" tag satisfying (e)\n  - [x] g) a <git remote url> that resolves to (a) (`npm install git://github.com/timaschew/cogent#fix-redirects`)\n- [x] All platform support\n- [x] global install (`-g, --global`)\n- [x] `preinstall`, `install`, `postinstall` scripts\n- [x] node-gyp\n  - [x] node-pre-gyp\n- [x] bin (yo@1.6.0, fsevents@1.0.6)\n- [x] scoped package\n- [x] bundleDependencies / bundledDependencies (node-pre-gyp@0.6.19, fsevents@1.0.6)\n- [x] optionalDependencies (pm2@1.0.0)\n- [x] peerDependencies (co-defer@1.0.0, co-mocha@1.1.2, estraverse-fb@1.3.1)\n- [x] deprecate message\n- [x] `--production` mode\n- [x] `save`, `save-dev`, `save-optional`\n- [x] support `ignore-scripts`\n- [x] uninstall\n- [x] resolutions\n\n## Different with NPM\n\nThis project is inspired by [pnpm](https://github.com/pnpm/pnpm), and has a similar store structure like pnpm. You can read [pnpm vs npm](https://github.com/pnpm/pnpm/blob/master/docs/pnpm-vs-npm.md) to see the different with npm.\n\n### Limitations\n\n- You can\'t install from [shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap)(and don\'t want to support for now).\n- Peer dependencies are a little trickier to deal with(see rule 1 below).\n- You can\'t publish npm modules with bundleDependencies managed by npminstall(because of rule 2 below).\n- `npminstall` will collect all postinstall scripts, and execute them until all dependencies installed.\n- If last install failed, better to cleanup node_modules directory before retry.\n\n## `node_modules` directory\n\nTwo rules:\n\n1. The latest version of modules will link at `options.storeDir`\'s `node_modules`.\n2. Module\'s dependencies will link at module\'s `node_modules`.\n\ne.g.:\n\n- app: `{ "dependencies": { "debug": "2.2.0" } }` (root)\n- debug@2.2.0: `{ "dependencies": { "ms": "0.7.1" } }`\n\n```bash\napp/\n\xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 package.json\n\xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 node_modules\n    \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 _debug@2.2.0@debug\n    \xe2\x94\x82\xc2\xa0\xc2\xa0 \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 node_modules\n    \xe2\x94\x82\xc2\xa0\xc2\xa0 \xe2\x94\x82\xc2\xa0\xc2\xa0 \xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 ms -> ../../_ms@0.7.1@ms\n    \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 _ms0.7.1@ms\n    \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 debug -> _debug@2.2.0@debug\n    \xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 ms -> _ms@0.7.1@ms # for peerDependencies\n```\n\n### flattened vs nested\n\nnpminstall will always try to install the maximal matched version of semver:\n\n```\nroot/\n  koa@1.1.0\n  mod/\n    koa@~1.1.0\n# will install two different version of koa when use npminstall.\n```\n\nyou can enable flatten mode by `--flatten` flag, in this mod, npminstall will try to use ancestors\' dependencies to minimize the dependence-tree.\n\n```\nroot/\n  koa@1.1.0\n  mod/\n    koa@~1.1.0\n\nroot/\n  koa@1.1.0\n  mod/\n    koa@^1.1.0\n# both the same version: 1.1.0\n\nroot/\n  koa@~1.1.0\n  mod/\n    koa@^1.1.0\n# both the same version: 1.1.2\n\nroot/\n  mod/\n    koa@^1.1.0\n  moe/\n    koa@~1.1.0\n# two different versions\n```\n\n**npminstall will always treat `n.x` and `n.m.x` as flattened**\n\n```\nroot/\n  koa@1.1.0\n  mod/\n    koa@1.1.x\nboth the same version: 1.1.0\n\nroot/\n  koa@~1.1.0\n  mod/\n    koa@1.x\nboth the same version: 1.1.2\n```\n\n## Resolutions\n\nsupport [selective version resolutions](https://yarnpkg.com/en/docs/selective-version-resolutions) like yarn. which lets you define custom package versions inside your dependencies through the resolutions field in your `package.json` file.\n\n## Benchmarks\n\nhttps://github.com/cnpm/npminstall-benchmark\n\n### cnpmjs.org install\n\n- npminstall@1.2.0\n- pnpm@0.18.0\n- npm@2.14.12\n\ncli | real | user | sys\n--- | ---  | ---  | ---\nnpminstall | 0m10.908s | 0m8.733s | 0m4.282s\nnpminstall with cache | 0m8.815s | 0m7.492s | 0m3.644s\nnpminstall --no-cache | 0m10.279s | 0m8.255s | 0m3.932s\npnpm | 0m13.509s | 0m11.650s | 0m4.443s\nnpm | 0m28.171s | 0m26.085s | 0m8.219s\nnpm with cache | 0m20.939s | 0m19.415s | 0m6.302s\n\n### pnpm benchmark\n\nsee https://github.com/pnpm/pnpm#benchmark\n\n```bash\nnpminstall babel-preset-es2015 browserify chalk debug minimist mkdirp\n    real\t0m8.929s       user\t0m5.606s       sys\t0m2.913s\n```\n\n```bash\npnpm i babel-preset-es2015 browserify chalk debug minimist mkdirp\n    real\t0m12.998s      user\t0m8.653s       sys\t0m3.362s\n```\n\n```bash\nnpm i babel-preset-es2015 browserify chalk debug minimist mkdirp\n    real\t1m4.729s       user\t0m55.589s      sys\t0m23.135s\n```\n\n## License\n\n[MIT](LICENSE.txt)\n<!-- GITCONTRIBUTOR_START -->\n\n## Contributors\n\n|[<img src="https://avatars0.githubusercontent.com/u/156269?v=4" width="100px;"/><br/><sub><b>fengmk2</b></sub>](https://github.com/fengmk2)<br/>|[<img src="https://avatars3.githubusercontent.com/u/985607?v=4" width="100px;"/><br/><sub><b>dead-horse</b></sub>](https://github.com/dead-horse)<br/>|[<img src="https://avatars3.githubusercontent.com/u/543405?v=4" width="100px;"/><br/><sub><b>ibigbug</b></sub>](https://github.com/ibigbug)<br/>|[<img src="https://avatars1.githubusercontent.com/u/507615?v=4" width="100px;"/><br/><sub><b>afc163</b></sub>](https://github.com/afc163)<br/>|[<img src="https://avatars0.githubusercontent.com/u/465125?v=4" width="100px;"/><br/><sub><b>yesmeck</b></sub>](https://github.com/yesmeck)<br/>|[<img src="https://avatars1.githubusercontent.com/u/360661?v=4" width="100px;"/><br/><sub><b>popomore</b></sub>](https://github.com/popomore)<br/>|\n| :---: | :---: | :---: | :---: | :---: | :---: |\n|[<img src="https://avatars3.githubusercontent.com/u/319494?v=4" width="100px;"/><br/><sub><b>welladamm</b></sub>](https://github.com/welladamm)<br/>|[<img src="https://avatars3.githubusercontent.com/u/7336582?v=4" width="100px;"/><br/><sub><b>weihong1028</b></sub>](https://github.com/weihong1028)<br/>|[<img src="https://avatars1.githubusercontent.com/u/1195765?v=4" width="100px;"/><br/><sub><b>LeoYuan</b></sub>](https://github.com/LeoYuan)<br/>|[<img src="https://avatars3.githubusercontent.com/u/13602053?v=4" width="100px;"/><br/><sub><b>cnlon</b></sub>](https://github.com/cnlon)<br/>|[<img src="https://avatars1.githubusercontent.com/u/6753092?v=4" width="100px;"/><br/><sub><b>magicae</b></sub>](https://github.com/magicae)<br/>|[<img src="https://avatars3.githubusercontent.com/u/431376?v=4" width="100px;"/><br/><sub><b>marcbachmann</b></sub>](https://github.com/marcbachmann)<br/>|\n|[<img src="https://avatars2.githubusercontent.com/u/19733683?v=4" width="100px;"/><br/><sub><b>snyk-bot</b></sub>](https://github.com/snyk-bot)<br/>|[<img src="https://avatars2.githubusercontent.com/u/227713?v=4" width="100px;"/><br/><sub><b>atian25</b></sub>](https://github.com/atian25)<br/>|[<img src="https://avatars0.githubusercontent.com/u/3364271?v=4" width="100px;"/><br/><sub><b>tommytroylin</b></sub>](https://github.com/tommytroylin)<br/>|[<img src="https://avatars1.githubusercontent.com/u/3922719?v=4" width="100px;"/><br/><sub><b>wssgcg1213</b></sub>](https://github.com/wssgcg1213)<br/>|[<img src="https://avatars2.githubusercontent.com/u/4136679?v=4" width="100px;"/><br/><sub><b>yibn2008</b></sub>](https://github.com/yibn2008)<br/>|[<img src="https://avatars2.githubusercontent.com/u/19908330?v=4" width="100px;"/><br/><sub><b>hyj1991</b></sub>](https://github.com/hyj1991)<br/>|\n[<img src="https://avatars3.githubusercontent.com/u/13431452?v=4" width="100px;"/><br/><sub><b>vuchan</b></sub>](https://github.com/vuchan)<br/>\n\nThis project follows the git-contributor [spec](https://github.com/xudafeng/git-contributor), auto updated at `Wed May 08 2019 18:02:56 GMT+0800`.\n\n<!-- GITCONTRIBUTOR_END -->\n'