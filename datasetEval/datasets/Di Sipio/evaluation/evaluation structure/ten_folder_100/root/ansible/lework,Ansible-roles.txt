b'# **Ansible roles \xe6\x80\x8e\xe4\xb9\x88\xe7\x94\xa8\xef\xbc\x9f** ![GitHub](https://img.shields.io/github/license/lework/Ansible-roles) \n\n# \xe7\xb3\xbb\xe7\xbb\x9f\xe7\x8e\xaf\xe5\xa2\x83\nos:  `Centos 6.7 X64`\n\npython: `2.6.6`\n\n# \xe5\xae\x89\xe8\xa3\x85ansible\xe5\x92\x8cgit\n\n```bash\n[root@node ~]# yum install -y ansible git\n[root@node ~]# ansible --version\nansible 2.2.1.0\n  config file = /etc/ansible/ansible.cfg\n  configured module search path = Default w/o overrides\n```\n\n## \xe8\xae\xbe\xe7\xbd\xaeansible\n\xe5\x85\xb3\xe9\x97\xad\xe4\xb8\xbb\xe6\x9c\xbassh known_hosts\xe6\xa3\x80\xe6\x9f\xa5\n\xe9\x85\x8d\xe7\xbd\xae\xe6\x96\x87\xe4\xbb\xb6\xef\xbc\x9a/etc/ansible/ansible.cfg\n```vim\n 59 host_key_checking = False\n```\n\n## \xe4\xbd\xbf\xe7\x94\xa8git \xe5\x85\x8b\xe9\x9a\x86ansible role\n```bash\n[root@node roles]# git clone https://github.com/lework/Ansible-roles.git /etc/ansible/roles/\nInitialized empty Git repository in /etc/ansible/roles/.git/\nremote: Counting objects: 165, done.\nremote: Compressing objects: 100% (95/95), done.\nremote: Total 165 (delta 37), reused 152 (delta 24), pack-reused 0\nReceiving objects: 100% (165/165), 26.01 KiB | 19 KiB/s, done.\nResolving deltas: 100% (37/37), done.\n[root@node roles]# ll /etc/ansible/roles/\n\xe6\x80\xbb\xe7\x94\xa8\xe9\x87\x8f 36\ndrwxr-xr-x 5 root root 4096 3\xe6\x9c\x88  11 11:54 iptables\ndrwxr-xr-x 5 root root 4096 3\xe6\x9c\x88  11 11:54 java\ndrwxr-xr-x 4 root root 4096 3\xe6\x9c\x88  11 11:54 mvn\ndrwxr-xr-x 5 root root 4096 3\xe6\x9c\x88  11 11:54 nodejs\ndrwxr-xr-x 5 root root 4096 3\xe6\x9c\x88  11 11:54 os-init\ndrwxr-xr-x 5 root root 4096 3\xe6\x9c\x88  11 11:54 python2.7\ndrwxr-xr-x 4 root root 4096 3\xe6\x9c\x88  11 11:54 repo-epel\ndrwxr-xr-x 4 root root 4096 3\xe6\x9c\x88  11 11:54 ruby\ndrwxr-xr-x 5 root root 4096 3\xe6\x9c\x88  11 11:54 supervisor\n[root@node roles]# \n```\n\n## \xe6\xb7\xbb\xe5\x8a\xa0\xe4\xb8\xbb\xe6\x9c\xba\xe6\xb8\x85\xe5\x8d\x95\n\xe8\xbf\x99\xe9\x87\x8c\xe4\xbb\xa5192.168.77.130\xe4\xb8\xbb\xe6\x9c\xba\xe4\xb8\xba\xe4\xbe\x8b\xef\xbc\x8c\xe5\xb9\xb6\xe5\xb0\x86\xe5\x85\xb6\xe8\xae\xbe\xe4\xb8\xbanode2\xe7\xbb\x84\xe5\x86\x85\xe3\x80\x82\n```\n#/etc/ansible/hosts\n[node2]\n192.168.77.130 ansible_ssh_pass=123456\n```\n\n## \xe6\x9f\xa5\xe7\x9c\x8brole\xe7\x9a\x84README.md\xe6\x96\x87\xe6\xa1\xa3\n\n```\n# Ansible Role: python2.7\n\nCentos 6.7\xe7\x89\x88\xe6\x9c\xac\xe4\xb8\xad\xe7\x9a\x84python2.6\xe5\x8d\x87\xe7\xba\xa7\xe5\x88\xb02.7\n\n## \xe8\xa6\x81\xe6\xb1\x82\n\n\xe6\xad\xa4\xe8\xa7\x92\xe8\x89\xb2\xe4\xbb\x85\xe5\x9c\xa8RHEL\xe5\x8f\x8a\xe5\x85\xb6\xe8\xa1\x8d\xe7\x94\x9f\xe4\xba\xa7\xe5\x93\x81\xe4\xb8\x8a\xe8\xbf\x90\xe8\xa1\x8c\xe3\x80\x82\n\n## \xe6\xb5\x8b\xe8\xaf\x95\xe7\x8e\xaf\xe5\xa2\x83\n\nansible `2.2.1.0`\nos `Centos 6.7 X64`\n\n## \xe8\xa7\x92\xe8\x89\xb2\xe5\x8f\x98\xe9\x87\x8f\n\tsoftware_files_path: "/opt/software/"\n\tsoftware_install_path: "/usr/local"\n\n\tpython_version: "2.7.13"\n\n\tpython_file: "Python-{{ python_version }}.tgz"\n\tpython_file_path: "{{ software_files_path }}/{{ python_file }}"\n\tpython_file_url: "http://www.python.org/ftp/python/{{ python_version }}/Python-{{ python_version }}.tgz"\n\n\tpip_source_url: "https://pypi.tuna.tsinghua.edu.cn/simple"\n\tchange_pip_source: true\n\n\n## \xe4\xbe\x9d\xe8\xb5\x96\n\n\xe6\xb2\xa1\xe6\x9c\x89\n\n## github\xe5\x9c\xb0\xe5\x9d\x80\nhttps://github.com/lework/Ansible-roles/tree/master/python2.7\n\n## Example Playbook\n\n    - hosts: servers\n      roles:\n        - python2.7\n\t\t\n\t- hosts: server\n      roles:\n        - { role: python2.7, python_version: "2.7.13"}\n```\n\n- \xe4\xb8\x8a\xe8\xaf\x89\xe8\xaf\xb4\xe6\x98\x8e\xe4\xba\x86\xe6\xad\xa4role\xe5\x9c\xa8\xe5\x93\xaa\xe4\xb8\xaa\xe7\x8e\xaf\xe5\xa2\x83\xe4\xb8\x8b\xe6\xad\xa3\xe5\xb8\xb8\xe8\xbf\x90\xe8\xa1\x8c\xef\xbc\x8c\xe5\x85\xb6\xe4\xbb\x96\xe7\x8e\xaf\xe5\xa2\x83\xe6\x9a\x82\xe4\xb8\x8d\xe4\xbf\x9d\xe8\xaf\x81\xe8\xbf\x90\xe8\xa1\x8c\xe6\x88\x90\xe5\x8a\x9f\xe3\x80\x82\n- \xe5\x8f\xaf\xe4\xbb\xa5\xe8\x87\xaa\xe5\xae\x9a\xe4\xb9\x89\xe8\xa7\x92\xe8\x89\xb2\xe5\x8f\x98\xe9\x87\x8f\xef\xbc\x8c\xe8\xbe\xbe\xe5\x88\xb0\xe8\x87\xaa\xe5\xb7\xb1\xe6\x83\xb3\xe8\xa6\x81\xe7\x9a\x84\xe7\xbb\x93\xe6\x9e\x9c\xe3\x80\x82\xe6\xaf\x94\xe5\xa6\x82\xe6\x83\xb3\xe8\xa6\x81\xe5\xae\x89\xe8\xa3\x85python2.7.12\xe7\x9a\x84\xe7\x89\x88\xe6\x9c\xac\xef\xbc\x8c\xe5\x8f\xaf\xe4\xbb\xa5\xe5\x9c\xa8playbook\xe4\xb8\xad\xe5\xae\x9a\xe4\xb9\x89`python_version: "2.7.12"`,\xe5\xb0\xb1\xe5\x8f\xaf\xe4\xbb\xa5\xe5\xae\x89\xe8\xa3\x852.7.12\xe7\x89\x88\xe6\x9c\xac\xe7\x9a\x84python\xe4\xba\x86\xe3\x80\x82\n- \xe5\xa6\x82\xe6\x9e\x9c\xe6\x96\x87\xe7\xab\xa0\xe4\xb8\xad\xe6\x9c\x89\xe4\xbe\x9d\xe8\xb5\x96\xef\xbc\x8c\xe5\xbf\x85\xe9\xa1\xbb\xe5\x85\x88\xe5\xae\x89\xe8\xa3\x85\xe4\xbe\x9d\xe8\xb5\x96\xef\xbc\x8c\xe6\x89\x8d\xe8\x83\xbd\xe8\xbf\x90\xe8\xa1\x8c\xe6\xad\xa4role\xe3\x80\x82\n- \xe5\x9c\xa8\xe7\xbc\x96\xe5\x86\x99Playbook\xe6\x97\xb6\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe5\x8f\x82\xe8\x80\x83\xe4\xb8\x8a\xe5\x88\x97\xe7\x9a\x84Playbook\xe4\xbe\x8b\xe5\xad\x90\xe3\x80\x82\n\n## \xe7\xbc\x96\xe5\x86\x99playbook\n\n\xe8\xbf\x99\xe9\x87\x8c\xe4\xbb\xa5python2.7\xe8\xa7\x92\xe8\x89\xb2\xe4\xb8\xba\xe4\xbe\x8b\xef\xbc\x8c\xe5\xb0\x86\xe4\xb8\xbanode2\xe7\xbb\x84\xe5\x86\x85\xe7\x9a\x84\xe6\x89\x80\xe6\x9c\x89\xe4\xb8\xbb\xe6\x9c\xba\xe5\xae\x89\xe8\xa3\x85python2.7\xe6\x9c\x8d\xe5\x8a\xa1\xe3\x80\x82\n\xe6\x9f\xa5\xe7\x9c\x8b[Ansible Role\xe7\xb3\xbb\xe7\xbb\x9f\xe7\x8e\xaf\xe5\xa2\x83 \xe4\xb9\x8b\xe3\x80\x90python2.7\xe3\x80\x91](http://www.jianshu.com/p/2b38b943a177) \xe4\xbd\xbf\xe7\x94\xa8\xe5\xb8\xae\xe5\x8a\xa9\xef\xbc\x8c\xe6\xa0\xb9\xe6\x8d\xae\xe8\x87\xaa\xe8\xba\xab\xe6\x83\x85\xe5\x86\xb5\xe8\xae\xbe\xe7\xbd\xae\xe7\x9b\xb8\xe5\xba\x94\xe7\x9a\x84\xe5\x8f\x98\xe9\x87\x8f\xef\xbc\x8c\xe8\xbf\x99\xe9\x87\x8c\xe8\xae\xbe\xe7\xbd\xaepython\xe7\x9a\x84\xe7\x89\x88\xe6\x9c\xac\xe4\xb8\xba2.7.14\xe3\x80\x82\n\xe6\x96\x87\xe4\xbb\xb6\xe8\xb7\xaf\xe5\xbe\x84\xef\xbc\x9a/etc/ansible/roles/python2.7.yml\n\n```yml\n---\n\n- hosts: node2\n  \n  roles:\n    - { role: python2.7, python_version: "2.7.14"}\n```\n\n## \xe6\x89\xa7\xe8\xa1\x8cplaybook\n```bash\n[root@node ansible]# ansible-playbook python2.7.yml \n\nPLAY [node2] *******************************************************************\n\nTASK [setup] *******************************************************************\nok: [192.168.77.130]\n\nTASK [python2.7 : Copy python file to agent.] **********************************\nok: [192.168.77.130]\n\nTASK [python2.7 : Create software files .] *************************************\nok: [192.168.77.130]\n\nTASK [python2.7 : Download python file.] ***************************************\nchanged: [192.168.77.130]\n\nTASK [python2.7 : Check if python remote soft link is already configured.] *****\nok: [192.168.77.130]\n\nTASK [python2.7 : Check if python remote soft old link is already configured.] *\nok: [192.168.77.130]\n\nTASK [python2.7 : Ensure packages are installed.] ******************************\nok: [192.168.77.130] => (item=[u\'zlib\', u\'zlib-devel\', u\'openssl\', u\'openssl-devel\', u\'python-devel\', u\'gcc\'])\n\nTASK [python2.7 : Copy python file to agent.] **********************************\nchanged: [192.168.77.130]\n\nTASK [python2.7 : Build python.] ***********************************************\nchanged: [192.168.77.130]\n\nTASK [python2.7 : Move python old version and Create python dir soft link.] ****\nchanged: [192.168.77.130]\n\nTASK [python2.7 : Replace file python env path.] *******************************\nchanged: [192.168.77.130] => (item=/usr/sbin/iotop)\nchanged: [192.168.77.130] => (item=/usr/bin/yum)\n\nTASK [python2.7 : Check if pip is already configured.] *************************\nok: [192.168.77.130]\n\nTASK [python2.7 : Install python2.7 pip.] **************************************\nchanged: [192.168.77.130]\n [WARNING]: Consider using get_url or uri module rather than running curl\n\n\nTASK [python2.7 : Create pip config dir.] **************************************\nchanged: [192.168.77.130]\n\nTASK [python2.7 : Change pip source.] ******************************************\nchanged: [192.168.77.130]\n\nPLAY RECAP *********************************************************************\n192.168.77.130             : ok=15   changed=8    unreachable=0    failed=0 \n```\n## \xe6\x9f\xa5\xe7\x9c\x8b\xe4\xb8\xbb\xe6\x9c\xba\xe6\x98\xaf\xe5\x90\xa6\xe5\xae\x89\xe8\xa3\x85\xe4\xba\x86python2.7\xe7\x89\x88\xe6\x9c\xac\n\xe4\xbd\xbf\xe7\x94\xa8ad-hoc\xe6\x96\xb9\xe5\xbc\x8f\xe6\x9f\xa5\xe7\x9c\x8b\n```bash\n[root@node ansible]# ansible node2 -m shell -a \'python -V\'\n192.168.77.130 | SUCCESS | rc=0 >>\nPython 2.7.12\n```\n\xe5\x9c\xa8\xe4\xb8\xbb\xe6\x9c\xba\xe4\xb8\x8a\xe6\x9f\xa5\xe7\x9c\x8b\n```bash\n[root@node2 ~]# python -V\nPython 2.7.12\n```\n\n\xe8\x87\xb3\xe6\xad\xa4\xef\xbc\x8cansible role\xe6\x80\x8e\xe4\xb9\x88\xe4\xbd\xbf\xe7\x94\xa8\xe5\xa4\xa7\xe5\xae\xb6\xe9\x83\xbd\xe6\x98\x8e\xe7\x99\xbd\xe4\xba\x86\xe6\x8a\x8a\xe3\x80\x82\xe5\xa6\x82\xe6\x9e\x9c\xe6\x9c\x89\xe7\x96\x91\xe9\x97\xae\xe7\x9a\x84\xe8\xaf\x9d\xef\xbc\x8c\xe6\xac\xa2\xe8\xbf\x8e\xe5\xa4\xa7\xe5\xae\xb6\xe6\x9d\xa5QQ\xe7\xbe\xa4\xe3\x80\x90425931784 \xe5\xb7\xb2\xe6\xbb\xa1\xe5\x91\x98\xe3\x80\x91\xe3\x80\x90756527917\xe3\x80\x91\xe4\xba\xa4\xe6\xb5\x81\n'