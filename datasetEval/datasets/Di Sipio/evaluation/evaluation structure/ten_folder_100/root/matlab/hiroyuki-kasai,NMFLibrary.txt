b'# NMFLibrary\nMatlab library for non-negative matrix factorization (NMF)\n\nAuthors: [Hiroyuki Kasai](http://www.kasailab.com/kasai/index.html)\n\nLast page update: May 21, 2019\n\nLatest library version: 1.8.0 (see Release notes for more info)\n\n<br />\n\nIntroduction\n----------\nThe NMFLibrary is a **pure-Matlab** library of a collection of algorithms of **non-negative matrix factorization (NMF)**. \n\n<br />\n\n## <a name="supp_solver"> List of the algorithms available in NMFLibrary </a>\n\n- Base NMF\n    - **MU** (multiplicative updates)\n        - MU\n            - D.D. Lee and H. S. Seung, "[Algorithms for non-negative matrix factorization](https://papers.nips.cc/paper/1861-algorithms-for-non-negative-matrix-factorization.pdf)," NIPS 2000. (for Euclidean distance and [Kullback-Leibler divergence](https://en.wikipedia.org/wiki/Kullback-Leibler_divergence) (KL))\n            - A.Cichocki, S.Amari, R.Zdunek, R.Kompass, G.Hori, and Z.He, "[Extended SMART algorithms for non-negative matrix factorization](https://link.springer.com/chapter/10.1007/11785231_58)," Artificial Intelligence and Soft Computing, 2006. (for alpha divergence and beta divergence)\n        - Modified MU\n            - C.-J. Lin, "[On the convergence of multiplicative update algorithms for nonnegative matrix factorization](http://ieeexplore.ieee.org/document/4359171/)," IEEE Trans. Neural Netw. vol.18, no.6, pp.1589-1596, 2007. \n        - Acceralated MU\n            - N. Gillis and F. Glineur, "[Accelerated multiplicative updates and hierarchical ALS algorithms for nonnegative matrix factorization](https://arxiv.org/pdf/1107.5194.pdf)," Neural Computation, vol.24, no.4, pp. 1085-1105, 2012. \n\n    - **PGD** (projected gradient descent)\n        - PGD\n        - Direct PGD\n            - C.-J. Lin, "[Projected gradient methods for nonnegative matrix factorization](https://www.csie.ntu.edu.tw/~cjlin/papers/pgradnmf.pdf)," Neural Computation, vol.19, no.10, pp.2756-2779, 2007.\n\n    - **ALS** (alternative least squares)\n        - ALS\n        - Hierarchical ALS (HALS)\n            - A. Cichocki and P. Anh-Huy, "[Fast local algorithms for large scale nonnegative matrix and tensor factorizations](http://www.bsp.brain.riken.jp/publications/2009/Cichocki-Phan-IEICE_col.pdf)," IEICE Trans. on Fundamentals of Electronics, Communications and Computer Sciences, vol.92, no.3, pp. 708-721, 2009.\n        - Acceralated Hierarchical ALS\n            - N. Gillis and F. Glineur, "[Accelerated multiplicative updates and hierarchical ALS algorithms for nonnegative matrix factorization](https://arxiv.org/pdf/1107.5194.pdf)," Neural Computation, vol.24, no.4, pp. 1085-1105, 2012. \n\n    - **ANLS** (alternative non-negative least squares)\n        - ASGROUP (ANLS with Active Set Method and Column Grouping)\n        - ASGIVENS (ANLS with Active Set Method and Givens Updating)\n        - BPP (ANLS with Block Principal Pivoting Method)\n            - J. Kim, Y. He, and H. Park, "[Algorithms for nonnegative matrix and tensor factorizations: A unified view based on block coordinate descent framework](https://link.springer.com/article/10.1007/s10898-013-0035-4)," Journal of Global Optimization, 58(2), pp. 285-319, 2014.\n            - J. Kim and H. Park, "[Fast nonnegative matrix factorization: An active-set-like method and comparisons](http://epubs.siam.org/doi/abs/10.1137/110821172)," SIAM Journal on Scientific Computing (SISC), 33(6), pp. 3261-3281, 2011.\n\n- Variant\n\n    - **GNMF** (Graph Regularized NMF)\n        - D. Cai, X. He, X. Wu, and J. Han, "[Non-negative Matrix Factorization on Manifold](https://ieeexplore.ieee.org/document/4781101/)," Proc. 2008 Int. Conf. on Data Mining (ICDM), 2008. \n        - D. Cai, X. He, J. Han and T. Huang, "[Graph Regularized Non-negative Matrix Factorization for Data Representation](https://ieeexplore.ieee.org/document/5674058/)," IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol.33, No.8, pp.1548-1560, 2011. \n\n    - **Semi-NMF** \n        - C.H.Q. Ding, T. Li, M. I. Jordan, "[Convex and Semi-Nonnegative Matrix Factorizations](https://ieeexplore.ieee.org/document/4685898/)," IEEE Transactions on Pattern Analysis and Machine Intelligence, vol.32, no.1, 2010. \n\n    - **NeNMF** (NMF with Sinkhorn Distance)\n        - N. Guan, D. Tao, Z. Luo, and B. Yuan, "[NeNMF: An Optimal Gradient Method for Non-negative Matrix Factorization](https://ieeexplore.ieee.org/document/6166359)", IEEE Transactions on Signal Processing, Vol. 60, No. 6, pp. 2882-2898, Jun. 2012.\n\n    - **SDNMF** (NMF with Sinkhorn Distance)\n        - W. Qian, B. Hong, D. Cai, X. He, and X. Li, "[Non-negative matrix factorization with sinkhorn distance](https://pdfs.semanticscholar.org/42b2/ec6e4453dc033d37b9fcb53a1313c018fa23.pdf)", IJCAI, pp.1960-1966, 2016.\n\n\n    \n- Robust NMF\n\n    - N. Guan, D. Tao, Z. Luo, and B. Yuan, "[Online nonnegative matrix factorization with robust stochastic approximation](https://ieeexplore.ieee.org/document/6203594/)," IEEE Trans. Newral Netw. Learn. Syst., 2012.\n\n- Sparse\n\n    - **sparseMU** (Sparse multiplicative upates (MU))\n        - J. Eggert and E. Korner, "[Sparse coding and NMF](https://ieeexplore.ieee.org/document/1381036/)", IEEE International Joint Conference on Neural Networks, 2004.\n        - M. Schmidt, J. Larsen, and F. Hsiao, "[Wind noise reduction using non-negative sparse coding](https://ieeexplore.ieee.org/document/4414345/)", IEEE Workshop on Machine Learning for Signal Processing (MLSP), 2007.\n\n    - **sparseNMF** (Sparse NMF)\n\n    - **NMFsc** (NMF with sparseness constraints)\n        - Patrik O. Hoyer, "[Non-negative matrix factorization with sparseness constraints](http://www.jmlr.org/papers/volume5/hoyer04a/hoyer04a.pdf)," Journal of Machine Learning Research (JMLR), vol.5, pp.1457-1469, 2004.\n\n    - **nsNMF** (Nonsmooth NMF)\n        - A. Pascual-Montano, J. M. Carazo, K. Kochi, D. Lehmann, and R. D. Pascual-Marqui, "[Nonsmooth Nonnegative Matrix Factorization (nsNMF)](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=1580485)," IEEE Transactions on Pattern Analysis and Machine Intelligence (PAMI), vol.28, no.3, pp.403-415, 2006. \n\n    - **fnsNMF** (Fast nonsmooth NMF)\n        - Z. Yang, Y. Zhang, W. Yan, Y. Xiang, and S. Xie, "[A fast non-smooth nonnegative matrix factorization for learning sparse representation](https://ieeexplore.ieee.org/document/7559804/)," IEEE Access, vol.4, pp.5161-5168, 2016.\n\n    - **NMF-HALS-SO** (Hierarchical ALS with soft orthogonal constraint)\n        - M. Shiga, K. Tatsumi, S. Muto, K. Tsuda, Y. Yamamoto, T. Mori, and T. Tanji, "[Sparse modeling of EELS and EDX spectral imaging data by nonnegative matrix factorization](https://www.sciencedirect.com/science/article/pii/S0304399116301267)", Ultramicroscopy, Vol.170, p.43-59, 2016.\n   \n- Orthgotonal\n\n    - **DTPP** (Orthgotonal multiplicative upates (MU))\n        - C. Ding, T. Li, W. Peng, and H. Park, "Orthogonal nonnegative matrix t-factorizations for clustering", 12th ACM SIGKDD international conference on Knowledge discovery and data mining (KDD), 2006.\n\n    - **orthMU** (Orthgotonal multiplicative upates (MU))\n        - S. Choi, "[Algorithms for orthogonal nonnegative matrix factorization](https://ieeexplore.ieee.org/document/4634046/)", IEEE International Joint Conference on Neural Networks, 2008.\n\n    - **OrthNMF**\n        - F. Pompilia, N. Gillis, P.-A. Absil, and F. Glineur, "[Two algorithms for orthogonal nonnegative matrix factorization with application to clustering](https://www.sciencedirect.com/science/article/pii/S0925231214004068)," Neurocomputing, vol.141, no.2, pp.15-25, 2014.\n\n- Symmetric\n\n    - **SymmANLS** (Symmetric ANLS)\n        - D. Kuang, C. Ding, H. Park, "[Symmetric Nonnegative Matrix Factorization for Graph Clustering](https://epubs.siam.org/doi/abs/10.1137/1.9781611972825.10?mobileUi=0)," The 12th SIAM International Conference on Data Mining (SDM\'12), pp.106-117, 2012.\n\n        - D. Kuang, S. Yun, H. Park, "[SymNMF Nonnegative low-rank approximation of a similarity matrix for graph clustering](https://link.springer.com/article/10.1007/s10898-014-0247-2)," Journal of Global Optimization, vol.62, no.3, pp.545-574, 2015.\n\n        - Z. Zhu, X. Li, K. Liu, Q. Li, "[Dropping Symmetry for Fast Symmetric Nonnegative Matrix Factorization](https://papers.nips.cc/paper/7762-dropping-symmetry-for-fast-symmetric-nonnegative-matrix-factorization)," NIPS, 2018.\n\n    - **SymmHALS** (Symmetric HALS)\n        - Z. Zhu, X. Li, K. Liu, Q. Li, "Dropping Symmetry for Fast Symmetric Nonnegative Matrix Factorization," NIPS, 2018.\n\n    - **SymmNewton** (Symmetric Newton)\n\n- Online/stochstic NMF\n\n    - **INMF** (Incremental NMF) and **ONMF** (Online NMF)\n        - S. S. Bucak and B. Gunsel, "[Incremental Subspace Learning via Non-negative Matrix Factorization](https://www.sciencedirect.com/science/article/pii/S0031320308003725)," Pattern Recognition, 2009.\n\n    - **SPG** (Stochastic projected gradient descent)\n\n    - **RONMF** (Robust online NMF)\n        - R. Zhao and Y. F. Tan, "[Online nonnegative matrix factorization with outliers](https://ieeexplore.ieee.org/document/7676413/)," IEEE ICASSP2016, 2016.\n        - N. Guan, D. Tao, Z. Luo, and B. Yuan, "[Online nonnegative matrix factorization with robust stochastic approximation](https://ieeexplore.ieee.org/document/6203594/)," IEEE Trans. Newral Netw. Learn. Syst., 2012.\n\n    - **SAGA-MU-NMF** (SAGA multiplicative updates)\n        - R. Serizel, S. Essid and G.Richard, "[Mini-batch stochastic approaches for accelerated multiplicative updates in nonnegative matrix factorisation with beta-divergence](https://ieeexplore.ieee.org/document/7738818/),", IEEE 26th International Workshop on Machine Learning for Signal Processing (MLSP), 2016.\n\n    - **SMU** (Stochastic multiplicative updates) and **SVRMU** (Stochastic variance reduced multiplicative updates)\n        - H. Kasai, "[Stochastic variance reduced multiplicative update for nonnegative matrix factorization](https://arxiv.org/abs/1710.10781)," IEEE ICASSP2018, 2018.\n\n- Probabilistic NMF\n\n    - **PNMF-GIBBS** (Gibbs sampler for non-negative matrix factorisation, with ARD.)\n        - M.N. Schmidt, O. Winther, L.K. Hansen, "[Bayesian non-negative matrix factorization](https://link.springer.com/chapter/10.1007/978-3-642-00599-2_68)," International Conference on Independent Component Analysis and Signal Separation, Springer Lecture Notes in Computer Science, Vol. 5441, 2009.\n\n        - T. Brouwer, P. Lio, "[Bayesian Hybrid Matrix Factorisation for Data Integration](http://proceedings.mlr.press/v54/brouwer17a/brouwer17a.pdf)," 20th International Conference on Artificial Intelligence and Statistics (AISTATS), 2017.\n        \n    - **PNMF-VB** (Variational Bayesian inference for non-negative matrix factorisation, with ARD)\n        - T. Brouwer, J. Frellsen. P. Lio, "[Comparative Study of Inference Methods for Bayesian Nonnegative Matrix Factorisation](https://link.springer.com/chapter/10.1007/978-3-319-71249-9_31)," ECML PKDD 2017, 2017.\n\n\n<br />\n\n## Algorithm configurations\n\n\n|Category|Name in example codes| function | `options.alg` | other `options` |\n|---|---|---|---|---|\n|Base|MU-EUC|`nmf_mu`|`mu`|`metric=\'EUC\'`|\n||MU-KL|`nmf_mu`|`mu`|`metric=\'KL\'`|\n||MU-ALPHA|`nmf_mu`|`mu`|`metric=\'ALPHA-D\'`|\n||MU-BETA|`nmf_mu`|`mu`|`metric=\'BETA-D\'`|\n||Modified MU|`nmf_mu`|`mod_mu`||\n||Acceralated MU|`nmf_mu`|`acc_mu`||\n||PGD|`nmf_pgd`|`pgd`||\n||Direct PGD|`nmf_pgd`|`direct_pgd`||\n||ALS|`nmf_als`|`als`||\n||Hierarchical ALS|`nmf_als`|`hals_mu`||\n||Acceralated hierarchical ALS|`nmf_als`|`acc_hals_mu`||\n||ASGROUP|`nmf_anls`|`anls_asgroup`||\n||ASGIVENS|`nmf_anls`|`anls_asgivens`||\n||BPP|`nmf_anls`|`anls_bpp`||\n|Variant|Semi-NMF|`semi_nmf`|||\n||NeNMF|`nenmf`|||\n||GNMF|`GNMF`|||\n||SDNMF|`SDNMF`|||\n|Sparse|sparseMU-EUC|`nmf_sparse_mu`||`metric=\'EUC\'`|\n||sparseMU-KL|`nmf_sparse_mu`||`metric=\'KL\'`|\n||sparseNMF|`sparse_nmf`|||\n||NMFsc|`nmf_sc`|||\n||nsNMF|`ns_nmf`|||\n||fnsNMF|`ns_nmf`||`metric=\'EUC\'`, `update_alg=\'apg\'`|\n|Orthogonal|DTPP|`nmf_dtpp`|||\n||orthMU|`nmf_orth_mu`|||\n||OrthNMF||||\n||NMF-HALS-SO||||\n|Symmetric|SymmANLS|`symm_anls`|||\n||SymmHALS|`symm_halsacc`|||\n||SymmNewton|`symm_newton`|||\n|Online|INMF|`inmf`|||\n||ONMF|`onmf`|||\n||Acceralated ONMF|`omf_acc`|||\n||SPG|`spg_nmf`|||\n||RONMF|`ronmf`|||\n||SAGA-MU-NMF|`asag_mu_nmf`|||\n||SMU|`smu_nmf`|||\n||SVRMU|`svrmu_nmf`|||\n|Probabilistic|PNMF-VB|`pnmf_vb`|||\n||PNMF-GIBBS|`pnmf_gibbs`|||\n\n\n<br />\n\nFolders and files\n---------\n<pre>\n./                      - Top directory.\n./README.md             - This readme file.\n./run_me_first.m        - The scipt that you need to run first.\n./demo.m                - Demonstration script to check and understand this package easily. \n./demo_face.m           - Demonstration script to check and understand this package easily. \n|plotter/               - Contains plotting tools to show convergence results and various plots.\n|auxiliary/             - Some auxiliary tools for this project.\n|solver/                - Contains various optimization algorithms.\n    |--- base/          - Basic NMF solvers.\n    |--- online/        - Online/stochstic NMF solvers.\n    |--- sparse/        - Sparse NMF solvers.\n    |--- robust/        - Robust NMF solvers.\n    |--- orthogonal/    - Orthogonal NMF solvers.\n    |--- symm/          - Symmetric NMF solvers.\n    |--- nenmf/         - Nesterov\'s accelerated NMF solver.\n    |--- probabilistic/ - Probabilistic NMF solvers.\n    |--- 3rd_party/     - Solvers provided by 3rd_party.\n</pre>\n\n<br />                              \n\nFirst to do\n----------------------------\nRun `run_me_first` for path configurations. \n```Matlab\n%% First run the setup script\nrun_me_first; \n```\n\n<br />\n\nSimplest usage example: 4 steps!\n----------------------------\n\nJust execute `demo` for the simplest demonstration of this package. .\n\n```Matlab\n%% Execute the demonstration script\ndemo; \n```\n\nThe "**demo.m**" file contains below.\n```Matlab\n%% generate synthetic data non-negative matrix V size of (mxn)\nm = 500;\nn = 100;\nV = rand(m,n);\n    \n%% Initialize rank to be factorized\nrank = 5;\n\n%% perform factroization\n% MU\noptions.alg = \'mu\';\n[w_nmf_mu, infos_nmf_mu] = nmf_mu(V, rank, options);\n% Hierarchical ALS\noptions.alg = \'hals\';\n[w_nmf_hals, infos_nmf_hals] = nmf_als(V, rank, options);        \n    \n%% plot\ndisplay_graph(\'epoch\',\'cost\', {\'MU\', \'HALS\'}, {w_nmf_mu, w_nmf_hals}, {infos_nmf_mu, infos_nmf_hals});\n\n```\n\n<br />\n\nLet\'s take a closer look at the code above bit by bit. The procedure has only **4 steps**!\n<br />\n\n**Step 1: Generate data**\n\nFirst, we generate  synthetic data of V of size (mxn).\n```Matlab    \nm = 500;\nn = 100;\nV = rand(m,n);\n```\n\n**Step 2: Define rank**\n\nWe set the rank value.\n```Matlab\nrank = 5;\n```\n\n**Step 3: Perform solver**\n\nNow, you can perform optimization solvers, e.g., MU and Hierarchical ALS (HALS), calling [solver functions](#supp_solver), i.e., `nmf_mu()` function and `nmf_als()` function after setting some optimization options. \n```Matlab\n% MU\noptions.alg = \'mu\';\n[w_nmf_mu, infos_nmf_mu] = nmf_mu(V, rank, options);\n% Hierarchical ALS\noptions.alg = \'hals\';\n[w_nmf_hals, infos_nmf_hals] = nmf_als(V, rank, options); \n```\nThey return the final solutions of `w` and the statistics information that include the histories of epoch numbers, cost values, norms of gradient, the number of gradient evaluations and so on.\n\n**Step 4: Show result**\n\nFinally, `display_graph()` provides output results of decreasing behavior of the cost values in terms of the number of iterrations (epochs) and time [sec]. \n```Matlab\ndisplay_graph(\'epoch\',\'cost\', {\'MU\', \'HALS\'}, {w_nmf_mu, w_nmf_hals}, {infos_nmf_mu, infos_nmf_hals});\ndisplay_graph(\'time\',\'cost\', {\'MU\', \'HALS\'}, {w_nmf_mu, w_nmf_hals}, {infos_nmf_mu, infos_nmf_hals});\n```\n\nThat\'s it!\n\n\n<img src="http://www.kasailab.com/public/github/NMFLibrary/images/cost.png" width="600">\n\n<br />\n\nMore plots\n----------------------------\n\n"**demo_face.m**" illustrates the learned basis (dictrionary) in case of [CBCL face datasets](http://cbcl.mit.edu/software-datasets/FaceData2.html).\n\nThe dataset is first loaded into V instead of generating synthetic data in **Step 1**.\n\n```Matlab\nV = importdata(\'./data/CBCL_face.mat\');\n```\n\nThen, we can display basis elements (W: dictionary) obtained with different algorithms additionally in **Step 4**.\n\n```Matlab\nplot_dictionnary(w_nmf_mu.W, [], [7 7]); \nplot_dictionnary(w_nmf_hals.W, [], [7 7]); \n```\n\n<img src="http://www.kasailab.com/public/github/NMFLibrary/images/face_dictionary.png" width="600">\n\n\n<br />\n\nLicense\n-------\n- The NMFLibrary is **free**, **non-commercial** and **open** source.\n- The code provided iin NMFLibrary should only be used for **academic/research purposes**.\n- Third party files are included.\n    - For ANLS algorithms: `nnlsm_activeset.m`, `nnls1_asgivens.m`, `nnlsm_blockpivot.m`, and `normalEqComb.m` written by Jingu Kim.\n    - For PGD algorithm: `nlssubprob.m`.\n    - For GNMF algorithm: `GNMF.m`, `GNMF_Multi.m`, `constructW.m` and `litekmeans.m` writtnen by Deng Cai.\n    - For SDNMF algorithm: `SDNMF.m`, and `SDNMF_Multi.m` writtnen by Wei Qian.\n    - For symmetric algorithms writtnen by D.Kang et al. and Z. Zhu et al.\n    - For acceleration sub-routines in [`nmf_mu.m`](https://github.com/hiroyuki-kasai/NMFLibrary/blob/master/solver/base/nmf_mu.m) and [`nmf_als.m`](https://github.com/hiroyuki-kasai/NMFLibrary/blob/master/solver/base/nmf_als.m) for MU and HALS from [Nicolas Gillis](https://sites.google.com/site/nicolasgillis/publications).\n    - For dictionaly visualization: `plot_dictionnary.m`, `rescale.m`, and `getoptions.m`.\n\n\n<br />\n\nProblems or questions\n---------------------\nIf you have any problems or questions, please contact the author: [Hiroyuki Kasai](http://kasai.kasailab.com/) (email: kasai **at** is **dot** uec **dot** ac **dot** jp)\n\n<br />\n\nRelease notes\n--------------\n* Version 1.7.0 (June 27, 2019) \n    - Symmetic solvers are added.\n    - Clustering quality measurements are integrated into store_nmf_infos.m. \n* Version 1.7.0 (May 21, 2019) \n    - PNMF-VB and NeNMF are added.\n    - Fixed some bugs. \n* Version 1.6.0 (May 16, 2019) \n    - DTPP is added.\n* Version 1.5.1 (Apr. 22, 2019) \n    - Some solvers are modified to fix bugs.\n* Version 1.5.0 (Jul. 30, 2018)\n    - fnsNMF and NMF-HALS-SO are added.\n* Version 1.4.0 (Jul. 24, 2018)\n    - sparseMU and orthMU are added.\n    - MU with Kullback-Leibler divergence (KL), Amari alpha divergence, and beta divergenceare added.\n* Version 1.3.0 (Jul. 23, 2018)\n    - NMFsc, scNMF and csNMF are added.\n* Version 1.2.0 (Jul. 21, 2018)\n    - GNMF, Semi-NMF and SDNMF are added.\n* Version 1.1.0 (Apr. 17, 2018)\n    - Online/stochastic solvers are added.\n* Version 1.0.0 (Apr. 04, 2017)\n    - Initial version.\n\n'