b'[![Build Status](https://travis-ci.org/okbob/pspg.svg?branch=master)](https://travis-ci.org/okbob/pspg)\n\n# pspg - Postgres Pager\nEverybody who uses `psql` uses `less` pager. It is working well, but there is not any special\nsupport for tabular data. I found few projects, but no one was completed for this purpose.\nI decided to write some small specialized pager for usage as `psql` pager.\n\nThis pager can be used from `mysql` and `pgcli` clients too.\n\n## Main target\n* possibility to freeze first few rows, first few columns\n* possibility to sort data by specified numeric column\n* possibility to use fancy colors - like `mcview` or `FoxPro`\n\n\n## Screenshots\n![Screenshot](screenshots/pspg-modern.png)\n![Screenshot](screenshots/vc-mc.png)\n![Screenshot](screenshots/vc-tao.png)\n![Screenshot](screenshots/theme1.gif)\n\n![Screenshot](screenshots/theme3.gif)\n\n\n## Options\n* `-a`       menu will use ascii borders\n* `-b`       black/white theme\n* `-X`       doesn\'t clean screen on the end\n* `-s N`     use theme (default theme is mc theme)\n* `-c N`     freeze first N columns\n* `-f file`  open file (default stdin)\n* `--force-uniborder`  replace ascii border by unicode borders\n* `-g --hilite-search`  don\'t highlight lines for searches\n* `-G --HILITE-SEARCH`  don\'t highlight lines for searches ever\n* `--help`   show this help\n* `-i --ignore-case`  ignore case in searches that do not contain uppercase\n* `-I --IGNORE-CASE`  ignore case in all searches\n* `--less-status-bar`  status bar like less pager\n* `--line-numbers`  show line number column\n* `--no-mouse`  without own mouse handling (cannot be changed in app)\n* `--no-sound`  without sound effect\n* `-F`, `--quit-if-one-screen`  quit if content is one screen\n* `-V`, `--version`  show version\n* `--about`  show info about authors\n* `--csv`  input format is csv\n* `--tsv`  input format is tsv\n* `--double-header`  header line is doubled\n* `--border`  border used for formatted csv\n* `--csv-separator`  special char used as separator inside csv documents\n* `--ni`  not interactive mode (format csv to table and quit)\n* `--no-cursor`  the line cursor will be hidden\n* `--no-commandbar`  the bottom bar will be hidden\n* `--no-topbar`  the top bar will be hidden\n* `--no-bars`  both bars will be hidden\n* `--no-sigint-search-reset`  sigint is not used to reset searching\n* `--tabular-cursor`  cursor is displayed only for table\n* `--only-for-tables`  use std pager when content is not a table\n* `--bold-labels`  bold font for row, column labels\n* `--bold-cursor`  bold font for cursor\n* `--vertical-cursor`  show column cursor\n* `--on-sigint-exit`  double escape or ctrl c ending pager\n* `-q`, `--query`  execute query\n* `-w`, `--watch n`  repeat query execution every time sec\n* `-d`, `--dbname`  database name\n* `-h`, `--host`  database host name\n* `-p`, `--port`  databae port\n* `-U`, `--username`  database user name\n* `-W`, `--password`  force password prompt\n\n\n## Themes\n0. black & white\n1. Midnight Commander like\n2. FoxPro like\n3. Pdmenu like\n4. White theme\n5. Mutt like\n6. PCFand like\n7. Green theme\n8. Blue theme\n9. Word Perfect like\n10. Low contrast blue theme\n11. Dark cyan/black mode\n12. Paradox like\n13. dBase IV retro style\n14. dBase IV retro style (Magenta labels)\n15. Red white theme\n16. Simple theme\n17. Solarized dark theme \n18. Solarized light theme\n19. Gruvbox light theme\n20. Tao Light theme\n\nsee http://okbob.blogspot.cz/2017/07/i-hope-so-every-who-uses-psql-uses-less.html\n\n\n## Keyboard commands\n* <kbd>0</kbd>, <kbd>1</kbd>, <kbd>2</kbd>, <kbd>3</kbd>, .., <kbd>9</kbd> - freeze first N columns\n* <kbd>KEY_UP</kbd>, <kbd>k</kbd> - navigate backward by one line\n* <kbd>KEY_DOWN</kbd>, <kbd>j</kbd> - navigate forward by one line\n* <kbd>KEY_LEFT</kbd>, <kbd>h</kbd> - scroll to left\n* <kbd>KEY_RIGHT</kbd>, <kbd>l</kbd> - scroll to right\n* <kbd>Ctrl</kbd>+<kbd>Home</kbd>, <kbd>g</kbd> - go to the start of file\n* <kbd>Ctrl</kbd>+<kbd>End</kbd>, <kbd>G</kbd> - go to the end of file\n* <kbd>Alt</kbd>+<kbd>l</kbd> - go to line number\n* <kbd>H</kbd> - go to first line of current window\n* <kbd>M</kbd> - go to half of current window\n* <kbd>L</kbd> - go to end of current window\n* <kbd>PPAGE</kbd>, <kbd>Ctrl</kbd>+<kbd>b</kbd> - backward one window\n* <kbd>NPAGE</kbd>, <kbd>Ctrl</kbd>+<kbd>f</kbd>, <kbd>space</kbd> - forward one window\n* <kbd>HOME</kbd>, <kbd>^</kbd> - go to begin of line, first column\n* <kbd>END</kbd>, <kbd>$</kbd> - go to end of line, last column\n* <kbd>Ctrl</kbd>+<kbd>e</kbd> - scroll a window down\n* <kbd>Ctrl</kbd>+<kbd>y</kbd> - scroll a window up\n* <kbd>Ctrl</kbd>+<kbd>d</kbd> - forward a half window\n* <kbd>Ctrl</kbd>+<kbd>u</kbd> - backward a half window\n* <kbd>s</kbd> - save content to file\n* <kbd>/</kbd> - search for a pattern which will take you to the next occurrence\n* <kbd>?</kbd> - search for a pattern which will take you to the previous occurrence\n* <kbd>n</kbd> - for next match\n* <kbd>N</kbd> - for next match in reverse direction\n* <kbd>c</kbd> - column search\n* <kbd>Alt</kbd>+<kbd>c</kbd> - switch (on, off) drawing line cursor\n* <kbd>Alt</kbd>+<kbd>m</kbd> - switch (on, off) own mouse handler\n* <kbd>Alt</kbd>+<kbd>n</kbd> - switch (on, off) drawing line numbers\n* <kbd>Alt</kbd>+<kbd>v</kbd>, <kbd>double click</kbd> on column header - switch (on, off) drawing column cursor\n* Mouse button wheel - scroll vertical\n* <kbd>Alt</kbd>+<kbd>Mouse button wheel</kbd> - scroll horizontal\n* <kbd>F9</kbd> - show menu\n* <kbd>q</kbd>, <kbd>F10</kbd>, <kbd>Esc</kbd> <kbd>0</kbd> - quit\n* <kbd>Alt</kbd>+<kbd>q</kbd> - quit wit raw (unformatted) output\n* <kbd>Alt</kbd>+<kbd>k</kbd>, <kbd>Alt</kbd>+<kbd>double click</kbd> - switch bookmark\n* <kbd>Alt</kbd>+<kbd>j</kbd> - go to next bookmark\n* <kbd>Alt</kbd>+<kbd>i</kbd> - go to previous bookmark\n* <kbd>Alt</kbd>+<kbd>o</kbd> - flush bookmarks\n* <kbd>a</kbd> - sort ascendent\n* <kbd>d</kbd> - sort descendent\n* <kbd>u</kbd> - unsorted (sorted in origin order)\n* <kbd>space</kbd> - stop/continue in watch mode\n\n## Ending\n\nThe pager can be ended by pressing keys <kbd>q</kbd> or <kbd>F10</kbd> or <kbd>Esc</kbd> <kbd>0</kbd>.\nWith option `--on-sigint-exit` then the pager is closed by pressing keys <kbd>Ctrl</kbd>+<kbd>c</kbd>\nor <kbd>Esc</kbd> <kbd>Esc</kbd>.\n\n## Column search\n\nColumn search is case insensitive every time. Searched column is marked by vertical cursor.\nLast non empty string searching pattern is used when current searching pattern is empty string.\nSearching is starting after visible vertical column or on first visible not freezed columns (after\nsome horizontal scrolling) or on first column. After last column searching starts from first again.\n\n## Status line description\n* `V: [d/d d..d]` - vertical cursor: (column number)/(columns) (char possitions from) .. (char possitions to)\n* `FC: d` - freezed columns length in chars\n* `C: d..d/d` - unfreezed visible data in chars (from .. to)/(total)\n* `L:[d + d  d/d]` - lines (number of first visible line) + (number of line of display), (current line)/(lines)\n* `d%` - percent of already displayed data\n\n# Usage as csv viewer\n\nIt works well with miller http://johnkerl.org/miller/doc/index.html\n<pre>\nmlr --icsv --opprint --barred put \'\' obce.csv | pspg --force-uniborder\n</pre>\n\nNew version has integrated csv support - just use `--csv` option.\n\nIt can be integrated into <code>mc</code>\n\n* copy file from `/etc/mc/mc.ext` to your `~/.config/mc directory`\n* insert there\n\n<pre>\n#csv\nregex/\\.csv\n    View=mlr --icsv --opprint --barred put \'\' %f | pspg --force-uniborder\n</pre>\n\n* restart <code>mc</code>\n\n# Usage in watch mode\n\nThe result of query can be refreshed every n seconds. `pspg` remembers cursor row,\npossible vertical cursor, possible ordering. The refreshing should be paused by pressing\n<kbd>space</kbd> key. Repeated pressing of this key enables refreshing again.\n\n# Recommended psql configuration\n<pre>\n\\pset linestyle unicode\n\\pset border 2\n</pre>\n\nsome possible configuration:\n<pre>\n-- Switch pagers with :x and :xx commands\n\\set x \'\\\\setenv PAGER less\'\n\\set xx \'\\\\setenv PAGER \\\'pspg -bX --no-mouse\\\'\'\n:xx\n</pre>\n\n## Attention\n\nWhen you use a option `--only-for-tables`, then\n\n* set `PAGER` to `pspg` and `PSPG_PAGER` to `less` or\n* set `PAGER` to `less` and `PSQL_PAGER` to `pspg`\n\n# MySQL usage\n<pre>\nMariaDB [sakila]> pager pspg -s 14 -X --force-uniborder --quit-if-one-screen\nPAGER set to \'pspg -s 14 -X --force-uniborder --quit-if-one-screen\'\nMariaDB [sakila]> select now();\nMariaDB [sakila]> select * from nicer_but_slower_film_list limit 100;\n</pre>\n\n`LC_CTYPE` should be correct.\n\n# SQLite\n\nSQLite native client doesn\'t produce well formatted output, but can be forced\nto generate CSV format - and this format is well readable for `pspg`\n\n    sqlite3 -csv -header testdb.db \'select * from foo2\' | pspg --csv --csv-header=on --double-header\n\n# Note - compilation issue\nSome linker issues can be fixed by:\n<pre>\nI changed \ngcc -lncursesw pager.c -o pspg -ggdb\nto\ngcc pager.c -o pspg -ggdb -lncursesw\n</pre>\n\nOn some old systems a compilation fails with error\n<pre>\n/home/user/Src/pspg-0.6/src/pspg.c:2403: undefined reference to `set_escdelay`\n</pre>\nIn this case comment line with function set_escdelay\n\n# Note - Installation\nWhen you compile code from source, run ./configure first. Sometimes ./autogen.sh first\n\nIf you would to display UTF-8 characters, then `pspg` should be linked with `ncursesw`\nlibrary. UTF-8 characters are displayed badly when library `ncursesw` is used. You can\nsee broken characters with incorrect locale setting too.\n\nYou can check wide chars support by `pspg --version`. Row `ncurses with wide char support`\nis expected. Re-run `configure` with `--with-ncursesw` option. When this command fails check\nif development package for ncuresesw library is installed.\n\n## Homebrew (for Linux & MacOS)\n\n    # brew install pspg\n\n## Debian\n\n    # apt-cache search pspg\n    # apt-get install pspg\n\n## Fedora (28 and later)\n\n    # dnf install pspg\n    \n## RPM (CentOS/openSUSE/\xe2\x80\xa6)\nThe pspg is available from community repository https://yum.postgresql.org/packages.php\n\n## Alpine Linux\n\n    # apk add pspg\n\n## Gentoo\n\n    # emerge -av dev-db/pspg\n\n## Arch Linux\n\nThe Arch User Repository contains two versions:\n\n* [pspg](https://aur.archlinux.org/packages/pspg/) is a fixed release.\n* [pspg-git](https://aur.archlinux.org/packages/pspg-git/) tracks the `master` branch.\n\nUse the AUR helper of your choice or git and `makepkg` to install pspg.\n\n## FreeBSD\n\n    # pkg install pspg\n\n\n## Using MacPorts (MacOS only)\n\n    # port install pspg\n\n\n## Solaris\n\nThere are few issues requires manual code changes for successful compilation - we successfully\ntested `pspg`, but although `pspg` was linked with ncursesw libraries, the utf8 encoding support\ndidn\'t work fully correctly - probably due some issues in `libc` library. There are problems with\nchars encoded to 3bytes - unicode borders, .. Two bytes unicode chars should be displayed well.\n\nYou can use `pspg` with usual accented chars, but unicode bordes should not be used. Replacement\nascii borders by special borders chars (by ncurses technology) works well - looks on `Options|Force unicode borders`\noption.\n\n* Solaris `make` doesn\'t support conditional statements - should be removed So, remove unsupported\n  functionality from `Makefile` (`ifdef`,`endif`), replace `-include` by `include` first.\n\n* After running `configure` remove link on `termcap` library from `config.make`. It is garabage\n  produced by `readline` automake script. Combination with `ncurses` libraries makes some\n  linking issues.\n\n### builtin libraries\n\n    export CURSES_CFLAGS="-I/usr/include/ncurses/"\n    export PANEL_LIBS="-lpanelw"\n    ./configure\n\n### OpenCSW development\n\n    export CFLAGS="-m64 -I/opt/csw/include"\n    export LDFLAGS="-L/opt/csw/lib/64 -R/opt/csw/lib/64"\n    export PKG_CONFIG_PATH="/opt/csw/lib/64/pkgconfig"\n    ./configure\n\n# Possible ToDo\n\n* Store data in some column format (now data are stored like array of rows). With this change can\n  be possible to operate over columns - hide columns, change width, cyclic iteration over columns,\n  change order of columns, mark columns and export only selected columns (selected rows).\n\n# st_menu\n\nThis project uses st_menu library - implementation of CUA menubar and pulldown menu for ncurses\nhttps://github.com/okbob/ncurses-st-menu\n\n# Note\n\nIf you like it, send a postcard from your home country to my address, please:\n\n    Pavel Stehule\n    Skalice 12\n    256 01 Benesov u Prahy\n    Czech Republic\n\n\nI invite any questions, comments, bug reports, patches on mail address pavel.stehule@gmail.com\n'