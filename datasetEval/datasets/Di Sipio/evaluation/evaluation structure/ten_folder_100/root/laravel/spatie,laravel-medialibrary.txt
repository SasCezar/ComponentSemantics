b'# Associate files with Eloquent models\n\n[![Latest Version](https://img.shields.io/github/release/spatie/laravel-medialibrary.svg?style=flat-square)](https://github.com/spatie/laravel-medialibrary/releases)\n[![Build Status](https://img.shields.io/travis/spatie/laravel-medialibrary/master.svg?style=flat-square)](https://travis-ci.org/spatie/laravel-medialibrary)\n[![Quality Score](https://img.shields.io/scrutinizer/g/spatie/laravel-medialibrary.svg?style=flat-square)](https://scrutinizer-ci.com/g/spatie/laravel-medialibrary)\n[![StyleCI](https://styleci.io/repos/33916850/shield)](https://styleci.io/repos/33916850)\n[![Total Downloads](https://img.shields.io/packagist/dt/spatie/laravel-medialibrary.svg?style=flat-square)](https://packagist.org/packages/spatie/laravel-medialibrary)\n\nThis package can associate all sorts of files with Eloquent models. It provides a\nsimple API to work with. To learn all about it, head over to [the extensive documentation](https://docs.spatie.be/laravel-medialibrary/).\n\nHere are a few short examples of what you can do:\n\n```php\n$newsItem = News::find(1);\n$newsItem->addMedia($pathToFile)->toMediaCollection(\'images\');\n```\n\nIt can handle your uploads directly:\n\n```php\n$newsItem->addMedia($request->file(\'image\'))->toMediaCollection(\'images\');\n```\n\nWant to store some large files on another filesystem? No problem:\n\n```php\n$newsItem->addMedia($smallFile)->toMediaCollection(\'downloads\', \'local\');\n$newsItem->addMedia($bigFile)->toMediaCollection(\'downloads\', \'s3\');\n```\n\nThe storage of the files is handled by [Laravel\'s Filesystem](https://laravel.com/docs/5.6/filesystem),\nso you can use any filesystem you like. Additionally the package can create image manipulations\non images and pdfs that have been added in the medialibrary.\n\nSpatie is a webdesign agency in Antwerp, Belgium. You\'ll find an overview of all our open source projects [on our website](https://spatie.be/opensource).\n\n## Using an older version of Laravel?\n\nThis version of the medialibrary is compatible with Laravel 5.5 and newer.\n\nIf you use an older version of Laravel you can use an older version of the package. These aren\'t maintained anymore, but they should be pretty stable. We still accept small bugfixes.\n\n\n- [Medialibrary v6 for Laravel 5.5 / PHP 7.0](https://docs.spatie.be/laravel-medialibrary/v6)\n- [Medialibrary v5 for Laravel 5.4](https://docs.spatie.be/laravel-medialibrary/v5)\n- [Medialibray v4 for Laravel 5.1 - 5.3](https://docs.spatie.be/laravel-medialibrary/v4)\n\n## Documentation\n\nYou\'ll find the documentation on [https://docs.spatie.be/laravel-medialibrary/v7](https://docs.spatie.be/laravel-medialibrary/v7).\n\nFind yourself stuck using the package? Found a bug? Do you have general questions or suggestions for improving the media library? Feel free to [create an issue on GitHub](https://github.com/spatie/laravel-medialibrary/issues), we\'ll try to address it as soon as possible.\n\nIf you\'ve found a bug regarding security please mail [freek@spatie.be](mailto:freek@spatie.be) instead of using the issue tracker.\n\n## Requirements\n\n- [Imagick](http://php.net/manual/en/imagick.setresolution.php)\n\n## Installation\n\nYou can install this package via composer using this command:\n\n```bash\ncomposer require "spatie/laravel-medialibrary:^7.0.0"\n```\n\nThe package will automatically register itself.\n\nYou can publish the migration with:\n\n```bash\nphp artisan vendor:publish --provider="Spatie\\MediaLibrary\\MediaLibraryServiceProvider" --tag="migrations"\n```\n\nAfter the migration has been published you can create the media-table by running the migrations:\n\n```bash\nphp artisan migrate\n```\n\nYou can publish the config-file with:\n\n```bash\nphp artisan vendor:publish --provider="Spatie\\MediaLibrary\\MediaLibraryServiceProvider" --tag="config"\n```\n\nThis is the contents of the published config file:\n\n```php\nreturn [\n\n    /*\n     * The filesystems on which to store added files and derived images by default. Choose\n     * one or more of the filesystems you\'ve configured in config/filesystems.php.\n     */\n    \'disk_name\' => \'public\',\n\n    /*\n     * The maximum file size of an item in bytes.\n     * Adding a larger file will result in an exception.\n     */\n    \'max_file_size\' => 1024 * 1024 * 10,\n\n    /*\n     * This queue will be used to generate derived images.\n     * Leave empty to use the default queue.\n     */\n    \'queue_name\' => \'\',\n\n    /*\n     * The class name of the media model that should be used.\n     */\n    \'media_model\' => Spatie\\MediaLibrary\\Models\\Media::class,\n\n    /*\n     * The engine that should perform the image conversions.\n     * Should be either `gd` or `imagick`.\n     */\n    \'image_driver\' => \'gd\',\n\n    /*\n     * When urls to files get generated, this class will be called. Leave empty\n     * if your files are stored locally above the site root or on s3.\n     */\n    \'url_generator\' => null,\n\n    /*\n     * The class that contains the strategy for determining a media file\'s path.\n     */\n    \'path_generator\' => null,\n\n    \'s3\' => [\n        /*\n         * The domain that should be prepended when generating urls.\n         */\n        \'domain\' => \'https://xxxxxxx.s3.amazonaws.com\',\n    ],\n\n    \'remote\' => [\n        /*\n         * Any extra headers that should be included when uploading media to\n         * a remote disk. Even though supported headers may vary between\n         * different drivers, a sensible default has been provided.\n         *\n         * Supported by S3: CacheControl, Expires, StorageClass,\n         * ServerSideEncryption, Metadata, ACL, ContentEncoding\n         */\n        \'extra_headers\' => [\n            \'CacheControl\' => \'max-age=604800\',\n        ],\n    ],\n\n    /*\n     * These generators will be used to create an image of media files.\n     */\n    \'image_generators\' => [\n        Spatie\\MediaLibrary\\ImageGenerators\\FileTypes\\Image::class,\n        Spatie\\MediaLibrary\\ImageGenerators\\FileTypes\\Webp::class,\n        Spatie\\MediaLibrary\\ImageGenerators\\FileTypes\\Pdf::class,\n        Spatie\\MediaLibrary\\ImageGenerators\\FileTypes\\Svg::class,\n        Spatie\\MediaLibrary\\ImageGenerators\\FileTypes\\Video::class,\n    ],\n\n    /*\n     * Medialibrary will try to optimize all converted images by removing\n     * metadata and applying a little bit of compression. These are\n     * the optimizers that will be used by default.\n     */\n    \'image_optimizers\' => [\n        Spatie\\ImageOptimizer\\Optimizers\\Jpegoptim::class => [\n            \'--strip-all\', // this strips out all text information such as comments and EXIF data\n            \'--all-progressive\', // this will make sure the resulting image is a progressive one\n        ],\n        Spatie\\ImageOptimizer\\Optimizers\\Pngquant::class => [\n            \'--force\', // required parameter for this package\n        ],\n        Spatie\\ImageOptimizer\\Optimizers\\Optipng::class => [\n            \'-i0\', // this will result in a non-interlaced, progressive scanned image\n            \'-o2\', // this set the optimization level to two (multiple IDAT compression trials)\n            \'-quiet\', // required parameter for this package\n        ],\n        Spatie\\ImageOptimizer\\Optimizers\\Svgo::class => [\n            \'--disable=cleanupIDs\', // disabling because it is known to cause troubles\n        ],\n        Spatie\\ImageOptimizer\\Optimizers\\Gifsicle::class => [\n            \'-b\', // required parameter for this package\n            \'-O3\', // this produces the slowest but best results\n        ],\n    ],\n\n    /*\n     * The path where to store temporary files while performing image conversions.\n     * If set to null, storage_path(\'medialibrary/temp\') will be used.\n     */\n    \'temporary_directory_path\' => null,\n\n    /*\n     * FFMPEG & FFProbe binaries path, only used if you try to generate video\n     * thumbnails and have installed the php-ffmpeg/php-ffmpeg composer\n     * dependency.\n     */\n    \'ffmpeg_binaries\' => \'/usr/bin/ffmpeg\',\n    \'ffprobe_binaries\' => \'/usr/bin/ffprobe\',\n];\n```\n\nBy default medialibrary will store it\'s files on Laravel\'s `public` disk. If you want a dedicated disk you should add a disk to `app/config/filesystems.php`. This would be a typical configuration:\n\n```php\n    ...\n    \'disks\' => [\n        ...\n\n        \'media\' => [\n            \'driver\' => \'local\',\n            \'root\'   => public_path().\'/media\',\n            \'url\' => env(\'APP_URL\') . \'/media\',\n            \'visibility\' => \'public\',\n        ],\n    ...\n```\n\nAll files of the medialibrary will be stored on that disk. If you are planning on\nworking with the image manipulations you should configure a queue on your service\nwith the name specified in the config file.\n\n## Lumen Support\n\nLumen configuration is slightly more involved but features and API are identical to Laravel.\n\nInstall using this command:\n\n```bash\ncomposer require spatie/laravel-medialibrary\n```\n\nUncomment the following lines in the bootstrap file:\n\n```php\n// bootstrap/app.php:\n$app->withFacades();\n$app->withEloquent();\n```\n\nConfigure the laravel-medialibrary service provider (and `AppServiceProvider` if not already enabled):\n\n```php\n// bootstrap/app.php:\n$app->register(App\\Providers\\AppServiceProvider::class);\n$app->register(Spatie\\MediaLibrary\\MediaLibraryServiceProvider::class);\n```\n\nUpdate the `AppServiceProvider` register method to bind the filesystem manager to the IOC container:\n\n```php\n// app/Providers/AppServiceProvider.php\npublic function register()\n{\n    $this->app->singleton(\'filesystem\', function ($app) {\n        return $app->loadComponent(\'filesystems\', \'Illuminate\\Filesystem\\FilesystemServiceProvider\', \'filesystem\');\n    });\n\n    $this->app->bind(\'Illuminate\\Contracts\\Filesystem\\Factory\', function($app) {\n        return new \\Illuminate\\Filesystem\\FilesystemManager($app);\n    });\n}\n```\n\nManually copy the package config file to `app\\config\\laravel-medialibrary.php` (you may need to\ncreate the config directory if it does not already exist).\n\nCopy the [Laravel filesystem config file](https://github.com/laravel/laravel/blob/v6.4.15/config/filesystems.php) into `app\\config\\filesystem.php`. You should add a disk configuration to the filesystem config matching the `default_filesystem` specified in the laravel-medialibrary config file.\n\nFinally, update `boostrap/app.php` to load both config files:\n\n```php\n// bootstrap/app.php\n$app->configure(\'medialibrary\');\n$app->configure(\'filesystems\');\n```\n\n## Testing\n\nYou can run the tests with:\n\n```bash\nvendor/bin/phpunit\n```\n\n## Upgrading\n\nPlease see [UPGRADING](UPGRADING.md) for details.\n\n### Changelog\n\nPlease see [CHANGELOG](CHANGELOG.md) for more information what has changed recently.\n\n## Contributing\n\nPlease see [CONTRIBUTING](CONTRIBUTING.md) for details.\n\n## Security\n\nIf you discover any security related issues, please email [freek@spatie.be](mailto:freek@spatie.be) instead of using the issue tracker.\n\n## Postcardware\n\nYou\'re free to use this package, but if it makes it to your production environment we highly appreciate you sending us a postcard from your hometown, mentioning which of our package(s) you are using.\n\nOur address is: Spatie, Samberstraat 69D, 2060 Antwerp, Belgium.\n\nWe publish all received postcards [on our company website](https://spatie.be/en/opensource/postcards).\n\n## Credits\n\n- [Freek Van der Herten](https://github.com/freekmurze)\n- [All Contributors](../../contributors)\n\nA big thank you to [Nicolas Beauvais](https://github.com/nicolasbeauvais) for helping out with the issues on this repo.\n\n## Alternatives\n\n- [laravel-mediable](https://github.com/plank/laravel-mediable)\n- [laravel-stapler](https://github.com/CodeSleeve/laravel-stapler)\n- [media-manager](https://github.com/talvbansal/media-manager)\n\n## Support us\n\nSpatie is a webdesign agency based in Antwerp, Belgium. You\'ll find an overview of all our open source projects [on our website](https://spatie.be/opensource).\n\nDoes your business depend on our contributions? Reach out and support us on [Patreon](https://www.patreon.com/spatie).\nAll pledges will be dedicated to allocating workforce on maintenance and new awesome stuff.\n\n## License\n\nThe MIT License (MIT). Please see [License File](LICENSE.md) for more information.\n'