b'# ![Alfy](media/header.svg)\n\n> Create [Alfred workflows](https://www.alfredapp.com/workflows/) with ease\n\n[![Build Status](https://travis-ci.org/sindresorhus/alfy.svg?branch=master)](https://travis-ci.org/sindresorhus/alfy)\n\n\n## Highlights\n\n- Easy input\xe2\x86\x94output.\n- Config and [cache](#caching) handling built-in.\n- Fetching remote files with optional caching.\n- Publish your workflow to npm.\n- Automatic [update notifications](#update-notifications).\n- Easily [testable workflows](#testing).\n- [Finds the `node` binary.](run-node.sh)\n- Support for top-level `await`.\n- Presents uncaught exceptions and unhandled Promise rejections to the user.<br>\n  *No need to manually `.catch()` top-level promises.*\n\n\n## Prerequisites\n\nYou need [Node.js 8+](https://nodejs.org) and [Alfred 3 or 4](https://www.alfredapp.com) with the paid [Powerpack](https://www.alfredapp.com/powerpack/) upgrade.\n\n\n## Install\n\n```\n$ npm install alfy\n```\n\n## Usage\n\n1. Create a new blank Alfred workflow.\n\n2. Add a `Script Filter` (right-click the canvas \xe2\x86\x92 `Inputs` \xe2\x86\x92 `Script Filter`), set `Language` to `/bin/bash`, and add the following script:\n\n```\n./node_modules/.bin/run-node index.js "$1"\n```\n\n*We can\'t call `node` directly as GUI apps on macOS doesn\'t inherit the $PATH.*\n\n> Tip: You can use [generator-alfred](https://github.com/SamVerschueren/generator-alfred) to scaffold out an `alfy` based workflow. If so, you can skip the rest of the steps, go straight to the `index.js` and do your thing.\n\n3. Set the `Keyword` by which you want to invoke your workflow.\n\n4. Go to your new workflow directory (right-click on the workflow in the sidebar \xe2\x86\x92 `Open in Finder`).\n\n5. Initialize a repo with `npm init`.\n\n6. Install Alfy with `npm install alfy`.\n\n7. In the workflow directory, create a `index.js` file, import `alfy`, and do your thing.\n\n\n## Example\n\nHere we fetch some JSON from a placeholder API and present matching items to the user:\n\n```js\nconst alfy = require(\'alfy\');\n\nconst data = await alfy.fetch(\'https://jsonplaceholder.typicode.com/posts\');\n\nconst items = alfy\n\t.inputMatches(data, \'title\')\n\t.map(element => ({\n\t\ttitle: element.title,\n\t\tsubtitle: element.body,\n\t\targ: element.id\n\t}));\n\nalfy.output(items);\n```\n\n<img src="media/screenshot.png" width="694">\n\n\n###### More\n\nSome example usage in the wild: [`alfred-npms`](https://github.com/sindresorhus/alfred-npms), [`alfred-emoj`](https://github.com/sindresorhus/alfred-emoj), [`alfred-ng`](https://github.com/SamVerschueren/alfred-ng).\n\n\n## Update notifications\n\nAlfy uses [alfred-notifier](https://github.com/SamVerschueren/alfred-notifier) in the background to show a notification when an update for your workflow is available.\n\n<img src="media/screenshot-update.png" width="694">\n\n\n## Caching\n\nAlfy offers the possibility of caching data, either with the [fetch](#fetchurl-options) or directly through the [cache](#cache) object.\n\nAn important thing to note is that the cached data gets invalidated automatically when you update your workflow. This offers the flexibility for developers to change the structure of the cached data between workflows without having to worry about invalid older data.\n\n\n## Publish to npm\n\nBy adding `alfy-init` as `postinstall` and `alfy-cleanup` as `preuninstall` script, you can publish your package to [npm](https://npmjs.org) instead of to [Packal](http://www.packal.org). This way, your packages are only one simple `npm install` command away.\n\n```json\n{\n\t"name": "alfred-unicorn",\n\t"version": "1.0.0",\n\t"description": "My awesome unicorn workflow",\n\t"author": {\n\t\t"name": "Sindre Sorhus",\n\t\t"email": "sindresorhus@gmail.com",\n\t\t"url": "sindresorhus.com"\n\t},\n\t"scripts": {\n\t\t"postinstall": "alfy-init",\n\t\t"preuninstall": "alfy-cleanup"\n\t},\n\t"dependencies": {\n\t\t"alfy": "*"\n\t}\n}\n```\n\n> Tip: Prefix your workflow with `alfred-` to make them easy searchable through npm.\n\nYou can remove [these](https://github.com/samverschueren/alfred-link#infoplist) properties from your `info.plist` file as they are being added automatically at install time.\n\nAfter publishing your workflow to npm, your users can easily install or update the workflow.\n\n```\n$ npm install --global alfred-unicorn\n```\n\n> Tip: instead of manually updating every workflow yourself, use the [alfred-updater](https://github.com/SamVerschueren/alfred-updater) workflow to do that for you.\n\n\n## Testing\n\nWorkflows can easily be tested with [alfy-test](https://github.com/SamVerschueren/alfy-test). Here is a small example.\n\n```js\nimport test from \'ava\';\nimport alfyTest from \'alfy-test\';\n\ntest(\'main\', async t => {\n\tconst alfy = alfyTest();\n\n\tconst result = await alfy(\'workflow input\');\n\n\tt.deepEqual(result, [\n\t\t{\n\t\t\ttitle: \'foo\',\n\t\t\tsubtitle: \'bar\'\n\t\t}\n\t]);\n});\n```\n\n\n## Debugging\n\nWhen developing your workflow it can be useful to be able to debug it when something is not working. This is when the [workflow debugger](https://www.alfredapp.com/help/workflows/advanced/debugger/) comes in handy. You can find it in your workflow view in Alfred. Press the insect icon to open it. It will show you the plain text output of `alfy.output()` and anything you log with `alfy.log()`:\n\n```js\nconst unicorn = getUnicorn();\nalfy.log(unicorn);\n```\n\n## Environment variables\n\nAlfred lets users set [environment variables for a workflow](https://www.alfredapp.com/help/workflows/advanced/variables/) which can then be used by that workflow. This can be useful if you, for example, need the user to specify an API token for a service. You can access the workflow environment variables from [`process.env`](https://nodejs.org/api/process.html#process_process_env). For example `process.env.apiToken`.\n\n\n## API\n\n### alfy\n\n#### input\n\nType: `string`\n\nInput from Alfred. What the user wrote in the input box.\n\n#### output(list)\n\nReturn output to Alfred.\n\n##### list\n\nType: `object[]`\n\nList of `object` with any of the [supported properties](https://www.alfredapp.com/help/workflows/inputs/script-filter/json/).\n\nExample:\n\n```js\nalfy.output([\n\t{\n\t\ttitle: \'Unicorn\'\n\t},\n\t{\n\t\ttitle: \'Rainbow\'\n\t}\n]);\n```\n\n<img src="media/screenshot-output.png" width="694">\n\n#### log(value)\n\nLog `value` to the [Alfred workflow debugger](https://www.alfredapp.com/help/workflows/advanced/debugger/).\n\n#### matches(input, list, item?)\n\nReturns an `string[]` of items in `list` that case-insensitively contains `input`.\n\n```js\nalfy.matches(\'Corn\', [\'foo\', \'unicorn\']);\n//=> [\'unicorn\']\n```\n\n##### input\n\nType: `string`\n\nText to match against the `list` items.\n\n##### list\n\nType: `string[]`\n\nList to be matched against.\n\n##### item\n\nType: `string | Function`\n\nBy default, it will match against the `list` items.\n\nSpecify a string to match against an object property:\n\n```js\nconst list = [\n\t{\n\t\ttitle: \'foo\'\n\t},\n\t{\n\t\ttitle: \'unicorn\'\n\t}\n];\n\nalfy.matches(\'Unicorn\', list, \'title\');\n//=> [{title: \'unicorn\'}]\n```\n\nOr [nested property](https://github.com/sindresorhus/dot-prop):\n\n```js\nconst list = [\n\t{\n\t\tname: {\n\t\t\tfirst: \'John\',\n\t\t\tlast: \'Doe\'\n\t\t}\n\t},\n\t{\n\t\tname: {\n\t\t\tfirst: \'Sindre\',\n\t\t\tlast: \'Sorhus\'\n\t\t}\n\t}\n];\n\nalfy.matches(\'sindre\', list, \'name.first\');\n//=> [{name: {first: \'Sindre\', last: \'Sorhus\'}}]\n```\n\nSpecify a function to handle the matching yourself. The function receives the list item and input, both lowercased, as arguments, and is expected to return a boolean of whether it matches:\n\n```js\nconst list = [\'foo\', \'unicorn\'];\n\n// Here we do an exact match.\n// `Foo` matches the item since it\'s lowercased for you.\nalfy.matches(\'Foo\', list, (item, input) => item === input);\n//=> [\'foo\']\n```\n\n#### inputMatches(list, item?)\n\nSame as `matches()`, but with `alfy.input` as `input`.\n\n#### error(error)\n\nDisplay an error or error message in Alfred.\n\n**Note:** You don\'t need to `.catch()` top-level promises. Alfy handles that for you.\n\n##### error\n\nType: `Error | string`\n\nError or error message to be displayed.\n\n<img src="media/screenshot-error.png" width="694">\n\n#### fetch(url, options?)\n\nReturns a `Promise` that returns the body of the response.\n\n##### url\n\nType: `string`\n\nURL to fetch.\n\n##### options\n\nType: `object`\n\nAny of the [`got` options](https://github.com/sindresorhus/got#options).\n\n###### json\n\nType: `boolean`<br>\nDefault: `true`\n\nParse response body with `JSON.parse` and set `accept` header to `application/json`.\n\n###### maxAge\n\nType: `number`\n\nNumber of milliseconds this request should be cached.\n\n###### transform\n\nType: `Function`\n\nTransform the response before it gets cached.\n\n```js\nawait alfy.fetch(\'https://api.foo.com\', {\n\ttransform: body => {\n\t\tbody.foo = \'bar\';\n\t\treturn body;\n\t}\n})\n```\n\nYou can also return a Promise.\n\n```js\nconst xml2js = require(\'xmls2js\');\nconst pify = require(\'pify\');\n\nconst parseString = pify(xml2js.parseString);\n\nawait alfy.fetch(\'https://api.foo.com\', {\n\ttransform: body => parseString(body)\n})\n```\n\n#### config\n\nType: `object`\n\nPersist config data.\n\nExports a [`conf` instance](https://github.com/sindresorhus/conf#instance) with the correct config path set.\n\nExample:\n\n```js\nalfy.config.set(\'unicorn\', \'\xf0\x9f\xa6\x84\');\n\nalfy.config.get(\'unicorn\');\n//=> \'\xf0\x9f\xa6\x84\'\n```\n\n#### cache\n\nType: `object`\n\nPersist cache data.\n\nExports a modified [`conf` instance](https://github.com/sindresorhus/conf#instance) with the correct cache path set.\n\nExample:\n\n```js\nalfy.cache.set(\'unicorn\', \'\xf0\x9f\xa6\x84\');\n\nalfy.cache.get(\'unicorn\');\n//=> \'\xf0\x9f\xa6\x84\'\n```\n\n##### maxAge\n\nThe `set` method of this instance accepts an optional third argument where you can provide a `maxAge` option. `maxAge` is\nthe number of milliseconds the value is valid in the cache.\n\nExample:\n\n```js\nconst delay = require(\'delay\');\n\nalfy.cache.set(\'foo\', \'bar\', {maxAge: 5000});\n\nalfy.cache.get(\'foo\');\n//=> \'bar\'\n\n// Wait 5 seconds\nawait delay(5000);\n\nalfy.cache.get(\'foo\');\n//=> undefined\n```\n\n#### debug\n\nType: `boolean`\n\nWhether the user currently has the [workflow debugger](https://www.alfredapp.com/help/workflows/advanced/debugger/) open.\n\n#### icon\n\nType: `object`<br>\nKeys: `info` `warning` `error` `alert` `like` `delete`\n\nGet various default system icons.\n\nThe most useful ones are included as keys. The rest you can get with `icon.get()`. Go to `/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources` in Finder to see them all.\n\nExample:\n\n```js\nconsole.log(alfy.icon.error);\n//=> \'/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/AlertStopIcon.icns\'\n\nconsole.log(alfy.icon.get(\'Clock\'));\n//=> \'/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/Clock.icns\'\n```\n\n#### meta\n\nType: `object`\n\nExample:\n\n```js\n{\n\tname: \'Emoj\',\n\tversion: \'0.2.5\',\n\tuid: \'user.workflow.B0AC54EC-601C-479A-9428-01F9FD732959\',\n\tbundleId: \'com.sindresorhus.emoj\'\n}\n```\n\n#### alfred\n\nType: `object`\n\nAlfred metadata.\n\n##### version\n\nExample: `\'3.0.2\'`\n\nFind out which version the user is currently running. This may be useful if your workflow depends on a particular Alfred version\'s features.\n\n##### theme\n\nExample: `\'alfred.theme.yosemite\'`\n\nCurrent theme used.\n\n##### themeBackground\n\nExample: `\'rgba(255,255,255,0.98)\'`\n\nIf you\'re creating icons on the fly, this allows you to find out the color of the theme background.\n\n##### themeSelectionBackground\n\nExample: `\'rgba(255,255,255,0.98)\'`\n\nThe color of the selected result.\n\n##### themeSubtext\n\nExample: `3`\n\nFind out what subtext mode the user has selected in the Appearance preferences.\n\n> Usability note: This is available so developers can tweak the result text based on the user\'s selected mode, but a workflow\'s result text should not be bloated unnecessarily based on this, as the main reason users generally hide the subtext is to make Alfred look cleaner.\n\n##### data\n\nExample: `\'/Users/sindresorhus/Library/Application Support/Alfred/Workflow Data/com.sindresorhus.npms\'`\n\nRecommended location for non-volatile data. Just use `alfy.data` which uses this path.\n\n##### cache\n\nExample: `\'/Users/sindresorhus/Library/Caches/com.runningwithcrayons.Alfred/Workflow Data/com.sindresorhus.npms\'`\n\nRecommended location for volatile data. Just use `alfy.cache` which uses this path.\n\n##### preferences\n\nExample: `\'/Users/sindresorhus/Dropbox/Alfred/Alfred.alfredpreferences\'`\n\nThis is the location of the `Alfred.alfredpreferences`. If a user has synced their settings, this will allow you to find out where their settings are regardless of sync state.\n\n##### preferencesLocalHash\n\nExample: `\'adbd4f66bc3ae8493832af61a41ee609b20d8705\'`\n\nNon-synced local preferences are stored within `Alfred.alfredpreferences` under `\xe2\x80\xa6/preferences/local/${preferencesLocalHash}/`.\n\n\n## Users\n\n*Alfred workflows using Alfy*\n\n- [alfred-emoj](https://github.com/sindresorhus/alfred-emoj) - Find relevant emoji from text\n- [alfred-npms](https://github.com/sindresorhus/alfred-npms) - Search for npm packages with npms.io\n- [alfred-dark-mode](https://github.com/sindresorhus/alfred-dark-mode) - Toggle the system dark mode\n- [alfred-xcode](https://github.com/sindresorhus/alfred-xcode) - Open Xcode projects and workspaces\n- [alfred-lock](https://github.com/sindresorhus/alfred-lock) - Lock your Mac\n- [alfred-fkill](https://github.com/SamVerschueren/alfred-fkill) - Fabulously search and kill processes\n- [alfred-ng](https://github.com/SamVerschueren/alfred-ng) - Search through the Angular documentation on angular.io\n- [alfred-ionic](https://github.com/SamVerschueren/alfred-ionic) - Search through the Ionic documentation\n- [alfred-react-native](https://github.com/ekonstantinidis/alfred-react-native) - Access the React Native documentation\n- [alfred-hl](https://github.com/importre/alfred-hl) - Syntax highlight code in the clipboard\n- [alfred-workflow-docs-elastic](https://github.com/spinscale/alfred-workflow-elastic-docs) - Search the Elastic.co documentation\n- [alfredinary](https://github.com/urre/alfredinary) - Capture screenshots and upload to Cloudinary\n- [alfred-keycode](https://github.com/radibit/alfred-keycode) - Get JavaScript keycodes\n- [alfred-vue](https://github.com/radibit/alfred-vue) - Search the Vue.js API docs\n- [alfred-meteor-docs](https://github.com/wolasss/alfred-meteor-docs) - Search the Meteor docs\n- [alfred-meteor-packages](https://github.com/sasikanth513/alfred-meteor-packages) - Meteor package search\n- [alfred-climbing-grades-converter](https://github.com/wolasss/alfred-climbing-grades-converter) - Convert between climbing grading systems\n- [alfred-hotel](https://github.com/exah/alfred-hotel) - Quickly start, stop and open [Hotel](https://github.com/typicode/hotel) apps\n- [alfred-coolors](https://github.com/radibit/alfred-coolors) - Find relevant color names\n- [alfred-postico-favorites-workflow](https://github.com/payers1/alfred-postico-favorites-workflow) - Open postico favorites\n- [alfred-messages](https://github.com/briangonzalez/alfred-messages) - Message your contacts through iMessage\n- [alfred-bitbucket](https://github.com/nicklayb/alfred-bitbucket) - List you and your teams public and private Bitbucket repositories\n- [alfred-asana](https://github.com/adriantoine/alfred-asana) - Search your Asana tasks\n- [alfred-cacher](https://github.com/CacherApp/alfred-cacher) - Find a code snippet from [Cacher](https://www.cacher.io) and copy it to the clipboard\n- [alfred-loremipsum](https://github.com/AntonNiklasson/alfred-loremipsum) - Generate placeholder text\n- [alfred-kaomoji](https://github.com/vinkla/alfred-kaomoji) - Find relevant kaomoji from text\n- [alfred-packagist](https://github.com/vinkla/alfred-packagist) - Search for PHP packages with Packagist\n- [alfred-vpn](https://github.com/stve/alfred-vpn) - Connect/disconnect from VPNs\n- [alfred-clap](https://github.com/jacc/alfred-clap) - \xf0\x9f\x91\x8f\xf0\x9f\x8f\xbb Clap \xf0\x9f\x91\x8f\xf0\x9f\x8f\xbb stuff \xf0\x9f\x91\x8f\xf0\x9f\x8f\xbb out \xf0\x9f\x91\x8f\xf0\x9f\x8f\xbb in \xf0\x9f\x91\x8f\xf0\x9f\x8f\xbb Alfred! \xf0\x9f\x91\x8f\xf0\x9f\x8f\xbb\n- [alfred-yandex-translate](https://github.com/mkalygin/alfred-yandex-translate) - Translate words and text with Yandex Translate\n- [alfred-now](https://github.com/lucaperret/alfred-now) - Use [Now](https://zeit.co/now) commands within Alfred to access deployments and aliases\n- [alfred-chuck-norris-jokes](https://github.com/jeppestaerk/alfred-chuck-norris-jokes) - Get Chuck Norris jokes\n- [alfred-show-network-info](https://github.com/jeppestaerk/alfred-show-network-info) - See network info and discover local devices\n- [alfred-currency-conversion](https://github.com/jeppestaerk/alfred-currency-conversion) - See foreign exchange rates and currency conversion\n- [alfred-reference](https://github.com/vinkla/alfred-reference) - Search for HTML elements and CSS properties\n- [alfred-polyglot](https://github.com/nikersify/alfred-polyglot) - Translate text with Google Translate\n- [alfred-stock-price](https://github.com/Wei-Xia/alfred-stock-price-workflow) - Show real time stock price in US market\n- [alfred-jira](https://github.com/colinf/alfred-jira) - Convert clipboard text between Markdown and Jira markup\n- [alfred-homebrew](https://github.com/vinkla/alfred-homebrew) - Search for macOS packages with Homebrew\n- [alfred-network-location-switch](https://github.com/abdul/alfred-network-location-switch) - Switch macOS network location\n- [alfred-cool](https://github.com/nguyenvanduocit/alfred-cool) - Find cool words\n- [alfred-google-books](https://github.com/Dameck/alfred-google-books) - Search for Google Books\n- [alfred-ip](https://github.com/calpa/alfy-ip) - Find your public IP\n- [alfred-figma](https://github.com/jonrohan/alfred-figma) \xe2\x80\x93 Quick links and search Figma teams, projects and files\n- [alfred-flutter-docs](https://github.com/Sh1d0w/alfred-flutter-docs) \xe2\x80\x93 Quickly search and preview Flutter docs\n- [alfred-title](https://github.com/Kikobeats/alfred-title) \xe2\x80\x93 Capitalize your titles\n- [alfred-trello](https://github.com/mblode/alfred-trello) - Search your boards, quickly add cards, and view list of cards for Trello\n- [alfred-npm-versions](https://github.com/mrmartineau/alfred-npm-versions) - Lookup the latest 15 versions for an npm package\n- [alfred-travis-ci](https://github.com/adriantombu/alfred-travis-ci) - Check the status of your Travis CI builds\n- [alfred-github-trending](https://github.com/mikqi/alfred-github-trending) - Search trending repositories on GitHub\n- [alfred-elm](https://github.com/nicklayb/alfred-elm) - Browse Elm packages documentation\n\n\n## Related\n\n- [alfred-simple](https://github.com/sindresorhus/alfred-simple) - Simple theme for Alfred *(Used in the screenshots)*\n- [alfred-updater](https://github.com/SamVerschueren/alfred-updater) - Workflow updater\n- [alfred-notifier](https://github.com/SamVerschueren/alfred-notifier) - Update notifications for your workflow\n- [generator-alfred](https://github.com/samverschueren/generator-alfred) - Scaffold out an Alfred workflow\n\n\n## Maintainers\n\n- [Sindre Sorhus](https://github.com/sindresorhus)\n- [Sam Verschueren](https://github.com/SamVerschueren)\n- [@LitoMore](https://github.com/LitoMore)\n'