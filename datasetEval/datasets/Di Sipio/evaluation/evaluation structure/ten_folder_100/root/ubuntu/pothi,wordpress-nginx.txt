b"# WordPress Nginx Configuration Templates\n\nWordPress specific Nginx configurations, tweaks, and much more!\n\n## Features\n\nThere are multiplpe advantages of using this repo as your go-to nginx configuration.\n\n+ Correct use of `if` statement because [ifisevil](https://www.nginx.com/resources/wiki/start/topics/depth/ifisevil/).\n+ SSL / LetsEncrypt / Certbot compatible.\n+ Multisite support.\n+ Contains ready-to-use sample vhost entries.\n+ Continuously updated sample configurations with best practices.\n+ IPv6 is supported out of the box.\n+ Cloudflare support.\n+ [WebP](https://developers.google.com/speed/webp/) support.\n\n## Available templates / vhost entries\n\n+ WP Super Cache plugin (with support for SSL and separate mobile cache)\n+ WP Rocket cache plugin (SSL and / or mobile supported out of the box)\n+ WP Fastest Cache plugin (SSL and / or mobile supported out of the box)\n+ Multisite (sub-domain and sub-directory)\n+ Varnish with Nginx for SSL termination.\n+ Custom error pages.\n+ Catchall template.\n\n## Performance\n\n+ All static content have maximum expiration headers.\n+ SSL session cache is enabled by default.\n+ Brotli compression support.\n+ Open file cache support.\n+ Server-level 301 support (for http => https, non-www => www, etc).\n+ [Autoptimize](https://wordpress.org/plugins/autoptimize/) support.\n\n## Security\n\n+ Support for [strong dhparam](https://weakdh.org/).\n+ TLSv1 and other insecure protocols are disabled by default.\n+ Mitigate [httpoxy](https://httpoxy.org/) vulnerability.\n+ [HSTS](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security) support.\n+ Security headers to fit most sites (no CSP, though, as it varies depending on the site).\n+ All hidden and backup files are forbidden by default.\n+ Passes most security features in [Sonar Scanner](https://sonarwhal.com/scanner/).\n+ Gets 'A+' grade in [Qualys SSL Labs](https://www.ssllabs.com/ssltest/).\n\n## Compatibility\n\nTested with the following servers...\n+ Debian Debian 9 (Stretch)\n+ Ubuntu 16.04 LTS (Xenial Xerus)\n+ Ubuntu 18.04 LTS (Bionic Beaver)\n\nTested with the following Nginx versions...\n+ Stable verisons 1.12.x and 1.14.x\n+ Mainline versions 1.13.x, 1.15.x\n\nFor RPM based distros (Fedora, Redhat, CentOS and Amazon Linux AMI), the configuration mentioned in the repo is likely to work. Additional steps may be needed, though. See below for some details!\n\n### Changes on CentOS (and on rpm based distros in general)\n\nCentOS has a different file naming convention, yet simple directory structure, when compared to Debian derivatives. Let me describe them and I'd let you decide upon how you'd want to structure your files and name those files.\n\n+ The configuration for default sites are named as `default.conf` and `ssl.conf` in `/etc/nginx/conf.d/`.\n+ There is no `sites-available` or `sites-enabled` folder.\n+ The file `/etc/nginx/fastcgi_params` in Debian is named as `/etc/nginx/fastcgi.conf` in CentOS.\n\n## How to Deploy\n\n*Short answer*: Use [WordPress in a box](https://github.com/pothi/wp-in-a-box). It sets up your server with all the goodies, including this repo!\n\n*Long answer*:\n\nNote: For all the steps mentioned below, __sudo__ or __root__ privilege is required!\n\nStep #1 - Install Nginx\n\nYou may use [the official Nginx repo](https://nginx.org/en/linux_packages.html) or just use the Nginx package that comes with the OS. Both would work fine! I will leave the decision to you. Since, the installation process varies across Operating Systems, please refer the official installation guide to complete this step.\n\nIf you prefer to use the Nginx packages that comes with the OS, you may need to run the following...\n\n`sudo apt install nginx`\n\nor\n\n`sudo yum install nginx`\n\nStep #2 - Please backup your existing configuration files. Probably, have /etc under version control!\n\n```bash\nTIMESTAMP=$(date +%F_%H-%M-%S)\nmkdir ~/nginx-backup-$TIMESTAMP\nsudo cp -a /etc/nginx ~/nginx-backup-$TIMESTAMP\n```\n\nStep #3 - Copy this repo to your server.\n\n```bash\ngit clone https://github.com/pothi/wordpress-nginx.git ~/git/wordpress-nginx\nsudo cp -a ~/git/wordpress-nginx/* /etc/nginx/\nsudo mkdir /etc/nginx/sites-enabled &> /dev/null\nsudo cp /etc/nginx/nginx-sample.conf /etc/nginx/nginx.conf\n```\nFurther steps varies depending on your particular requirement:\n\n+ you may edit /etc/nginx/conf.d/lb.conf and update the upstream block for 'fpm' (one-off process; done automatically if you use [WordPress in a LEMP Box](https://github.com/pothi/wp-in-a-box))\n+ then you may do the following for each vhost (domain), depending on your environment...\n\n```bash\nWP_DOMAIN=example.com\nWP_ROOT=/path/to/wordpress/for/example.com\nsudo cp /etc/nginx/sites-available/example.com.conf /etc/nginx/sites-available/$WP_DOMAIN.conf\nsudo sed -i 's:/home/username/sites/example.com/public:'$WP_ROOT':gp' /etc/nginx/sites-available/$WP_DOMAIN.conf\nsudo sed -i 's/example.com/'$WP_DOMAIN'/g' /etc/nginx/sites-available/$WP_DOMAIN.conf\ncd /etc/nginx/sites-enabled/\nsudo ln -s ../sites-available/$WP_DOMAIN.conf\nsudo nginx -t && sudo systemctl restart nginx\n```\n\n### About me\n\n+ I specialize in hosting (high-traffic) WordPress / PHP sites.\n+ I'm one of the top contributors for the tag [Nginx in ServerFault](https://serverfault.com/users/102173/pothi-kalimuthu?tab=profile).\n+ Have released couple of WordPress Plugins, one of them is specifically for high performance WordPress sites... [https://profiles.wordpress.org/pothi#content-plugins](https://profiles.wordpress.org/pothi#content-plugins).\n+ Have two _active_ blogs... [Tiny WordPress Insights](https://www.tinywp.in/) and [Tiny Web Performance Insights](https://www.tinywp.com/).\n\n### Can you implement it on my server?\n\nYes, of course. My hourly rate is USD 50 per hour. Please [contact me](https://www.tinywp.in/contact/) for any queries in this regard.\n\n### Have questions or just wanted to say hi?\n\nPlease ping me on [Twitter](https://twitter.com/pothi]) or [send me a message](https://www.tinywp.in/contact/).\n\nIf you find this repo useful, please spread the word! Suggestions, discussion on best practices, bug reports, future requests, forks are always welcome!\n"