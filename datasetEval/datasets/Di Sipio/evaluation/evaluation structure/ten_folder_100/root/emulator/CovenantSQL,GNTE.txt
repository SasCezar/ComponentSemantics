b'<img src="logo/logo.jpeg" width=200>\n\n# GNTE\nGNTE(Global Network Topology Emulator) is a docker-based all-in-one unstable global network emulator. It emulates functionality such as random delay and packet loss.\n\n## Before Use\nInstall docker\n\n## Build and Run\n### 1. build docker image\nClone this repo and run `build.sh`. There should be an image named `ns` in your docker environment.\n\n### 2. modify network definition file\nEdit ```example.yaml``` to fit your requirements. The rules of this file are described in the bottom section.\n\n### 3. generate and launch network emulator\nRun the following command:\n\n```\n./generate.sh\n```\n\nOnce all CovenantSQL testnet dockers are running, you can use `docker ps -a` to see all container nodes: \n<img src="logo/container_node.png">\n\nYou can also find a graph of the network in `graph.png` under your root folder:\n<img src="logo/graph.png">\n\n### 4. stop random one node or all nodes\nRun the following command:\n\n```\n./generate.sh stopone filter\n```\n\nwill stop randon one node. If filter is not empty, it will stop node name contains filter.\n\nAnd there is also a command to stop all:\n\n```\n./generate.sh stopall filter\n```\n\nAlso a command for restart all stopped nodes:\n\n```\n./generate.sh startall\n```\n\n### 5. run your own program in testnet\nContainers are referenced by group_name+ip. For example, given containers 10.250.1.2 and 10.250.8.2, you can run `docker exec -it china10.250.1.2 ping 10.250.8.2` to test the connection between these two networks.\n\nYou can replace the `cmd` in the group section of yaml to run your own command. \nThe `scripts` dir will be "volumed" to containers.\n`docker run --rm -it -v $DIR/scripts:/scripts` you can put your own binaries or scripts here and put your self defined `scripts/my.yaml`: \n\n```yaml\ngroup:\n  - \n    name: china\n    nodes:\n      - \n        ip: 10.250.1.2\n        cmd: "cd /scripts && ./YourBin args"\n      - \n        ip: 10.250.1.3\n        cmd: "cd /scripts && ./YourBin args"\n    delay: "100ms 10ms 30%"\n    loss: "1% 10%"\n  - \n    name: us\n    nodes:\n      - \n        ip: 10.250.2.2\n        cmd: "cd /scripts && ./YourBin args"\n      - \n        ip: 10.250.2.3\n        cmd: "cd /scripts && ./YourBin args"\n    delay: "1000ms 10ms 30%"\n    loss: "1% 10%"\n    \nnetwork:\n  -\n    groups:\n      - china\n      - us\n    delay: "200ms 10ms 1%"\n    corrupt: "0.2%"\n    rate: "10mbit"\n\n```\n\nand run \n```bash\n./generate.sh scripts/my.yaml\n```\n\n### 5. [optional] clean network\nRun `./scripts/clean.sh`\n\n## Modify Network Definition\nA sample network description is provided in `example.yaml`, which you can edit directly.\n\n### sample\n```yaml\n# Only support 10.250.0.2 ~ 10.250.254.254\ngroup:\n  -\n    name: china\n    nodes:\n      -\n        ip: 10.250.1.2/32\n        cmd: "ping -c3 g.cn"\n      -\n        ip: 10.250.2.2/32\n        cmd: "ping -c3 g.cn"\n      -\n        ip: 10.250.3.2/32\n        cmd: "ping -c3 g.cn"\n      -\n        ip: 10.250.4.2/32\n        cmd: "ping -c3 g.cn"\n    delay: "100ms 10ms 30%"\n    loss: "1% 10%"\n  -\n    name: eu\n    nodes:\n      -\n        ip: 10.250.5.2/32\n        cmd: "ping -c3 g.cn"\n      -\n        ip: 10.250.6.2/32\n        cmd: "ping -c3 g.cn"\n      -\n        ip: 10.250.7.2/32\n        cmd: "ping -c3 g.cn"\n    delay: "10ms 5ms 30%"\n    loss: "1% 10%"\n  -\n    name: jpn\n    nodes:\n      -\n        ip: 10.250.8.2/32\n        cmd: "ping -c3 g.cn"\n      -\n        ip: 10.250.9.2/32\n        cmd: "ping -c3 g.cn"\n    delay: "100ms 10ms 30%"\n    duplicate: "1%"\n    rate: "100mbit"\n\nnetwork:\n  -\n    groups:\n      - china\n      - eu\n    delay: "200ms 10ms 1%"\n    corrupt: "0.2%"\n    rate: "10mbit"\n\n  -\n    groups:\n      - china\n      - jpn\n    delay: "100ms 10ms 1%"\n    rate: "10mbit"\n\n  -\n    groups:\n      - jpn\n      - eu\n    delay: "30ms 5ms 1%"\n    rate: "100mbit"\n\n```\n\n## Description\nThe network definition contains two sections: group and network. Group defines ips and describes network info between them. Network describes network info between groups.\n\n### group\n- **name**: unique name of the group\n\n- **nodes**: list of node in the network. \n\n#### node\n- **ip**: Node IP must be between "10.250.0.2 ~ 10.250.254.254" and written in CIDR format, eg. `10.250.1.2/32`.\n\n- **cmd**: Node command to run. Blocking or Non-blocking are both ok.\n\n- **network params**:\nThe following 6 tc network limit parameters are supported:\n    ```\n    delay\n    loss\n    duplicate\n    corrupt\n    reorder\n    rate\n    ```\nThe values of these parameters are exactly like those of the `tc` command.\n\n* `delay: "100ms 10ms 30%"` means 100ms delay in network and 30% packets +-10ms.\n* `duplicate: "1%"` means 1% packets is duplicated.\n* `rate: "100mbit"` means network transmit rate is 100mbit.\n* `corrupt: "0.2%"` means 0.2% packets are randomly modified.\n\n### network\n- **groups**: list of group names\n\n- **network params**: same as group\n'