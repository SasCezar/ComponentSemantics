b'<p align="center">\n    <img src="https://github.com/mattallty/Caporal.js/raw/master/assets/caporal.png" width="500" height="177">\n</p>\n\n[![Travis](https://img.shields.io/travis/mattallty/Caporal.js.svg)](https://travis-ci.org/mattallty/Caporal.js)\n[![Codacy grade](https://img.shields.io/codacy/grade/6e5459fd36e341d1bd27414cf6b06e5c.svg)](https://www.codacy.com/app/matthiasetienne/Caporal-js/dashboard)\n[![Codacy coverage](https://img.shields.io/codacy/coverage/6e5459fd36e341d1bd27414cf6b06e5c.svg)]()\n[![npm](https://img.shields.io/npm/v/caporal.svg)](https://www.npmjs.com/package/caporal)\n[![npm](https://img.shields.io/npm/dm/caporal.svg)](https://www.npmjs.com/package/caporal)\n[![David](https://img.shields.io/david/mattallty/Caporal.js.svg)](https://david-dm.org/mattallty/Caporal.js)\n[![GitHub stars](https://img.shields.io/github/stars/mattallty/Caporal.js.svg?style=social&label=Star)](https://github.com/mattallty/Caporal.js/stargazers)\n[![GitHub forks](https://img.shields.io/github/forks/mattallty/Caporal.js.svg?style=social&label=Fork)](https://github.com/mattallty/Caporal.js/network)\n\n# Caporal\n\n> A full-featured framework for building command line applications (cli) with node.js,\n> including help generation, colored output, verbosity control, custom logger, coercion\n> and casting, typos suggestions, and auto-complete for bash/zsh/fish.\n\n## Install\n\nSimply add Caporal as a dependency:\n```bash\n$ npm install caporal\n\n# Or if you are using yarn (https://yarnpkg.com/lang/en/)\n$ yarn add caporal\n```\n## Glossary\n\n* **Program**: a cli app that you can build using Caporal\n* **Command**: a command within your program. A program may have multiple commands.\n* **Argument**: a command may have one or more arguments passed after the command.\n* **Options**: a command may have one or more options passed after (or before) arguments.\n\nAngled brackets (e.g. `<item>`) indicate required input. Square brackets (e.g. `[env]`) indicate optional input.\n\n## Examples\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  // you specify arguments using .argument()\n  // \'app\' is required, \'env\' is optional\n  .command(\'deploy\', \'Deploy an application\')\n  .argument(\'<app>\', \'App to deploy\', /^myapp|their-app$/)\n  .argument(\'[env]\', \'Environment to deploy on\', /^dev|staging|production$/, \'local\')\n  // you specify options using .option()\n  // if --tail is passed, its value is required\n  .option(\'--tail <lines>\', \'Tail <lines> lines of logs after deploy\', prog.INT)\n  .action(function(args, options, logger) {\n    // args and options are objects\n    // args = {"app": "myapp", "env": "production"}\n    // options = {"tail" : 100}\n  });\n\nprog.parse(process.argv);\n\n// ./myprog deploy myapp production --tail 100\n```\n\nOr else if you prefer `typescript`\n```javascript\n#!/usr/bin/env node\nimport * as prog from \'caporal\';\nprog\n  .version(\'1.0.0\')\n  // you specify arguments using .argument()\n  // \'app\' is required, \'env\' is optional\n  .command(\'deploy\', \'Deploy an application\')\n  .argument(\'<app>\', \'App to deploy\', /^myapp|their-app$/)\n  .argument(\'[env]\', \'Environment to deploy on\', /^dev|staging|production$/, \'local\')\n  // you specify options using .option()\n  // if --tail is passed, its value is required\n  .option(\'--tail <lines>\', \'Tail <lines> lines of logs after deploy\', prog.INT)\n  .action(function(args, options, logger) {\n    // args and options are objects\n    // args = {"app": "myapp", "env": "production"}\n    // options = {"tail" : 100}\n  });\n\nprog.parse(process.argv);\n\n// ./myprog deploy myapp production --tail 100\n```\n\n\n### Variadic arguments\n\nYou can use `...` to indicate variadic arguments. In that case, the resulted value will be an array.\n**Note:** Only the last argument of a command can be variadic !\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'deploy\', \'Our deploy command\')\n  // \'app\' and \'env\' are required\n  // and you can pass additional environments\n  .argument(\'<app>\', \'App to deploy\')\n  .argument(\'<env>\', \'Environment\')\n  .argument(\'[other-env...]\', \'Other environments\')\n  .action(function(args, options, logger) {\n    console.log(args);\n    // {\n    //   "app": "myapp",\n    //   "env": "production",\n    //   "otherEnv": ["google", "azure"]\n    // }\n  });\n\nprog.parse(process.argv);\n\n// ./myprog deploy myapp production aws google azure\n```\n\n### Simple program (single command)\n\nFor a very simple program with just one command, you can omit the .command() call:\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .description(\'A simple program that says "biiiip"\')\n  .action(function(args, options, logger) {\n    logger.info("biiiip")\n  });\n\nprog.parse(process.argv);\n```\n\n### Programmatic Caporal usage\n\nYou can pass arguments and options directly to Caporal API.\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'deploy\', \'Our deploy command\')\n  .argument(\'<app>\', \'App to deploy\')\n  .argument(\'<env>\', \'Environment\')\n  .option(\'--how-much <amount>\', \'How much app to deploy\', prog.INT, 1)\n  .action(function(args, options, logger) {\n    logger.info(args);\n    logger.info(options);\n    // {\n    //   "app": "myapp",\n    //   "env": "production"\n    // }\n    // {\n    //   "howMuch": 2\n    // }\n  });\nprog.exec([\'deploy\', \'myapp\', \'env\'], {\n  howMuch: 2\n});\n```\n\n## Logging\n\nInside your action(), use the logger argument (third one) to log informations.\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'deploy\', \'The deploy command\')\n  .action((args, options, logger) => {\n    // Available methods:\n    // - logger.debug(\'message\')\n    // - logger.info(\'message\') or logger.log(\'level\', \'message\')\n    // - logger.warn(\'message\')\n    // - logger.error(\'message\')\n    logger.info("Application deployed !");\n  });\n\nprog.parse(process.argv);\n```\n\n### Logging levels\n\nThe default logging level is \'info\'. The predefined options can be used to change the logging level:\n\n* `-v, --verbose`: Set the logging level to \'debug\' so debug() logs will be output.\n* `--quiet, --silent`: Set the logging level to \'warn\' so only warn() and error() logs will be output.\n\n### Custom logger\n\nCaporal uses `winston` for logging. You can provide your own winston-compatible logger using `.logger()` the following way:\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nconst myLogger = require(\'/path/to/my/logger.js\');\nprog\n  .version(\'1.0.0\')\n  .logger(myLogger)\n  .command(\'foo\', \'Foo command description\')\n  .action((args, options, logger) => {\n    logger.info("Foo !!");\n  });\n\nprog.parse(process.argv);\n```\n\n* `-v, --verbose`: Set the logging level to \'debug\' so debug() logs will be output.\n* `--quiet, --silent`: Set the logging level to \'warn\' so only warn() and error() logs will be output.\n\n\n## Coercion and casting using validators\n\nYou can apply coercion and casting using various *validators*:\n\n * [Caporal flags](#flag-validator)\n * [Functions](#function-validator)\n * [Array](#array-validator)\n * [RegExp](#regexp-validator)\n\n### Flag validator\n\n* `INT` (or `INTEGER`): Check option looks like an int and cast it with `parseInt()`\n* `FLOAT`: Will Check option looks like a float and cast it with `parseFloat()`\n* `BOOL` (or `BOOLEAN`): Check for string like `0`, `1`, `true`, `false`, `on`, `off` and cast it\n* `LIST` (or `ARRAY`): Transform input to array by splitting it on comma\n* `REPEATABLE`: Make the option repeatable, eg `./mycli -f foo -f bar -f joe`\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'order pizza\')\n  .option(\'--number <num>\', \'Number of pizza\', prog.INT, 1)\n  .option(\'--kind <kind>\', \'Kind of pizza\', /^margherita|hawaiian$/)\n  .option(\'--discount <amount>\', \'Discount offer\', prog.FLOAT)\n  .option(\'--add-ingredients <ingredients>\', \'Ingredients\', prog.LIST)\n  .action(function(args, options) {\n    // options.kind = \'margherita\'\n    // options.number = 1\n    // options.addIngredients = [\'pepperoni\', \'onion\']\n    // options.discount = 1.25\n  });\n\nprog.parse(process.argv);\n\n// ./myprog order pizza --kind margherita --discount=1.25 --add-ingredients=pepperoni,onion\n```\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'concat\') // concat files\n  .option(\'-f <file>\', \'File to concat\', prog.REPEATABLE)\n  .action(function(args, options) {\n\n  });\n\nprog.parse(process.argv);\n\n// Usage:\n// ./myprog concat -f file1.txt -f file2.txt -f file3.txt\n```\n\n### Function validator\n\nUsing this method, you can check and cast user input. Make the check fail by throwing an `Error`,\nand cast input by returning a new value from your function.\n\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'order pizza\')\n  .option(\'--kind <kind>\', \'Kind of pizza\', function(opt) {\n    if ([\'margherita\', \'hawaiian\'].includes(opt) === false) {\n      throw new Error("You can only order margherita or hawaiian pizza!");\n    }\n    return opt.toUpperCase();\n  })\n  .action(function(args, options) {\n    // options = { "kind" : "MARGHERITA" }\n  });\n\nprog.parse(process.argv);\n\n// ./myprog order pizza --kind margherita\n```\n\n### Array validator\n\nUsing an `Array`, Caporal will check that it contains the argument/option passed.\n\n**Note**: It is not possible to cast user input with this method, only checking it,\nso it\'s basically only interesting for strings, but a major advantage is that this method\nwill allow autocompletion of arguments and option *values*.\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'order pizza\')\n  .option(\'--kind <kind>\', \'Kind of pizza\', ["margherita", "hawaiian"])\n  .action(function(args, options) {\n\n  });\n\nprog.parse(process.argv);\n\n// ./myprog order pizza --kind margherita\n```\n\n### RegExp validator\n\nSimply pass a RegExp object to test against it.\n**Note**: It is not possible to cast user input with this method, only checking it,\nso it\'s basically only interesting for strings.\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'order pizza\')\n  .option(\'--kind <kind>\', \'Kind of pizza\', /^margherita|hawaiian$/)\n  .action(function(args, options) {\n\n  });\n\nprog.parse(process.argv);\n\n// ./myprog order pizza --kind margherita\n```\n\n## Colors\n\nBy default, Caporal will output colors for help and errors.\nThis behaviour can be disabled by passing `--no-color`.\n\n## Auto-generated help\n\nCaporal automatically generates help/usage instructions for you.\nHelp can be displayed using `-h` or `--help` options, or with the default `help` command.\n\n<p align="center">\n <img src="https://github.com/mattallty/Caporal.js/raw/master/assets/colors.png" wdith="600">\n</p>\n\n## Custom help\n\nYou can add some custom help to the whole program or to specific commands using `.help(text, options?)`. The text, even if multi-line, will be, optionally, automatically indented.\n\nMultiple help sections, with custom names, are supported.\n\n### Custom help for the whole program\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .help(\'my global help\') // here our custom help for the whole program\n  .command(\'order pizza\')\n  .action(function(args, options) {\n\n  });\n\nprog.parse(process.argv);\n```\n\n### Custom help for specific commands\n\n```javascript\n#!/usr/bin/env node\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  // first command\n  .command(\'order\')\n  .help(\'my help for the order command\') // here our custom help for the `order` command\n  .action(function(args, options) {\n\n  })\n  // second command\n  .command(\'cancel\')\n  .help(\'my help for the cancel command\') // here our custom help for the `cancel` command\n  .action(function(args, options) {\n\n  })\n\nprog.parse(process.argv);\n```\n\n## Typo suggestions\n\nCaporal will automatically make suggestions for option typos.\n\n<p align="center">\n <img src="https://github.com/mattallty/Caporal.js/raw/master/assets/suggest.png" wdith="600">\n</p>\n\n\n## Shell auto-completion\n\nCaporal comes with an auto-completion feature out of the box for `bash`, `zsh`, and `fish`,\nthanks to [tabtab](https://github.com/mklabs/node-tabtab).\n\nFor this feature to work, you will have to:\n\n- Put your cli app in your `$PATH` (this is the case if your app is installed globally using `npm install -g <myapp>`)\n- Setup auto-completion for your shell, like bellow.\n\n#### If you are using bash\n\n```bash\n# For bash\nsource <(myapp completion bash)\n\n# or add it to your .bashrc to make it persist\necho "source <(myapp completion bash)" >> ~/.bashrc \\\n&& source ~/.bashrc\n```\n\n#### If you are using zsh\n\n```bash\n# For zsh\nsource <(myapp completion zsh)\n\n# or add it to your .zshrc to make it persist\necho "source <(myapp completion zsh)" >> ~/.zshrc \\\n&& source ~/.zshrc\n```\n\n#### If you are using fish\n\n```bash\n# For fish\nsource <(myapp completion fish)\n\n# or add it to your config.fish to make it persist\necho "source <(myapp completion fish)" >> ~/.config/fish/config.fish \\\n&& source ~/.config/fish/config.fish\n```\n\n### Basic auto-completion\n\nBy default, it will autocomplete *commands* and *option names*.\nAlso, *options* having an *Array validator* will be autocompleted.\n\n### Auto-completion setup example\n\n```javascript\n#!/usr/bin/env node\n\nconst prog = require(\'caporal\');\n\nprog\n  .version(\'1.0.0\')\n  // the "order" command\n  .command(\'order\', \'Order a pizza\')\n  .alias(\'give-it-to-me\')\n  // <kind> will be auto-magicaly autocompleted by providing the user with 3 choices\n  .argument(\'<kind>\', \'Kind of pizza\', ["margherita", "hawaiian", "fredo"])\n  .argument(\'<from-store>\', \'Which store to order from\')\n  // enable auto-completion for <from-store> argument using a sync function returning an array\n  .complete(function() {\n    return [\'store-1\', \'store-2\', \'store-3\', \'store-4\', \'store-5\'];\n  })\n\n  .argument(\'<account>\', \'Which account id to use\')\n  // enable auto-completion for <account> argument using a Promise\n  .complete(function() {\n    return Promise.resolve([\'account-1\', \'account-2\']);\n  })\n\n  .option(\'-n, --number <num>\', \'Number of pizza\', prog.INT, 1)\n  .option(\'-d, --discount <amount>\', \'Discount offer\', prog.FLOAT)\n  .option(\'-p, --pay-by <mean>\', \'Pay by option\')\n  // enable auto-completion for -p | --pay-by option using a Promise\n  .complete(function() {\n    return Promise.resolve([\'cash\', \'credit-card\']);\n  })\n\n  // -e | --extra will be auto-magicaly autocompleted by providing the user with 3 choices\n  .option(\'-e, --extra <ingredients>\', \'Add extra ingredients\', [\'pepperoni\', \'onion\', \'cheese\'])\n  .action(function(args, options, logger) {\n    logger.info("Command \'order\' called with:");\n    logger.info("arguments: %j", args);\n    logger.info("options: %j", options);\n  })\n\n  // the "return" command\n  .command(\'return\', \'Return an order\')\n  .argument(\'<order-id>\', \'Order id\')\n  // enable auto-completion for <order-id> argument using a Promise\n  .complete(function() {\n    return Promise.resolve([\'#82792\', \'#71727\', \'#526Z52\']);\n  })\n  .argument(\'<to-store>\', \'Store id\')\n  .option(\'--ask-change <other-kind-pizza>\', \'Ask for other kind of pizza\')\n  // enable auto-completion for --ask-change option using a Promise\n  .complete(function() {\n    return Promise.resolve(["margherita", "hawaiian", "fredo"]);\n  })\n  .option(\'--say-something <something>\', \'Say something to the manager\')\n  .action(function(args, options, logger) {\n    logger.info("Command \'return\' called with:");\n    logger.info("arguments: %j", args);\n    logger.info("options: %j", options);\n  });\n\nprog.parse(process.argv);\n```\n\n## API\n\n#### `require(\'caporal\')`\n\nReturns a `Program` instance.\n\n### Program API\n\n#### `.version(version) : Program`\n\nSet the version of your program. You may want to use your `package.json` version to fill it:\n\n```javascript\nconst myProgVersion = require(\'./package.json\').version;\nconst prog = require(\'caporal\');\nprog\n  .version(myProgVersion)\n// [...]\n\nprog.parse(process.argv);\n```\n\nYour program will then automaticaly handle `-V` and `--version` options:\n\n    matt@mb:~$ ./my-program --version\n    1.0.0\n\n#### `.help(text, options?) : Program`\n\nAdd a program-level help section.\n\nBy default the optional `options` parameter is:\n\n```js\n{\n    indent: true, // If `true` the text will be automatically indented\n    name: "MORE INFO" // The name of the section\n}\n```\n\n#### `.command(name, description) -> Command`\n\nSet up a new command with name and description. Multiple commands can be added to one program.\nReturns a {Command}.\n\n```javascript\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  // one command\n  .command(\'walk\', \'Make the player walk\')\n  .action((args, options, logger) => { logger.log("I\'m walking !")}) // you must attach an action for your command\n  // a second command\n  .command(\'run\', \'Make the player run\')\n  .action((args, options, logger) => { logger.log("I\'m running !")})\n  // a command may have multiple words\n  .command(\'cook pizza\', \'Make the player cook a pizza\')\n  .argument(\'<kind>\', \'Kind of pizza\')\n  .action((args, options, logger) => { logger.log("I\'m cooking a pizza !")})\n// [...]\n\nprog.parse(process.argv);\n```\n\n#### `.logger([logger]) -> Program | winston`\n\nGet or set the logger instance. Without argument, it returns the logger instance (*winston* by default).\nWith the *logger* argument, it sets a new logger.\n\n### Command API\n\n#### `.argument(synopsis, description, [validator, [defaultValue]]) -> Command`\n\nAdd an argument to the command. Can be called multiple times to add several arguments.\n\n* **synopsis** (*String*): something like `<my-required-arg>` or `[my-optional-arg]`\n* **description** (*String*): argument description\n* **validator** (*Caporal Flag | Function | Array | RegExp*): optional validator, see [Coercion and casting ](#coercion-and-casting-using-validators)\n* **defaultValue** (*): optional default value\n\n#### `.option(synopsis, description, [validator, [defaultValue, [required]]) -> Command`\n\nAdd an option to the command. Can be called multiple times to add several options.\n\n* **synopsis** (*String*): You can pass short or long notation here, or both. See examples.\n* **description** (*String*): option description\n* **validator** (*Caporal Flag | Function | Array | RegExp*): optional validator, see [Coercion and casting ](#coercion-and-casting-using-validators)\n* **defaultValue** (*): optional default value\n* **required** (*Bool*): Is the option itself required ? Default to `false`\n\n#### `.help(text, options?) -> Command`\n\nAdd a command-level help section.\n\nBy default the optional `options` parameter is:\n\n```js\n{\n    indent: true, // If `true` the text will be automatically indented\n    name: "" // The name of the section, by default this line won\'t be displayed\n}\n```\n\n#### `.action(action) -> Command`\n\nDefine the action, e.g a *Function*, for the current command.\n\nThe *action* callback will be called with 3 arguments:\n* *args* (Object): Passed arguments\n* *options* (Object): Passed options\n* *logger* (winston): Winston logger instance\n\n```javascript\n// sync action\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'walk\', \'Make the player walk\')\n  .action((args, options, logger) => {\n    logger.log("I\'m walking !")\n  });\n```\n\nYou can make your actions async by using Promises:\n\n```javascript\n// async action\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  .command(\'walk\', \'Make the player walk\')\n  .action((args, options, logger) => {\n    return new Promise(/* ... */);\n  });\n```\n\n#### `.alias(alias) -> Command`\n\nDefine an alias for the current command. A command can only have one alias.\n\n```javascript\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  // one command\n  .command(\'walk\', \'Make the player walk\')\n  .alias(\'w\')\n  .action((args, options, logger) => { logger.log("I\'m walking !")});\n\nprog.parse(process.argv);\n\n// ./myapp w\n// same as\n// ./myapp walk\n```\n\n#### `.complete(completer) -> Command`\n\nDefine an auto-completion handler for the latest argument or option added to the command.\n\n* **completer** (*Function*): The completer function has to return either an `Array` or a `Promise` which resolves to an `Array`.\n\n#### `.visible(visibility?) -> Boolean | Command`\n\nGet or set the visibility value of this command. By default it\'s `true`, if you set it to `false` it will be omitted from the help message.\n\n```javascript\nconst prog = require(\'caporal\');\nprog\n  .version(\'1.0.0\')\n  // one command\n  .command(\'walk\', \'Make the player walk\')\n  .visible ( false )\n\nprog.parse(process.argv);\n```\n\n## Credits\n\nCaporal is strongly inspired by [commander.js](https://github.com/tj/commander.js) and [Symfony Console](http://symfony.com/doc/current/components/console.html).\nCaporal makes use of the following npm packages:\n* [colorette](https://www.npmjs.com/package/colorette) for colors\n* [cli-table3](https://www.npmjs.com/package/cli-table3) for cli tables\n* [fast-levenshtein](https://www.npmjs.com/package/fast-levenshtein) for suggestions\n* [tabtab](https://www.npmjs.com/package/tabtab) for auto-completion\n* [minimist](https://www.npmjs.com/package/minimist) for argument parsing\n* [prettyjson](https://www.npmjs.com/package/prettyjson) to output json\n* [winston](https://www.npmjs.com/package/winston) for logging\n\n\n## License\n\nCopyright \xc2\xa9 Matthias ETIENNE\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \xe2\x80\x9cSoftware\xe2\x80\x9d), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nThe Software is provided \xe2\x80\x9cas is\xe2\x80\x9d, without warranty of any kind, express or implied, including but not limited to the warranties of merchantability, fitness for a particular purpose and noninfringement. In no event shall the authors or copyright holders be liable for any claim, damages or other liability, whether in an action of contract, tort or otherwise, arising from, out of or in connection with the software or the use or other dealings in the Software.\n'