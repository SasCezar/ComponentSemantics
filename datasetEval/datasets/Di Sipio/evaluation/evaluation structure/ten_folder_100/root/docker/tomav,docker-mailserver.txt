b'# docker-mailserver\n\n[![Build Status](https://travis-ci.org/tomav/docker-mailserver.svg?branch=master)](https://travis-ci.org/tomav/docker-mailserver) [![Docker Pulls](https://img.shields.io/docker/pulls/tvial/docker-mailserver.svg)](https://hub.docker.com/r/tvial/docker-mailserver/) [![Docker layers](https://images.microbadger.com/badges/image/tvial/docker-mailserver.svg)](https://microbadger.com/images/tvial/docker-mailserver) [![Github Stars](https://img.shields.io/github/stars/tomav/docker-mailserver.svg?label=github%20%E2%98%85)](https://github.com/tomav/docker-mailserver/) [![Github Stars](https://img.shields.io/github/contributors/tomav/docker-mailserver.svg)](https://github.com/tomav/docker-mailserver/) [![Github Forks](https://img.shields.io/github/forks/tomav/docker-mailserver.svg?label=github%20forks)](https://github.com/tomav/docker-mailserver/) [![Gitter](https://img.shields.io/gitter/room/tomav/docker-mailserver.svg)](https://gitter.im/tomav/docker-mailserver)\n\n\nA fullstack but simple mail server (smtp, imap, antispam, antivirus...).\nOnly configuration files, no SQL database. Keep it simple and versioned.\nEasy to deploy and upgrade.\n\nIncludes:\n\n- [Postfix](http://www.postfix.org) with smtp or ldap auth\n- [Dovecot](https://www.dovecot.org) for sasl, imap (and optional pop3) with ssl support, with ldap auth\n  - Dovecot is installed from the [Dovecot Community Repo](https://wiki2.dovecot.org/PrebuiltBinaries)\n- saslauthd with ldap auth\n- [Amavis](https://www.amavis.org/)\n- [Spamassasin](http://spamassassin.apache.org/) supporting custom rules\n- [ClamAV](https://www.clamav.net/) with automatic updates\n- [OpenDKIM](http://www.opendkim.org)\n- [OpenDMARC](https://github.com/trusteddomainproject/OpenDMARC)\n- [Fail2ban](https://www.fail2ban.org/wiki/index.php/Main_Page)\n- [Fetchmail](http://www.fetchmail.info/fetchmail-man.html)\n- [Postscreen](http://www.postfix.org/POSTSCREEN_README.html)\n- [Postgrey](https://postgrey.schweikert.ch/)\n- basic [Sieve support](https://github.com/tomav/docker-mailserver/wiki/Configure-Sieve-filters) using dovecot\n- [LetsEncrypt](https://letsencrypt.org/) and self-signed certificates\n- [Setup script](https://github.com/tomav/docker-mailserver/wiki/Setup-docker-mailserver-using-the-script-setup.sh) to easily configure and maintain your mailserver\n- persistent data and state (but think about backups!)\n- [Integration tests](https://travis-ci.org/tomav/docker-mailserver)\n- [Automated builds on docker hub](https://hub.docker.com/r/tvial/docker-mailserver/)\n\nWhy I created this image: [Simple mail server with Docker](http://tvi.al/simple-mail-server-with-docker/)\n\nBefore you open an issue, please have a look this `README`, the [Wiki](https://github.com/tomav/docker-mailserver/wiki/) and Postfix/Dovecot documentation.\n\n## Requirements\n\nRecommended:\n- 1 CPU\n- 1-2GB RAM\n- Swap enabled for the container\n\nMinimum:\n- 1 CPU\n- 512MB RAM\n\n**Note:** You\'ll need to deactivate some services like ClamAV to be able to run on a host with 512MB of RAM. Even with 1G RAM you may run into problems without swap, see [FAQ](https://github.com/tomav/docker-mailserver/wiki/FAQ-and-Tips).\n\n## Usage\n\n#### Get latest image\n\n    docker pull tvial/docker-mailserver:latest\n\n#### Get the tools\n\nDownload the docker-compose.yml, the .env and the setup.sh files:\n\n    curl -o setup.sh https://raw.githubusercontent.com/tomav/docker-mailserver/master/setup.sh; chmod a+x ./setup.sh\n\n    curl -o docker-compose.yml https://raw.githubusercontent.com/tomav/docker-mailserver/master/docker-compose.yml.dist\n\n    curl -o .env https://raw.githubusercontent.com/tomav/docker-mailserver/master/.env.dist\n    \n    curl -o env-mailserver https://raw.githubusercontent.com/tomav/docker-mailserver/master/env-mailserver.dist\n\n#### Create a docker-compose environment\n\n- Edit the files `.env` and `env-mailserver` to your liking:\n  - `.env` contains the configuration for docker-compose\n  - `env-mailserver` contains the configuration for the mailserver container\n  - These files supports only simple `VAR=VAL` lines (see [Documentation](https://docs.docker.com/compose/env-file/)).\n  - Don\'t quote your values.\n  - Variable substitution is *not* supported (e.g. `OVERRIDE_HOSTNAME=$HOSTNAME.$DOMAINNAME`).\n- Install [docker-compose](https://docs.docker.com/compose/) in the version `1.7` or higher.\n\n#### Start Container\n    docker-compose up -d mail\n\n#### Create your mail accounts\n\n    ./setup.sh email add <user@domain> [<password>]\n\n#### Generate DKIM keys\n\n    ./setup.sh config dkim\n\nNow the keys are generated, you can configure your DNS server by just pasting the content of `config/opendkim/keys/domain.tld/mail.txt` in your `domain.tld.hosts` zone.\n\n#### Restart and update the container\n\n    docker-compose down\n    docker pull tvial/docker-mailserver:latest\n    docker-compose up -d mail\n\nYou\'re done!\n\nAnd don\'t forget to have a look at the remaining functions of the `setup.sh` script\n\n#### SPF/Forwarding Problems\n\nIf you got any problems with SPF and/or forwarding mails, give [SRS](https://github.com/roehling/postsrsd/blob/master/README.md) a try. You enable SRS by setting `ENABLE_SRS=1`. See the variable description for further information.\n\n#### For informational purposes:\n\nYour config folder will be mounted in `/tmp/docker-mailserver/`. To understand how things work on boot, please have a look at [start-mailserver.sh](https://github.com/tomav/docker-mailserver/blob/master/target/start-mailserver.sh)\n\n`restart: always` ensures that the mail server container (and ELK container when using the mail server together with ELK stack) is automatically restarted by Docker in cases like a Docker service or host restart or container exit.\n\n#### Exposed ports\n* 25 receiving email from other mailservers\n* 465 SSL Client email submission\n* 587 TLS Client email submission\n* 143 StartTLS IMAP client\n* 993 TLS/SSL IMAP client\n* 110 POP3 client\n* 995 TLS/SSL POP3 client\n\n`Note: Port 25 is only for receiving email from other mailservers and not for submitting email. You need to use port 465 or 587 for this.`\n\n##### Examples with just the relevant environmental variables:\n\n```yaml\nversion: \'2\'\n\nservices:\n  mail:\n    image: tvial/docker-mailserver:latest\n    hostname: mail\n    domainname: domain.com\n    container_name: mail\n    ports:\n      - "25:25"\n      - "143:143"\n      - "587:587"\n      - "993:993"\n    volumes:\n      - maildata:/var/mail\n      - mailstate:/var/mail-state\n      - maillogs:/var/log/mail\n      - ./config/:/tmp/docker-mailserver/\n    environment:\n      - ENABLE_SPAMASSASSIN=1\n      - ENABLE_CLAMAV=1\n      - ENABLE_FAIL2BAN=1\n      - ENABLE_POSTGREY=1\n      - ONE_DIR=1\n      - DMS_DEBUG=0\n    cap_add:\n      - NET_ADMIN\n      - SYS_PTRACE\n\nvolumes:\n  maildata:\n    driver: local\n  mailstate:\n    driver: local\n  maillogs:\n    driver: local\n```\n\n__for ldap setup__:\n\n```yaml\nversion: \'2\'\n\nservices:\n  mail:\n    image: tvial/docker-mailserver:latest\n    hostname: mail\n    domainname: domain.com\n    container_name: mail\n    ports:\n      - "25:25"\n      - "143:143"\n      - "587:587"\n      - "993:993"\n    volumes:\n      - maildata:/var/mail\n      - mailstate:/var/mail-state\n      - maillogs:/var/log/mail\n      - ./config/:/tmp/docker-mailserver/\n    environment:\n      - ENABLE_SPAMASSASSIN=1\n      - ENABLE_CLAMAV=1\n      - ENABLE_FAIL2BAN=1\n      - ENABLE_POSTGREY=1\n      - ONE_DIR=1\n      - DMS_DEBUG=0\n      - ENABLE_LDAP=1\n      - LDAP_SERVER_HOST=ldap # your ldap container/IP/ServerName\n      - LDAP_SEARCH_BASE=ou=people,dc=localhost,dc=localdomain\n      - LDAP_BIND_DN=cn=admin,dc=localhost,dc=localdomain\n      - LDAP_BIND_PW=admin\n      - LDAP_QUERY_FILTER_USER=(&(mail=%s)(mailEnabled=TRUE))\n      - LDAP_QUERY_FILTER_GROUP=(&(mailGroupMember=%s)(mailEnabled=TRUE))\n      - LDAP_QUERY_FILTER_ALIAS=(|(&(mailAlias=%s)(objectClass=PostfixBookMailForward))(&(mailAlias=%s)(objectClass=PostfixBookMailAccount)(mailEnabled=TRUE)))\n      - LDAP_QUERY_FILTER_DOMAIN=(|(&(mail=*@%s)(objectClass=PostfixBookMailAccount)(mailEnabled=TRUE))(&(mailGroupMember=*@%s)(objectClass=PostfixBookMailAccount)(mailEnabled=TRUE))(&(mailalias=*@%s)(objectClass=PostfixBookMailForward)))\n      - DOVECOT_PASS_FILTER=(&(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))\n      - DOVECOT_USER_FILTER=(&(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))\n      - ENABLE_SASLAUTHD=1\n      - SASLAUTHD_MECHANISMS=ldap\n      - SASLAUTHD_LDAP_SERVER=ldap\n      - SASLAUTHD_LDAP_BIND_DN=cn=admin,dc=localhost,dc=localdomain\n      - SASLAUTHD_LDAP_PASSWORD=admin\n      - SASLAUTHD_LDAP_SEARCH_BASE=ou=people,dc=localhost,dc=localdomain\n      - POSTMASTER_ADDRESS=postmaster@localhost.localdomain\n      - POSTFIX_MESSAGE_SIZE_LIMIT=100000000\n    cap_add:\n      - NET_ADMIN\n      - SYS_PTRACE\n\nvolumes:\n  maildata:\n    driver: local\n  mailstate:\n    driver: local\n  maillogs:\n    driver: local\n```\n\n# Environment variables\n\nPlease check [how the container starts](https://github.com/tomav/docker-mailserver/blob/master/target/start-mailserver.sh) to understand what\'s expected. Also if an option doesn\'t work as documented here, check if you are running the latest image!\n\nValue in **bold** is the default value.\n\n## General\n\n##### DMS_DEBUG\n\n  - **0** => Debug disabled\n  - 1 => Enables debug on startup\n\n##### ENABLE_CLAMAV\n\n  - **0** => Clamav is disabled\n  - 1 => Clamav is enabled\n\n##### ONE_DIR\n\n  - **0** => state in default directories\n  - 1 => consolidate all states into a single directory (`/var/mail-state`) to allow persistence using docker volumes\n\n##### ENABLE_POP3\n\n  - **empty** => POP3 service disabled\n  - 1 => Enables POP3 service\n\n##### ENABLE_FAIL2BAN\n\n  - **0** => fail2ban service disabled\n  - 1 => Enables fail2ban service\n\nIf you enable Fail2Ban, don\'t forget to add the following lines to your `docker-compose.yml`:\n\n    cap_add:\n      - NET_ADMIN\n\nOtherwise, `iptables` won\'t be able to ban IPs.\n\n##### SMTP_ONLY\n\n  - **empty** => all daemons start\n  - 1 => only launch postfix smtp\n\n##### SSL_TYPE\n\n  - **empty** => SSL disabled\n  - letsencrypt => Enables Let\'s Encrypt certificates\n  - custom => Enables custom certificates\n  - manual => Let you manually specify locations of your SSL certificates for non-standard cases\n  - self-signed => Enables self-signed certificates\n  - _any other value_ => SSL required, settings by default\n\nPlease read [the SSL page in the wiki](https://github.com/tomav/docker-mailserver/wiki/Configure-SSL) for more information.\n\n##### TLS_LEVEL\n\n  - **empty** => modern\n  - modern => Enables TLSv1.2 and modern ciphers only. (default)\n  - intermediate => Enables TLSv1, TLSv1.1 and TLSv1.2 and broad compatibility ciphers.\n  - old => NOT implemented. If you really need it, then customize the TLS ciphers overriding postfix and dovecot settings [ wiki](https://github.com/tomav/docker-mailserver/wiki/\n\n##### SPOOF_PROTECTION\nConfigures the handling of creating mails with forged sender addresses.\n  - **empty** => Mail address spoofing allowed. Any logged in user may create email messages with a forged sender address. See also [Wikipedia](https://en.wikipedia.org/wiki/Email_spoofing)(not recommended, but default for backwards compatibility reasons)\n  - 1 => (recommended) Mail spoofing denied. Each user may only send with his own or his alias addresses. Addresses with [extension delimiters](http://www.postfix.org/postconf.5.html#recipient_delimiter) are not able to send messages.\n\n##### ENABLE_SRS\nEnables the Sender Rewriting Scheme. SRS is needed if your mail server acts as forwarder. See [postsrsd](https://github.com/roehling/postsrsd/blob/master/README.md#sender-rewriting-scheme-crash-course) for further explanation.\n  - **0** => Disabled\n  - 1 => Enabled\n\n##### PERMIT_DOCKER\n\nSet different options for mynetworks option (can be overwrite in postfix-main.cf)\n  - **empty** => localhost only\n  - host => Add docker host (ipv4 only)\n  - network => Add the docker default bridge network (172.16.0.0/12); **WARNING**: `docker-compose` might use others (e.g. 192.168.0.0/16) use `PERMIT_DOCKER=connected-networks` in this case\n  - connected-networks => Add all connected docker networks (ipv4 only)\n\n##### VIRUSMAILS_DELETE_DELAY\n\nSet how many days a virusmail will stay on the server before being deleted\n  - **empty** => 7 days\n\n\n##### ENABLE_POSTFIX_VIRTUAL_TRANSPORT\n\nThis Option is activating the Usage of POSTFIX_DAGENT to specify a ltmp client different from default dovecot socket.\n\n- **empty** => disabled\n- 1 => enabled\n\n##### POSTFIX_DAGENT\n\nEnabled by ENABLE_POSTFIX_VIRTUAL_TRANSPORT. Specify the final delivery of postfix\n\n- **empty**: fail\n- `lmtp:unix:private/dovecot-lmtp` (use socket)\n- `lmtps:inet:<host>:<port>` (secure lmtp with starttls, take a look at https://sys4.de/en/blog/2014/11/17/sicheres-lmtp-mit-starttls-in-dovecot/)\n- `lmtp:<kopano-host>:2003` (use kopano as mailstore)\n- etc.\n\n##### POSTFIX\\_MAILBOX\\_SIZE\\_LIMIT\n\nSet the mailbox size limit for all users. If set to zero, the size will be unlimited (default).\n\n- **empty** => 0 (no limit)\n\n##### POSTFIX\\_MESSAGE\\_SIZE\\_LIMIT\n\nSet the message size limit for all users. If set to zero, the size will be unlimited (not recommended!)\n\n- **empty** => 10240000 (~10 MB)\n\n##### ENABLE_MANAGESIEVE\n\n  - **empty** => Managesieve service disabled\n  - 1 => Enables Managesieve on port 4190\n\n##### OVERRIDE_HOSTNAME\n\n  - **empty** => uses the `hostname` command to get the mail server\'s canonical hostname\n  - => Specify a fully-qualified domainname to serve mail for.  This is used for many of the config features so if you can\'t set your hostname (e.g. you\'re in a container platform that doesn\'t let you) specify it in this environment variable.\n\n##### POSTMASTER_ADDRESS\n\n  - **empty** => postmaster@domain.com\n  - => Specify the postmaster address\n\n\n##### POSTSCREEN_ACTION\n\n  - **enforce** => Allow other tests to complete. Reject attempts to deliver mail with a 550 SMTP reply, and log the helo/sender/recipient information. Repeat this test the next time the client connects.\n  - drop => Drop the connection immediately with a 521 SMTP reply. Repeat this test the next time the client connects.\n  - ignore => Ignore the failure of this test. Allow other tests to complete. Repeat this test the next time the client connects. This option is useful for testing and collecting statistics without blocking mail.\n\n##### DOVECOT_MAILBOX_FORMAT\n\n  - **maildir** => uses very common Maildir format, one file contains one message\n  - sdbox => (experimental) uses Dovecot high-performance mailbox format, one file contains one message\n  - mdbox ==> (experimental) uses Dovecot high-performance mailbox format, multiple messages per file and multiple files per box\n\nThis option has been added in November 2019. Using other format than Maildir is considered as experimental in docker-mailserver and should only be used for testing purpose. For more details, please refer to [Dovecot Documentation](https://wiki2.dovecot.org/MailboxFormat).\n\n## Reports\n\n##### PFLOGSUMM_TRIGGER\n\n  Enables regular pflogsumm mail reports.\n  - **not set** => No report\n  - daily_cron => Daily report for the previous day\n  - logrotate => Full report based on the mail log when it is rotated\n\nThis is a new option. The old REPORT options are still supported for backwards compatibility.\nIf this is not set and reports are enabled with the old options, logrotate will be used.\n\n##### PFLOGSUMM_RECIPIENT\n\n  Recipient address for pflogsumm reports.\n  - **not set** => Use REPORT_RECIPIENT or POSTMASTER_ADDRESS\n  - => Specify the recipient address(es)\n\n##### PFLOGSUMM_SENDER\n\n  From address for pflogsumm reports.\n  - **not set** => Use REPORT_SENDER or POSTMASTER_ADDRESS\n  - => Specify the sender address\n\n##### LOGWATCH_INTERVAL\n\n  Interval for logwatch report.\n  - **none** => No report is generated\n  - daily => Send a daily report\n  - weekly => Send a report every week\n\n##### LOGWATCH_RECIPIENT\n\n  Recipient address for logwatch reports if they are enabled.\n  - **not set** => Use REPORT_RECIPIENT or POSTMASTER_ADDRESS\n  - => Specify the recipient address(es)\n\n##### REPORT_RECIPIENT (deprecated)\n\n  Enables a report being sent (created by pflogsumm) on a regular basis.\n  - **0** => Report emails are disabled unless enabled by other options\n  - 1 => Using POSTMASTER_ADDRESS as the recipient\n  - => Specify the recipient address\n\n##### REPORT_SENDER (deprecated)\n\n  Change the sending address for mail report\n  - **empty** => mailserver-report@hostname\n  - => Specify the report sender (From) address\n\n##### REPORT_INTERVAL (deprecated)\n\n  changes the interval in which logs are rotated and a report is being sent (deprecated).\n  - **daily** => Send a daily report\n  - weekly => Send a report every week\n  - monthly => Send a report every month\n\nNote: This variable used to control logrotate inside the container and sent the pflogsumm report when the logs were rotated.\nIt is still supported for backwards compatibility, but the new option LOGROTATE_INTERVAL has been added that only rotates\nthe logs. \n\n##### LOGROTATE_INTERVAL \n\n  Defines the interval in which the mail log is being rotated.\n  - **daily** => Rotate daily.\n  - weekly => Rotate weekly.\n  - monthly => Rotate monthly.\n\nNote that only the log inside the container is affected.\nThe full log output is still available via `docker logs mail` (or your respective container name).\nIf you want to control logrotation for the docker generated logfile see: [Docker Logging Drivers](https://docs.docker.com/config/containers/logging/configure/).\n\nAlso note that by default the logs are lost when the container is recycled. To keep the logs, mount a volume.\n\nFinally the logrotate interval **may** affect the period for generated reports. That is the case when the reports are triggered by log rotation.\n\n## Spamassassin\n\n##### ENABLE_SPAMASSASSIN\n\n  - **0** => Spamassassin is disabled\n  - 1 => Spamassassin is enabled\n\n##### SA_TAG\n\n  - **2.0** => add spam info headers if at, or above that level\n\nNote: this spamassassin setting needs `ENABLE_SPAMASSASSIN=1`\n\n##### SA_TAG2\n\n  - **6.31** => add \'spam detected\' headers at that level\n\nNote: this spamassassin setting needs `ENABLE_SPAMASSASSIN=1`\n\n##### SA_KILL\n\n  - **6.31** => triggers spam evasive actions\n\nNote: this spamassassin setting needs `ENABLE_SPAMASSASSIN=1`. By default, the mailserver is configured to quarantine spam emails. If emails are quarantined, they are compressed and stored in a location dependent on the ONE_DIR setting above. If `ONE_DIR=1` the location is /var/mail-state/lib-amavis/virusmails/. If `ONE_DIR=0` it is /var/lib/amavis/virusmails/. These paths are inside the docker container. To inhibit this behaviour and deliver spam emails, set this to a very high value e.g. 100.0.\n\n##### SA_SPAM_SUBJECT\n\n  - **\\*\\*\\*SPAM\\*\\*\\*** => add tag to subject if spam detected\n\nNote: this spamassassin setting needs `ENABLE_SPAMASSASSIN=1`\n\n## Fetchmail\n\n##### ENABLE_FETCHMAIL\n  - **0** => `fetchmail` disabled\n  - 1 => `fetchmail` enabled\n\n##### FETCHMAIL_POLL\n  - **300** => `fetchmail` The number of seconds for the interval\n\n## LDAP\n\n##### ENABLE_LDAP\n\n  - **empty** => LDAP authentification is disabled\n  - 1 => LDAP authentification is enabled\n  - NOTE:\n    - A second container for the ldap service is necessary (e.g. [docker-openldap](https://github.com/osixia/docker-openldap))\n    - For preparing the ldap server to use in combination with this container [this](http://acidx.net/wordpress/2014/06/installing-a-mailserver-with-postfix-dovecot-sasl-ldap-roundcube/) article may be helpful\n\n##### LDAP_START_TLS\n\n  - **empty** => no\n  - yes => LDAP over TLS enabled for Postfix\n\n##### LDAP_SERVER_HOST\n\n  - **empty** => mail.domain.com\n  - => Specify the dns-name/ip-address where the ldap-server\n  - NOTE: If you going to use the mailserver in combination with docker-compose you can set the service name here\n\n##### LDAP_SEARCH_BASE\n\n  - **empty** => ou=people,dc=domain,dc=com\n  - => e.g. LDAP_SEARCH_BASE=dc=mydomain,dc=local\n\n##### LDAP_BIND_DN\n\n  - **empty** => cn=admin,dc=domain,dc=com\n  - => take a look at examples of SASL_LDAP_BIND_DN\n\n##### LDAP_BIND_PW\n\n  - **empty** => admin\n  - => Specify the password to bind against ldap\n\n##### LDAP_QUERY_FILTER_USER\n\n  - e.g. `(&(mail=%s)(mailEnabled=TRUE))`\n  - => Specify how ldap should be asked for users\n\n##### LDAP_QUERY_FILTER_GROUP\n\n  - e.g. `(&(mailGroupMember=%s)(mailEnabled=TRUE))`\n  - => Specify how ldap should be asked for groups\n\n##### LDAP_QUERY_FILTER_ALIAS\n\n  - e.g. `(&(mailAlias=%s)(mailEnabled=TRUE))`\n  - => Specify how ldap should be asked for aliases\n\n##### LDAP_QUERY_FILTER_DOMAIN\n\n- e.g. `(&(|(mail=*@%s)(mailalias=*@%s)(mailGroupMember=*@%s))(mailEnabled=TRUE))`\n- => Specify how ldap should be asked for domains\n\n##### DOVECOT_TLS\n\n  - **empty** => no\n  - yes => LDAP over TLS enabled for Dovecot\n\n## Dovecot\n\nThe following variables overwrite the default values for ```/etc/dovecot/dovecot-ldap.conf.ext```.\n\n##### DOVECOT_USER_FILTER\n\n  - e.g. `(&(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))`\n\n##### DOVECOT_USER_ATTRS\n\n - e.g. `homeDirectory=home,qmailUID=uid,qmailGID=gid,mailMessageStore=mail`\n - => Specify the directory to dovecot attribute mapping that fits your directory structure.\n - Note: This is necessary for directories that do not use the [Postfix Book Schema](test/docker-openldap/bootstrap/schema/mmc/postfix-book.schema).\n - Note: The left-hand value is the directory attribute, the right hand value is the dovecot variable.\n - More details on the [Dovecot Wiki](https://wiki.dovecot.org/AuthDatabase/LDAP/Userdb)\n\n##### DOVECOT_PASS_FILTER\n\n  - e.g. `(&(objectClass=PostfixBookMailAccount)(uniqueIdentifier=%n))`\n\n##### DOVECOT_PASS_ATTRS\n\n- e.g. `uid=user,userPassword=password`\n- => Specify the directory to dovecot variable mapping that fits your directory structure.\n- Note: This is necessary for directories that do not use the [Postfix Book Schema](test/docker-openldap/bootstrap/schema/mmc/postfix-book.schema).\n- Note: The left-hand value is the directory attribute, the right hand value is the dovecot variable.\n- More details on the [Dovecot Wiki](https://wiki.dovecot.org/AuthDatabase/LDAP/PasswordLookups)\n\n## Postgrey\n\n##### ENABLE_POSTGREY\n\n  - **0** => `postgrey` is disabled\n  - 1 => `postgrey` is enabled\n\n##### POSTGREY_DELAY\n\n  - **300** => greylist for N seconds\n\nNote: This postgrey setting needs `ENABLE_POSTGREY=1`\n\n##### POSTGREY_MAX_AGE\n\n  - **35** => delete entries older than N days since the last time that they have been seen\n\nNote: This postgrey setting needs `ENABLE_POSTGREY=1`\n\n##### POSTGREY_AUTO_WHITELIST_CLIENTS\n\n  - **5** => whitelist host after N successful deliveries (N=0 to disable whitelisting)\n\nNote: This postgrey setting needs `ENABLE_POSTGREY=1`\n\n##### POSTGREY_TEXT\n\n  - **Delayed by postgrey** => response when a mail is greylisted\n\nNote: This postgrey setting needs `ENABLE_POSTGREY=1`\n\n## SASL Auth\n\n##### ENABLE_SASLAUTHD\n\n  - **0** => `saslauthd` is disabled\n  - 1 => `saslauthd` is enabled\n\n##### SASLAUTHD_MECHANISMS\n\n  - empty => pam\n  - `ldap` => authenticate against ldap server\n  - `shadow` => authenticate against local user db\n  - `mysql` => authenticate against mysql db\n  - `rimap` => authenticate against imap server\n  - NOTE: can be a list of mechanisms like pam ldap shadow\n\n##### SASLAUTHD_MECH_OPTIONS\n\n  - empty => None\n  - e.g. with SASLAUTHD_MECHANISMS rimap you need to specify the ip-address/servername of the imap server  ==> xxx.xxx.xxx.xxx\n\n##### SASLAUTHD_LDAP_SERVER\n\n  - empty => localhost\n\n##### SASLAUTHD_LDAP_SSL\n\n  - empty or 0 => `ldap://` will be used\n  - 1 => `ldaps://` will be used\n\n##### SASLAUTHD_LDAP_BIND_DN\n\n  - empty => anonymous bind\n  - specify an object with privileges to search the directory tree\n  - e.g. active directory: SASLAUTHD_LDAP_BIND_DN=cn=Administrator,cn=Users,dc=mydomain,dc=net\n  - e.g. openldap: SASLAUTHD_LDAP_BIND_DN=cn=admin,dc=mydomain,dc=net\n\n##### SASLAUTHD_LDAP_PASSWORD\n\n  - empty => anonymous bind\n\n##### SASLAUTHD_LDAP_SEARCH_BASE\n\n  - empty => Reverting to SASLAUTHD_MECHANISMS pam\n  - specify the search base\n\n##### SASLAUTHD_LDAP_FILTER\n\n  - empty => default filter `(&(uniqueIdentifier=%u)(mailEnabled=TRUE))`\n  - e.g. for active directory: `(&(sAMAccountName=%U)(objectClass=person))`\n  - e.g. for openldap: `(&(uid=%U)(objectClass=person))`\n\n##### SASL_PASSWD\n\n  - **empty** => No sasl_passwd will be created\n  - string => `/etc/postfix/sasl_passwd` will be created with the string as password\n\n## SRS (Sender Rewriting Scheme)\n\n##### SRS_EXCLUDE_DOMAINS\n\n  - **empty** => Envelope sender will be rewritten for all domains\n  - provide comma separated list of domains to exclude from rewriting\n\n##### SRS_SECRET\n\n  - **empty** => generated when the container is started for the first time\n  - provide a secret to use in base64\n  - you may specify multiple keys, comma separated. the first one is used for signing and the remaining will be used for verification. this is how you rotate and expire keys\n  - if you have a cluster/swarm make sure the same keys are on all nodes\n  - example command to generate a key: `dd if=/dev/urandom bs=24 count=1 2>/dev/null | base64`\n\n##### SRS_DOMAINNAME\n\n  - **empty** => Derived from OVERRIDE_HOSTNAME, DOMAINNAME, or the container\'s hostname\n  - Set this if auto-detection fails, isn\'t what you want, or you wish to have a separate container handle DSNs\n\n## Default Relay Host\n\n#### DEFAULT_RELAY_HOST\n\n  - **empty** => don\'t set default relayhost setting in main.cf\n  - default host and port to relay all mail through\n\n## Multi-domain Relay Hosts\n\n#### RELAY_HOST\n\n  - **empty** => don\'t configure relay host\n  - default host to relay mail through\n\n#### RELAY_PORT\n\n  - **empty** => 25\n  - default port to relay mail through\n\n#### RELAY_USER\n\n  - **empty** => no default\n  - default relay username (if no specific entry exists in postfix-sasl-password.cf)\n\n#### RELAY_PASSWORD\n\n  - **empty** => no default\n  - password for default relay user\n'