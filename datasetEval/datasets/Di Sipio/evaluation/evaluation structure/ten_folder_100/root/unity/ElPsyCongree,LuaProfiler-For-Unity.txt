b'## Lua Profiler For Unity\n<br/>\n\n[\xe4\xb8\xad\xe6\x96\x87\xe8\xaf\xb4\xe6\x98\x8e](#zh)\n\n<span id="en"></span>\n\n## Outline\n[Deploy and Install](#installe_en)</br>\n[Tutors](#turtor_en)</br>\n[Datas Descriptions](#data_en)</br>\n[Record mode](#record_en)</br>\n[DIFF two different periods of Lua variables](#diff_en)</br>\n[On-device Profiler](#device_en)</br>\n[Contact](#contact_en)</br>\n\n### Purpose\n**Unity + Lua** script is now most popular incremental update frameWork for mobile game in China,However, since there haven\'t been good tool to monitor the cpu and memory usage of lua vm, lots of developers have no idea to optimize their code,so there are many potential risks in lua codes.<br>\nthis tool is designed to support an **easy-to-use profiler** for Unity that help finding bottleneck and make your game more fast and stable.\n\n### Use renderings\n![](doc/use.gif)\n\n##\n\n<span id="installe_en"></span>\n### [Deploy and Install](#en)\nLua Profiler For Unity supports **XLua**\xe3\x80\x81**SLua**\xe3\x80\x81**ToLua** and also a remote profiler tool so it supports **Windows**\xe3\x80\x81**Android**\xe3\x80\x81**IOS** On-device Profiler.\n\n- You must open two Unity projects,one for game client ,one for editor server\n- Open **LuaProfiler** folder\n- Copy **LuaProfilerClient** folder to you game project content,if your C# Lua script is in **Plugins** folder,Copy **LuaProfilerClient** to **Plugins**.This Tool must make sure That code must in the same DLL which has C# lua codes.\n- Use **Unity5.6 or newer version** Unity version to open **LuaProfilerServer** as a Unity project\n- If your Unity version is below 5,call the following code before start the game.\n```\nMikuLuaProfiler.HookLuaSetup.OnStartGame();\n```\n\n### Theory\nIt use mono.ceil\'s IL inject feature(also use in XLua),inject the profiler code to game code\n\n## \n\n<span id="turtor_en"></span>\n### [Tutors](#en)\n\n#### Config your client\n\nOpen windows by **"Window->Lua Profiler Window"**, toggle profiler\'s feature and configure the server ip address.\n## \n![](doc/config_client.png)<br/>\n\nSelect the kind of code you want profiler,C# code color is green,and lua code color is blue.<br/>\n\n#### Open server\nAlso open windows by **"Window->Lua Profiler Window"**, then click **OpenService**,wait for client connects\n## \n![](doc/config_server.png)\n\n## \n![](doc/profiler.gif)\n## \n\n<span id="data_en"></span>\n### [Datas Descriptions](#en)\n\n| Name                    | Descriptions                                                                                              |\n| ----------------------- | -------------------------------------------------------------------------------------------------------   |\n| `Overview`              | function name                                                                                             |\n| `totalLuaMemory`        | The sum of all Lua GCs produced by this function If GC happens then the value will not be very accurate   |\n| `self`                  | The amount of GC produced by the function itself                                                          |\n| `totalMonoMemory`       | The sum of all Mono GCs produced by this function If GC happens then the value will not be very accurate  |\n| `self`                  | The amount of GC produced by the function itself                                                          |\n| `currentTime`           | The time it takes for the function to run in current frame                                                |\n| `averageTime`           | Count the average value of the time spent on the function                                                 |\n| `totalTime`             | All the time consumed by this function                                                                    |\n| `LuaGC`                 | Lua GC generated by the current frame                                                                     |\n| `MonoGC`                | Mono GC generated by the current frame                                                                    |\n| `totalCalls`            | The number of runs of this function after the game starts                                                 |\n| `Calls`                 | The number of executions of the current frame of the function                                             |\n\n#### Menu in Game\nPress `DEL` or touch `four fingers` in screen to show this menu,you can change ip to connect and show more details of profiler info</br>\n![](doc/menu.png)</br>\n\n\n#### Monitor registry\nProgrammers tend to forget to release Lua objects that are cached by C#.For example, when XLua calls LuaEnv.Dispose, it throws the exception "try to dispose a LuaEnv with C# callback!"<br/>\n\nThe reason is often caused by the following code\n```\nLuaTable tb = ...\nAction action = tb.rawget<Action>("action");\na();\ntb.Dispose(); //This line of code tends to forget to call\na= null;      //This line of code tends to forget to call\n```\nin Lua\n```\n// The lua table tends to forget to call dispose\nCS.UIBehaviour.luauiTable = {}\n// The callback tends to Unregister\nCS.UIButton.OnClick = function() print("test") end\n```\nThey can be released by C#\'s destructor, but because in C# is just an index, the memory footprint is small then C# will not be GC immediately, but the memory usage on Lua is very large.\nThis tool will provide real-time detection of the registry to help locate memory leaks quickly.<br/>\n\n![](doc/register.gif)<br/>\n\nYou can search history in record line<br/>\n![](doc/register_record.gif)<br/>\n\nAnd the `add`\xe3\x80\x81`remove` history<br/>\n![](doc/reg_history.png)<br/>\n\nYou can set index \'__name\' to the lua table,monitor will replace the table code by the value of this index\n```\nCS.UIBehaviour.loginUI = { __name = "LoginUI" }\n```\n\n#### Charts\n- Toggle `LuaChart` to open lua memory chart,line color is blue.\n- Toggle `MonoChart` to open mono memory chart,line color is green.\n- Toggle `FpsChart` to open fps chart,line color is orange.\n- Toggle `PssChart` to open pss chart,line color is red.\n- Toggle `PowerChart` to open power chart,line color is brown.\n\n<span id="record_en"></span>\n#### [Record mode](#en)\nClick **Record** button, when game connect to server, toggle **StartRecord** to start or stop record.\n\n##### Record button feature\n\n##\n![](doc/use3.gif)<br/>\n\n- drag slider to modify samples\n- click __\'<\'__ \xe3\x80\x81 __\'>\'__ to increase or discrease frames one by one\n- click __\'<<\'__ \xe3\x80\x81 __\'>>\'__ to fast locate the frames control by \n**Capture Lua GC**\xe3\x80\x81**Capture Mono GC**\xe3\x80\x81**Frame Count**\n- stop record and press left or right arrow keybord to increase or discrease frames one by one\n\n##\n![](doc/record.gif)\n\n<span id="diff_en"></span>\n### [DIFF two different periods of Lua variables](#en)\nChoose an appropriate time, such as you are ready to open a new UI after the configuration table is loaded, click **MarkLuaRecord** button\n##\n![](doc/mark.png)<br/>\nOpen the UI then close and unload the UI resources. Click **DiffRecord**. The tool will compare the difference between the Lua variable at the time of Mark and the variable when you click **DiffRecord**.\n\n##\n![](doc/diff.png)<br/>\nClicking the **ShowLog** button will save the type of the variable and the reference path after the file is saved. Note that _G represents the global table and _R represents the object referenced by C#.\n\n##\n![](doc/diff_log.png)<br/>\n**Destroy null values** for Unity has released resources, while Lua still references variables, this is the main resource leak to focus on.\n\n##\n![](doc/null_object.png)<br/>\n![](doc/search.png)<br/>\n\n<span id="device_en"></span>\n### [On-device Profiler](#en)\nSet macro **USE_LUA_PROFILER** to inject profiler code in you App.</br>\n\n#### Android\nset IP:127.0.0.1 port:2333. Connect your android phone with a USB cable.Execute the following instructions in cmd windows.</br>\n```\nadb reverse tcp:2333 tcp:2333\n```\nExecute your app.</br>\n\nIf you want to use **luac code or luajit bytecode** ,use **InjectLua.exe** in folder tools To inject the lua profiler code.</br>\n\n```\nInjectLua.exe "inpath" "outpath"\n```\n\n<span id="contact_en"></span>\n### [Contact](#en)\nIf you find any bug or have any suggests join the QQ group\xef\xbc\x9a[882425563](https://jq.qq.com/?_wv=1027&k=5QkOBSc) to contact us\n\n------\n<span id="zh"></span>\n\n## \xe5\xa4\xa7\xe7\xba\xb2\n[\xe9\x83\xa8\xe7\xbd\xb2\xe5\x92\x8c\xe5\xae\x89\xe8\xa3\x85](#installe_zh)</br>\n[\xe4\xbd\xbf\xe7\x94\xa8\xe6\x95\x99\xe7\xa8\x8b](#turtor_zh)</br>\n[\xe6\x95\xb0\xe6\x8d\xae\xe8\xaf\xb4\xe6\x98\x8e](#data_zh)</br>\n[\xe8\xae\xb0\xe5\xbd\x95\xe6\xa8\xa1\xe5\xbc\x8f](#record_zh)</br>\n[DIFF \xe4\xb8\xa4\xe4\xb8\xaa\xe4\xb8\x8d\xe5\x90\x8c\xe6\x97\xb6\xe6\x9c\x9f\xe7\x9a\x84Lua\xe5\x8f\x98\xe9\x87\x8f](#diff_zh)</br>\n[\xe8\x87\xaa\xe5\xae\x9a\xe4\xb9\x89Profiler\xe7\x82\xb9](#custom_zh)</br>\n[\xe7\x9c\x9f\xe6\x9c\xbaprofiler](#device_zh)</br>\n[\xe8\x81\x94\xe7\xb3\xbb\xe6\x88\x91\xe4\xbb\xac](#contact_zh)</br>\n\n### \xe7\x9b\xae\xe7\x9a\x84\n**Unity + Lua** \xe8\x84\x9a\xe6\x9c\xac\xe7\x8e\xb0\xe5\x9c\xa8\xe6\x98\xaf\xe4\xb8\xad\xe5\x9b\xbd\xe6\x9c\x80\xe6\xb5\x81\xe8\xa1\x8c\xe7\x9a\x84\xe5\xa2\x9e\xe9\x87\x8f\xe6\x9b\xb4\xe6\x96\xb0\xe6\xa1\x86\xe6\x9e\xb6\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf\xef\xbc\x8c\xe7\x94\xb1\xe4\xba\x8e\xe6\xb2\xa1\xe6\x9c\x89\xe5\xbe\x88\xe5\xa5\xbd\xe7\x9a\x84\xe5\xb7\xa5\xe5\x85\xb7\xe6\x9d\xa5\xe7\x9b\x91\xe6\x8e\xa7lua vm\xe7\x9a\x84cpu\xe5\x92\x8c\xe5\x86\x85\xe5\xad\x98\xe4\xbd\xbf\xe7\x94\xa8\xe6\x83\x85\xe5\x86\xb5\xef\xbc\x8c\xe5\xbe\x88\xe5\xa4\x9a\xe5\xbc\x80\xe5\x8f\x91\xe4\xba\xba\xe5\x91\x98\xe9\x83\xbd\xe4\xb8\x8d\xe7\x9f\xa5\xe9\x81\x93\xe5\xa6\x82\xe4\xbd\x95\xe4\xbc\x98\xe5\x8c\x96\xe4\xbb\x96\xe4\xbb\xac\xe7\x9a\x84\xe4\xbb\xa3\xe7\xa0\x81\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe5\x9c\xa8lua\xe4\xbb\xa3\xe7\xa0\x81\xe4\xb8\xad\xe5\xad\x98\xe5\x9c\xa8\xe8\xae\xb8\xe5\xa4\x9a\xe6\xbd\x9c\xe5\x9c\xa8\xe7\x9a\x84\xe9\xa3\x8e\xe9\x99\xa9\xe3\x80\x82\n\xe6\xad\xa4\xe5\xb7\xa5\xe5\x85\xb7\xe6\x97\xa8\xe7\xbb\x99Unity \xe6\x8f\x90\xe4\xbe\x9b\xe4\xb8\x80\xe4\xb8\xaa\xe6\x98\x93\xe4\xba\x8e\xe4\xbd\xbf\xe7\x94\xa8\xe7\x9a\x84lua\xe6\x80\xa7\xe8\x83\xbd\xe5\x88\x86\xe6\x9e\x90\xe5\x99\xa8\xe7\x94\xa8\xe4\xba\x8e\xe6\x9f\xa5\xe6\x89\xbe\xe4\xbb\xa3\xe7\xa0\x81\xe4\xb8\xad\xe7\x9a\x84\xe6\x80\xa7\xe8\x83\xbd\xe7\x93\xb6\xe9\xa2\x88\xe5\xb9\xb6\xe4\xbd\xbf\xe6\x82\xa8\xe7\x9a\x84\xe6\xb8\xb8\xe6\x88\x8f\xe6\x9b\xb4\xe5\xbf\xab\xe9\x80\x9f\xe3\x80\x81\xe7\xa8\xb3\xe5\xae\x9a\xe3\x80\x82\n\n### \xe4\xbd\xbf\xe7\x94\xa8\xe7\xa4\xba\xe6\x84\x8f\xe5\x9b\xbe\n![](doc/use.gif)\n\n##\n\n<span id="installe_zh"></span>\n### [\xe9\x83\xa8\xe7\xbd\xb2\xe5\x92\x8c\xe5\xae\x89\xe8\xa3\x85](#zh)\nLua Profiler For Unity\xe6\x94\xaf\xe6\x8c\x81 **XLua**\xe3\x80\x81**SLua**\xe3\x80\x81**ToLua** \xef\xbc\x8c\xe6\x9c\xac\xe5\xb7\xa5\xe5\x85\xb7\xe6\x98\xaf\xe5\x9f\xba\xe4\xba\x8e\xe8\xbf\x9c\xe7\xa8\x8bSocket\xe7\x9a\x84Profiler\xe5\xb7\xa5\xe5\x85\xb7\xef\xbc\x8c\xe5\x9b\xa0\xe6\xad\xa4\xe5\xae\x83\xe6\x94\xaf\xe6\x8c\x81Android\xef\xbc\x8cIOS \xe7\x9a\x84\xe7\x9c\x9f\xe6\x9c\xba Profiler\xe3\x80\x82\n\n- \xe6\x82\xa8\xe5\xbf\x85\xe9\xa1\xbb\xe6\x89\x93\xe5\xbc\x80\xe4\xb8\xa4\xe4\xb8\xaaUnity\xe9\xa1\xb9\xe7\x9b\xae\xef\xbc\x8c\xe4\xb8\x80\xe4\xb8\xaa\xe6\x94\xbe\xe8\xbf\x9b\xe6\xb8\xb8\xe6\x88\x8f\xe5\xae\xa2\xe6\x88\xb7\xe7\xab\xaf\xef\xbc\x8c\xe4\xb8\x80\xe4\xb8\xaa\xe7\x94\xa8\xe4\xba\x8e\xe5\xb1\x95\xe7\xa4\xba\xe6\x95\xb0\xe6\x8d\xae\n- \xe6\x89\x93\xe5\xbc\x80 **LuaProfiler** \xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9\n- \xe5\xb0\x86 **LuaProfilerClient** \xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9\xe5\xa4\x8d\xe5\x88\xb6\xe5\x88\xb0\xe6\xb8\xb8\xe6\x88\x8f\xe9\xa1\xb9\xe7\x9b\xae\xe5\x86\x85\xe5\xae\xb9\xef\xbc\x8c\xe5\xa6\x82\xe6\x9e\x9c\xe6\x82\xa8\xe7\x9a\x84C\xef\xbc\x83Lua\xe8\x84\x9a\xe6\x9c\xac\xe4\xbd\x8d\xe4\xba\x8ePlugins\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9\xe4\xb8\xad\xef\xbc\x8c\xe5\x88\x99\xe5\xb0\x86 **LuaProfilerClient** \xe5\xa4\x8d\xe5\x88\xb6\xe5\x88\xb0\xe6\x8f\x92\xe4\xbb\xb6\xe3\x80\x82\xe6\xad\xa4\xe5\xb7\xa5\xe5\x85\xb7\xe5\xbf\x85\xe9\xa1\xbb\xe7\xa1\xae\xe4\xbf\x9d\xe8\xaf\xa5\xe4\xbb\xa3\xe7\xa0\x81\xe5\xbf\x85\xe9\xa1\xbb\xe4\xbd\x8d\xe4\xba\x8e\xe5\x85\xb7\xe6\x9c\x89C\xef\xbc\x83lua\xe4\xbb\xa3\xe7\xa0\x81\xe7\x9a\x84\xe5\x90\x8c\xe4\xb8\x80DLL\xe4\xb8\xad\xe3\x80\x82\n- \xe4\xbd\xbf\xe7\x94\xa8 **Unity5.6 or newer version** Unity\xe7\x89\x88\xe6\x9c\xac\xe5\xb0\x86 **LuaProfilerServer** \xe4\xbd\x9c\xe4\xb8\xbaUnity\xe9\xa1\xb9\xe7\x9b\xae\xe6\x89\x93\xe5\xbc\x80\n- \xe5\xa6\x82\xe6\x9e\x9cUnity\xe7\x89\x88\xe6\x9c\xac\xe4\xbd\x8e\xe4\xba\x8e5\xef\xbc\x8c\xe8\xaf\xb7\xe5\x9c\xa8\xe5\xbc\x80\xe5\xa7\x8b\xe6\xb8\xb8\xe6\x88\x8f\xe5\x89\x8d\xe8\xb0\x83\xe7\x94\xa8\xe4\xbb\xa5\xe4\xb8\x8b\xe4\xbb\xa3\xe7\xa0\x81\xe3\x80\x82\n```\nMikuLuaProfiler.HookLuaSetup.OnStartGame();\n```\n\xe6\xb3\xa8\xe6\x84\x8f\xef\xbc\x81\xef\xbc\x81\xef\xbc\x81 \xe4\xb8\x8d\xe8\xa6\x81\xe5\x9c\xa8 static\xe5\x8f\x98\xe9\x87\x8f\xe5\xa3\xb0\xe6\x98\x8e\xe9\x87\x8c\xe9\x9d\xa2 \xe5\x90\xaf\xe5\x8a\xa8lua\xe6\xb5\x81\xe7\xa8\x8b\xef\xbc\x88\xe6\xaf\x94\xe5\xa6\x82xlua\xe7\x9a\x84demo\xef\xbc\x89\xef\xbc\x8c\xe8\xaf\xb7\xe5\x9c\xa8Awake\xe6\x88\x96\xe8\x80\x85Start\xe9\x87\x8c\xe9\x9d\xa2\xe8\xbf\x9b\xe8\xa1\x8c\xe8\xb0\x83\xe7\x94\xa8\xe3\x80\x82\n\n\n### \xe7\x90\x86\xe8\xae\xba\n\xe5\xae\x83\xe4\xbd\xbf\xe7\x94\xa8mono.ceil\xe7\x9a\x84IL\xe6\xb3\xa8\xe5\x85\xa5\xe5\x8a\x9f\xe8\x83\xbd\xef\xbc\x88\xe4\xb9\x9f\xe7\x94\xa8\xe4\xba\x8eXLua\xef\xbc\x89\xef\xbc\x8c\xe5\xb0\x86profiler\xe4\xbb\xa3\xe7\xa0\x81\xe6\xb3\xa8\xe5\x85\xa5\xe6\xb8\xb8\xe6\x88\x8f\xe4\xbb\xa3\xe7\xa0\x81\n\n## \n\n<span id="turtor_zh"></span>\n### [\xe4\xbd\xbf\xe7\x94\xa8\xe6\x95\x99\xe7\xa8\x8b](#zh)\n\n#### \xe9\x85\x8d\xe7\xbd\xae\xe5\xae\xa2\xe6\x88\xb7\xe7\xab\xaf\n\n\xe9\x80\x9a\xe8\xbf\x87**"Window->Lua Profiler Window"**\xe6\x89\x93\xe5\xbc\x80\xe8\xae\xbe\xe7\xbd\xae\xe7\xaa\x97\xe5\x8f\xa3\n## \n![](doc/config_client.png)<br/>\n\n\xe9\x80\x89\xe6\x8b\xa9\xe6\x83\xb3\xe8\xa6\x81\xe5\x88\x86\xe6\x9e\x90\xe5\x99\xa8\xe7\x9a\x84\xe4\xbb\xa3\xe7\xa0\x81\xe7\xb1\xbb\xe5\x9e\x8b\xef\xbc\x8cC\xef\xbc\x83\xe4\xbb\xa3\xe7\xa0\x81\xe9\xa2\x9c\xe8\x89\xb2\xe4\xb8\xba\xe7\xbb\xbf\xe8\x89\xb2\xef\xbc\x8clua\xe4\xbb\xa3\xe7\xa0\x81\xe9\xa2\x9c\xe8\x89\xb2\xe4\xb8\xba\xe8\x93\x9d\xe8\x89\xb2\xe3\x80\x82<br/>\n\n#### \xe6\x89\x93\xe5\xbc\x80\xe5\xb1\x95\xe7\xa4\xbaEditor\xe7\x9a\x84\xe7\x9b\x91\xe5\x90\xac\xe7\xab\xaf\xe5\x8f\xa3\n\xe5\x90\x8c\xe7\x90\x86\xe5\x8f\xaf\xe4\xbb\xa5\xe9\x80\x9a\xe8\xbf\x87 **Window->Lua Profiler Window**\xe6\x89\x93\xe5\xbc\x80\xe7\xaa\x97\xe5\x8f\xa3\xef\xbc\x8c\xe7\x84\xb6\xe5\x90\x8e\xe5\x8d\x95\xe5\x87\xbb **OpenService**\xef\xbc\x8c\xe7\xad\x89\xe5\xbe\x85\xe5\xae\xa2\xe6\x88\xb7\xe7\xab\xaf\xe8\xbf\x9e\xe6\x8e\xa5\n## \n![](doc/config_server.png)\n\n## \n![](doc/profiler.gif)\n## \n\n<span id="data_zh"></span>\n### [\xe6\x95\xb0\xe6\x8d\xae\xe8\xaf\xb4\xe6\x98\x8e](#zh)\n\n| Name                    | Descriptions                                                                                              |\n| ----------------------- | -------------------------------------------------------------------------------------------------------   |\n| `Overview`              | \xe5\x87\xbd\xe6\x95\xb0\xe5\x90\x8d\xe7\xa7\xb0                                                                                                  |\n| `totalLuaMemory`        | \xe6\xad\xa4\xe5\x87\xbd\xe6\x95\xb0\xe7\x94\x9f\xe6\x88\x90\xe7\x9a\x84\xe6\x89\x80\xe6\x9c\x89Lua GC\xe7\x9a\x84\xe6\x80\xbb\xe5\x92\x8c                                                                              |\n| `self`                  | \xe5\x87\xbd\xe6\x95\xb0\xe6\x9c\xac\xe8\xba\xab\xe4\xba\xa7\xe7\x94\x9f\xe7\x9a\x84GC\xe9\x87\x8f                                                                                        |\n| `totalMonoMemory`       | \xe6\xad\xa4\xe5\x87\xbd\xe6\x95\xb0\xe7\x94\x9f\xe6\x88\x90\xe7\x9a\x84\xe6\x89\x80\xe6\x9c\x89Mono GC\xe7\x9a\x84\xe6\x80\xbb\xe5\x92\x8c                                                                             |\n| `self`                  | \xe5\x87\xbd\xe6\x95\xb0\xe6\x9c\xac\xe8\xba\xab\xe4\xba\xa7\xe7\x94\x9f\xe7\x9a\x84GC\xe9\x87\x8f                                                                                        |\n| `currentTime`           | \xe5\x87\xbd\xe6\x95\xb0\xe5\x9c\xa8\xe5\xbd\x93\xe5\x89\x8d\xe5\xb8\xa7\xe4\xb8\xad\xe8\xbf\x90\xe8\xa1\x8c\xe6\x89\x80\xe9\x9c\x80\xe7\x9a\x84\xe6\x97\xb6\xe9\x97\xb4                                                                              |\n| `averageTime`           | \xe8\xae\xa1\xe7\xae\x97\xe5\x9c\xa8\xe5\x87\xbd\xe6\x95\xb0\xe4\xb8\x8a\xe8\x8a\xb1\xe8\xb4\xb9\xe7\x9a\x84\xe6\x97\xb6\xe9\x97\xb4\xe7\x9a\x84\xe5\xb9\xb3\xe5\x9d\x87\xe5\x80\xbc                                                                            |\n| `totalTime`             | \xe6\xad\xa4\xe5\x8a\x9f\xe8\x83\xbd\xe6\xb6\x88\xe8\x80\x97\xe7\x9a\x84\xe6\x89\x80\xe6\x9c\x89\xe6\x97\xb6\xe9\x97\xb4                                                                                      |\n| `LuaGC`                 | \xe7\x94\xb1\xe5\xbd\x93\xe5\x89\x8d\xe5\xb8\xa7\xe7\x94\x9f\xe6\x88\x90\xe7\x9a\x84Lua GC                                                                                      |\n| `MonoGC`                | \xe7\x94\xb1\xe5\xbd\x93\xe5\x89\x8d\xe5\xb8\xa7\xe7\x94\x9f\xe6\x88\x90\xe7\x9a\x84Mono GC                                                                                     |\n| `totalCalls`            | \xe6\xb8\xb8\xe6\x88\x8f\xe5\xbc\x80\xe5\xa7\x8b\xe5\x90\x8e\xe6\xad\xa4\xe5\x8a\x9f\xe8\x83\xbd\xe7\x9a\x84\xe8\xbf\x90\xe8\xa1\x8c\xe6\xac\xa1\xe6\x95\xb0                                                                                |\n| `Calls`                 | \xe5\x87\xbd\xe6\x95\xb0\xe5\xbd\x93\xe5\x89\x8d\xe5\xb8\xa7\xe7\x9a\x84\xe6\x89\xa7\xe8\xa1\x8c\xe6\xac\xa1\xe6\x95\xb0                                                                                      |\n\n#### \xe6\xb8\xb8\xe6\x88\x8f\xe4\xb8\xad\xe7\x9a\x84\xe8\x8f\x9c\xe5\x8d\x95\n\xe6\x8c\x89 `DEL` \xe6\x88\x96 \xe5\x9b\x9b\xe6\x89\x8b\xe6\x8c\x87\xe8\xa7\xa6\xe7\xa2\xb0\xe5\xb1\x8f\xe5\xb9\x95 \xe4\xbb\xa5\xe6\x98\xbe\xe7\xa4\xba\xe6\xad\xa4\xe8\x8f\x9c\xe5\x8d\x95\xef\xbc\x8c\xe6\x82\xa8\xe5\x8f\xaf\xe4\xbb\xa5\xe5\x9c\xa8\xe6\xb8\xb8\xe6\x88\x8f\xe4\xb8\xad\xe9\x9a\x8f\xe6\x97\xb6\xe4\xb8\xad\xe6\x96\xad\xe6\x88\x96\xe8\x80\x85\xe9\x87\x8d\xe5\x90\xaf\xe8\xbf\x9e\xe6\x8e\xa5 \xe4\xbb\xa5\xe5\x8f\x8a\xe6\x9b\xb4\xe6\x8d\xa2IP\xe5\x9c\xb0\xe5\x9d\x80</br>\n![](doc/menu.png)</br>\n\n\n#### \xe7\x9b\x91\xe6\x8e\xa7\xe6\xb3\xa8\xe5\x86\x8c\xe8\xa1\xa8\n\xe7\xa8\x8b\xe5\xba\x8f\xe5\x91\x98\xe5\xbe\x80\xe5\xbe\x80\xe5\xbf\x98\xe8\xae\xb0\xe9\x87\x8a\xe6\x94\xbe\xe7\x94\xb1C\xef\xbc\x83\xe7\xbc\x93\xe5\xad\x98\xe7\x9a\x84Lua\xe5\xaf\xb9\xe8\xb1\xa1\xe3\x80\x82\xe4\xbe\x8b\xe5\xa6\x82\xef\xbc\x8c\xe5\xbd\x93XLua\xe8\xb0\x83\xe7\x94\xa8LuaEnv.Dispose\xe6\x97\xb6\xef\xbc\x8c\xe5\xae\x83\xe4\xbc\x9a\xe6\x8a\x9b\xe5\x87\xba\xe5\xbc\x82\xe5\xb8\xb8 "try to dispose a LuaEnv with C# callback!"<br/>\n\n\xe5\x8e\x9f\xe5\x9b\xa0\xe9\x80\x9a\xe5\xb8\xb8\xe6\x98\xaf\xe7\x94\xb1\xe4\xbb\xa5\xe4\xb8\x8b\xe4\xbb\xa3\xe7\xa0\x81\xe5\xbc\x95\xe8\xb5\xb7\xe7\x9a\x84\n```\nLuaTable tb = ...\nAction action = tb.rawget<Action>("action");\na();\ntb.Dispose(); // \xe5\xbf\x98\xe8\xae\xb0Dipose\xe4\xba\x86\na= null;      //\xe5\xbf\x98\xe8\xae\xb0\xe7\xbd\xae\xe7\xa9\xba\xe5\x8f\x98\xe9\x87\x8f\xe4\xba\x86\n```\n\xe5\x9c\xa8Lua\n```\n// \xe5\xbf\x98\xe8\xae\xb0\xe7\xbd\xae\xe7\xa9\xba\xe5\x8f\x98\xe9\x87\x8f\xe4\xba\x86\nCS.UIBehaviour.luauiTable = {}\n// \xe5\xbf\x98\xe8\xae\xb0\xe5\x8f\x96\xe6\xb6\x88\xe6\xb3\xa8\xe5\x86\x8c\xe5\x87\xbd\xe6\x95\xb0\xe4\xba\x86\nCS.UIButton.OnClick = function() print("test") end\n```\n\xe5\xae\x83\xe4\xbb\xac\xe5\x8f\xaf\xe4\xbb\xa5\xe8\xa2\xabC\xef\xbc\x83\xe7\x9a\x84\xe6\x9e\x90\xe6\x9e\x84\xe5\x87\xbd\xe6\x95\xb0\xe9\x87\x8a\xe6\x94\xbe\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf\xe5\x9b\xa0\xe4\xb8\xba\xe5\x9c\xa8C\xef\xbc\x83\xe4\xb8\xad\xe5\x8f\xaa\xe6\x98\xaf\xe4\xb8\x80\xe4\xb8\xaa\xe7\xb4\xa2\xe5\xbc\x95\xef\xbc\x8c\xe5\x86\x85\xe5\xad\x98\xe5\x8d\xa0\xe7\x94\xa8\xe5\xbe\x88\xe5\xb0\x8f\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5C\xef\xbc\x83\xe4\xb8\x8d\xe4\xbc\x9a\xe7\xab\x8b\xe5\x8d\xb3\xe6\x88\x90\xe4\xb8\xbaGC\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xafLua\xe4\xb8\x8a\xe7\x9a\x84\xe5\x86\x85\xe5\xad\x98\xe4\xbd\xbf\xe7\x94\xa8\xe9\x87\x8f\xe9\x9d\x9e\xe5\xb8\xb8\xe5\xa4\xa7\xe3\x80\x82\xe6\xad\xa4\xe5\xb7\xa5\xe5\x85\xb7\xe5\xb0\x86\xe6\x8f\x90\xe4\xbe\x9b\xe5\xaf\xb9\xe6\xb3\xa8\xe5\x86\x8c\xe8\xa1\xa8\xe7\x9a\x84\xe5\xae\x9e\xe6\x97\xb6\xe6\xa3\x80\xe6\xb5\x8b\xef\xbc\x8c\xe4\xbb\xa5\xe5\xb8\xae\xe5\x8a\xa9\xe5\xbf\xab\xe9\x80\x9f\xe5\xae\x9a\xe4\xbd\x8d\xe5\x86\x85\xe5\xad\x98\xe6\xb3\x84\xe6\xbc\x8f\xe3\x80\x82<br/>\n\n![](doc/register.gif)<br/>\n\n\xe6\x82\xa8\xe5\x8f\xaf\xe4\xbb\xa5\xe5\x9c\xa8\xe8\xae\xb0\xe5\xbd\x95\xe8\xa1\x8c\xe4\xb8\xad\xe6\x90\x9c\xe7\xb4\xa2\xe5\x8e\x86\xe5\x8f\xb2\xe8\xae\xb0\xe5\xbd\x95<br/>\n![](doc/register_record.gif)<br/>\n\n\xe4\xbb\xa5\xe5\x8f\x8a `add`\xe3\x80\x81`remove` \xe7\x9a\x84\xe5\x8f\x98\xe5\x8c\x96\xe5\x8e\x86\xe5\x8f\xb2<br/>\n![](doc/reg_history.png)<br/>\n\n\xe6\x82\xa8\xe5\x8f\xaf\xe4\xbb\xa5\xe5\xb0\x86\xe7\xb4\xa2\xe5\xbc\x95\'__name\'\xe8\xae\xbe\xe7\xbd\xae\xe4\xb8\xbalua\xe8\xa1\xa8\xef\xbc\x8cmonitor\xe5\xb0\x86\xe4\xbd\xbf\xe7\x94\xa8\xe6\xad\xa4\xe7\xb4\xa2\xe5\xbc\x95\xe7\x9a\x84\xe5\x80\xbc\xe6\x9b\xbf\xe6\x8d\xa2\xe8\xa1\xa8\xe4\xbb\xa3\xe7\xa0\x81\n```\nCS.UIBehaviour.loginUI = { __name = "LoginUI" }\n```\n\n#### \xe5\x9b\xbe\xe8\xa1\xa8\n- \xe7\x82\xb9\xe5\x87\xbb `LuaChart` \xe6\x89\x93\xe5\xbc\x80lua\xe5\x86\x85\xe5\xad\x98\xe5\x9b\xbe\xe8\xa1\xa8\xef\xbc\x8c\xe7\xba\xbf\xe6\x9d\xa1\xe9\xa2\x9c\xe8\x89\xb2\xe4\xb8\xba\xe8\x93\x9d\xe8\x89\xb2\xe3\x80\x82\n- \xe7\x82\xb9\xe5\x87\xbb `MonoChart` \xe6\x89\x93\xe5\xbc\x80\xe5\x8d\x95\xe5\xa3\xb0\xe9\x81\x93\xe5\x86\x85\xe5\xad\x98\xe5\x9b\xbe\xe8\xa1\xa8\xef\xbc\x8c\xe7\xba\xbf\xe6\x9d\xa1\xe9\xa2\x9c\xe8\x89\xb2\xe4\xb8\xba\xe7\xbb\xbf\xe8\x89\xb2\xe3\x80\x82\n- \xe7\x82\xb9\xe5\x87\xbb `FpsChart` \xe6\x89\x93\xe5\xbc\x80fps\xe5\x9b\xbe\xe8\xa1\xa8\xef\xbc\x8c\xe7\xba\xbf\xe6\x9d\xa1\xe9\xa2\x9c\xe8\x89\xb2\xe4\xb8\xba\xe6\xa9\x99\xe8\x89\xb2\xe3\x80\x82\n- \xe7\x82\xb9\xe5\x87\xbb `PssChart` \xe6\x89\x93\xe5\xbc\x80pss\xe5\x9b\xbe\xe8\xa1\xa8\xef\xbc\x8c\xe7\xba\xbf\xe6\x9d\xa1\xe9\xa2\x9c\xe8\x89\xb2\xe4\xb8\xba\xe7\xba\xa2\xe8\x89\xb2\xe3\x80\x82\n- \xe7\x82\xb9\xe5\x87\xbb `PowerChart` \xe6\x89\x93\xe5\xbc\x80\xe7\x94\xb5\xe9\x87\x8f\xe5\x9b\xbe\xe8\xa1\xa8\xef\xbc\x8c\xe7\xba\xbf\xe6\x9d\xa1\xe9\xa2\x9c\xe8\x89\xb2\xe4\xb8\xba\xe6\xa3\x95\xe8\x89\xb2\xe3\x80\x82\n\n<span id="record_zh"></span>\n#### [\xe8\xae\xb0\xe5\xbd\x95\xe6\xa8\xa1\xe5\xbc\x8f](#zh)\n\xe5\x8d\x95\xe5\x87\xbb **Record** \xe6\x8c\x89\xe9\x92\xae\xef\xbc\x8c\xe5\xbd\x93\xe6\xb8\xb8\xe6\x88\x8f\xe8\xbf\x9e\xe6\x8e\xa5\xe5\x88\xb0\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\xe6\x97\xb6\xef\xbc\x8c\xe5\x88\x87\xe6\x8d\xa2 **StartRecord** \xe4\xbb\xa5\xe5\xbc\x80\xe5\xa7\x8b\xe6\x88\x96\xe5\x81\x9c\xe6\xad\xa2\xe5\xbd\x95\xe5\x88\xb6\xe3\x80\x82\n\n##\n![](doc/use3.gif)<br/>\n\n- \xe6\x8b\x96\xe5\x8a\xa8\xe6\xbb\x91\xe5\x9d\x97\xe4\xbb\xa5\xe4\xbf\xae\xe6\x94\xb9\xe6\xa0\xb7\xe6\x9c\xac\n- \xe5\x8d\x95\xe5\x87\xbb __\'<\'__ \xe3\x80\x81 __\'>\'__ \xe9\x80\x90\xe4\xb8\xaa\xe5\xa2\x9e\xe5\x8a\xa0\xe6\x88\x96\xe5\x87\x8f\xe5\xb0\x91\xe5\xb8\xa7\n- \xe5\x8d\x95\xe5\x87\xbb __\'<<\'__ \xe3\x80\x81 __\'>>\'__ \xe4\xbb\xa5\xe5\xbf\xab\xe9\x80\x9f\xe5\xae\x9a\xe4\xbd\x8d\n**Capture Lua GC**\xe3\x80\x81**Capture Mono GC**\xe3\x80\x81**Frame Count**\n- \xe5\x81\x9c\xe6\xad\xa2\xe8\xae\xb0\xe5\xbd\x95\xe5\xb9\xb6\xe6\x8c\x89\xe5\xb7\xa6\xe6\x88\x96\xe5\x8f\xb3\xe7\xae\xad\xe5\xa4\xb4\xe9\x94\xae\xe7\x9b\x98\xe9\x80\x90\xe4\xb8\xaa\xe5\xa2\x9e\xe5\x8a\xa0\xe6\x88\x96\xe5\x87\x8f\xe5\xb0\x91\xe5\xb8\xa7\n\n##\n![](doc/record.gif)\n\n<span id="diff_zh"></span>\n### [DIFF \xe4\xb8\xa4\xe4\xb8\xaa\xe4\xb8\x8d\xe5\x90\x8c\xe6\x97\xb6\xe6\x9c\x9f\xe7\x9a\x84Lua\xe5\x8f\x98\xe9\x87\x8f](#zh)\n\xe9\x80\x89\xe5\x8f\x96\xe4\xb8\x80\xe4\xb8\xaa\xe9\x80\x82\xe5\xbd\x93\xe7\x9a\x84\xe6\x97\xb6\xe6\x9c\xba,\xe6\xaf\x94\xe5\xa6\x82\xe9\x85\x8d\xe7\xbd\xae\xe8\xa1\xa8\xe5\x8a\xa0\xe8\xbd\xbd\xe5\xae\x8c\xe5\x90\x8e\xef\xbc\x8c\xe5\x87\x86\xe5\xa4\x87\xe6\x89\x93\xe5\xbc\x80\xe4\xb8\x80\xe4\xb8\xaa\xe6\x96\xb0\xe7\x9a\x84UI\xe7\x9a\x84\xe6\x97\xb6\xe5\x80\x99\xe7\x82\xb9\xe5\x87\xbb**MarkLuaRecord**\xe6\x8c\x89\xe9\x92\xae\n##\n![](doc/mark.png)<br/>\n\xe6\x89\x93\xe5\xbc\x80UI\xe7\x84\xb6\xe5\x90\x8e\xe5\x85\xb3\xe9\x97\xad\xe5\xb9\xb6\xe5\x8d\xb8\xe8\xbd\xbd\xe6\x8e\x89UI\xe8\xb5\x84\xe6\xba\x90\xef\xbc\x8c\xe7\x82\xb9\xe5\x87\xbb**DiffRecord**\xef\xbc\x8c\xe5\xb7\xa5\xe5\x85\xb7\xe5\xb0\x86\xe4\xbc\x9a\xe5\xaf\xb9Mark\xe6\x97\xb6\xe5\x80\x99\xe7\x9a\x84Lua\xe5\x8f\x98\xe9\x87\x8f\xe4\xb8\x8e**DiffRecord**\xe6\x97\xb6\xe5\x80\x99\xe7\x9a\x84\xe5\x8f\x98\xe9\x87\x8f\xe8\xbf\x9b\xe8\xa1\x8c\xe5\xb7\xae\xe5\xbc\x82\xe6\xaf\x94\xe8\xbe\x83\n##\n![](doc/diff.png)<br/>\n\xe7\x82\xb9\xe5\x87\xbb**ShowLog**\xe6\x8c\x89\xe9\x92\xae\xef\xbc\x8c\xe5\xb0\x86\xe4\xbc\x9a\xe6\x8a\x8a\xe6\x96\x87\xe4\xbb\xb6\xe5\xad\x98\xe7\x9b\x98\xe6\x89\x93\xe5\xbc\x80\xe4\xb9\x8b\xe5\x90\x8e\xe5\xb0\x86\xe6\x8a\x8a\xe5\xaf\xb9\xe4\xba\x8e\xe5\x8f\x98\xe9\x87\x8f\xe7\x9a\x84\xe7\xb1\xbb\xe5\x9e\x8b\xe4\xbb\xa5\xe5\x8f\x8a\xe5\xbc\x95\xe7\x94\xa8\xe8\xb7\xaf\xe5\xbe\x84\xe6\x89\x93\xe5\x8d\xb0\xe5\x87\xba\xe6\x9d\xa5\xe3\x80\x82 \xe6\xb3\xa8\xe6\x84\x8f_G\xe8\xa1\xa8\xe7\xa4\xba\xe5\x85\xa8\xe5\xb1\x80\xe8\xa1\xa8,_R\xe8\xa1\xa8\xe7\xa4\xba\xe8\xa2\xabC#\xe5\xbc\x95\xe7\x94\xa8\xe7\x9a\x84\xe5\xaf\xb9\xe8\xb1\xa1\n##\n![](doc/diff_log.png)<br/>\n**Destroy null values**\xe4\xb8\xbaUnity\xe5\xb7\xb2\xe7\xbb\x8f\xe5\xb0\x86\xe8\xb5\x84\xe6\xba\x90\xe9\x87\x8a\xe6\x94\xbe\xef\xbc\x8c\xe8\x80\x8cLua\xe4\xbb\x8d\xe7\x84\xb6\xe5\xbc\x95\xe7\x94\xa8\xe7\x9a\x84\xe5\x8f\x98\xe9\x87\x8f\xef\xbc\x8c\xe8\xbf\x99\xe4\xb8\xaa\xe6\x98\xaf\xe4\xb8\xbb\xe8\xa6\x81\xe7\x9a\x84\xe8\xb5\x84\xe6\xba\x90\xe6\xb3\x84\xe6\xbc\x8f\xe8\xa6\x81\xe9\x87\x8d\xe7\x82\xb9\xe5\x85\xb3\xe6\xb3\xa8\xe3\x80\x82\n##\n![](doc/null_object.png)<br/>\n![](doc/search.png)<br/>\n\n<span id="custom_zh"></span>\n### [\xe8\x87\xaa\xe5\xae\x9a\xe4\xb9\x89Profiler\xe7\x82\xb9](#zh)\n```\nMikuLuaProfiler.LuaProfiler.BeginSampleCustom("profiler name")\n-- your code\nMikuLuaProfiler.LuaProfiler.EndSampleCustom()\n```\n\n<span id="device_zh"></span>\n### [\xe7\x9c\x9f\xe6\x9c\xbaProfiler](#zh)\n\xe8\xae\xbe\xe7\xbd\xae\xe5\xae\x8f **USE_LUA_PROFILER** \xe4\xbb\xa5\xe5\x9c\xa8App\xe4\xb8\xad\xe6\xb3\xa8\xe5\x85\xa5\xe6\x8e\xa2\xe6\x9f\xa5\xe5\x99\xa8\xe4\xbb\xa3\xe7\xa0\x81\xe3\x80\x82</br>\n\n#### Android\n\xe8\xae\xbe\xe7\xbd\xaeIP\xef\xbc\x9a127.0.0.1 port:2333. \xe3\x80\x82\xe4\xbd\xbf\xe7\x94\xa8USB\xe7\xba\xbf\xe8\xbf\x9e\xe6\x8e\xa5Android\xe6\x89\x8b\xe6\x9c\xba\xe3\x80\x82\xe5\x9c\xa8cmd\xe7\xaa\x97\xe5\x8f\xa3\xe4\xb8\xad\xe6\x89\xa7\xe8\xa1\x8c\xe4\xbb\xa5\xe4\xb8\x8b\xe6\x8c\x87\xe4\xbb\xa4</br>\n```\nadb reverse tcp:2333 tcp:2333\n```\n\xe6\x89\xa7\xe8\xa1\x8c\xe4\xbd\xa0\xe7\x9a\x84\xe5\xba\x94\xe7\x94\xa8\xe7\xa8\x8b\xe5\xba\x8f\xe3\x80\x82</br>\n\n\xe5\xa6\x82\xe6\x9e\x9c\xe8\xa6\x81\xe4\xbd\xbf\xe7\x94\xa8luac\xe4\xbb\xa3\xe7\xa0\x81\xe6\x88\x96luajit\xe5\xad\x97\xe8\x8a\x82\xe7\xa0\x81\xef\xbc\x8c\xe8\xaf\xb7\xe5\x9c\xa8\xe6\x96\x87\xe4\xbb\xb6\xe5\xa4\xb9\xe5\xb7\xa5\xe5\x85\xb7\xe4\xb8\xad\xe4\xbd\xbf\xe7\x94\xa8InjectLua.exe\xe6\xb3\xa8\xe5\x85\xa5lua profiler\xe4\xbb\xa3\xe7\xa0\x81\xe3\x80\x82</br>\n\n```\nInjectLua.exe "inpath" "outpath"\n```\n\n### Use Case\n![](doc/ljjc.jpg)\n\n## \n### Thanks\n[easy66](https://github.com/easy66) <br/>\n[Xavier](https://github.com/starwing) <br/>\n[Jay](https://github.com/Jayatubi) <br/>\n[ZhangDi](https://github.com/ZhangDi2018) <br/>\nand all members in qq group [LuaProfiler](https://jq.qq.com/?_wv=1027&k=5QkOBSc)\n\n## \n![](doc/meizi.gif)\n\n<span id="contact_zh"></span>\n### [\xe8\x81\x94\xe7\xb3\xbb](#zh)\n\xe5\xa6\x82\xe6\x9e\x9c\xe6\x82\xa8\xe5\x8f\x91\xe7\x8e\xb0\xe4\xbb\xbb\xe4\xbd\x95\xe9\x94\x99\xe8\xaf\xaf\xe6\x88\x96\xe6\x9c\x89\xe4\xbb\xbb\xe4\xbd\x95\xe5\xbb\xba\xe8\xae\xae\xe5\x8a\xa0\xe5\x85\xa5QQ\xe7\xbe\xa4\xef\xbc\x9a[882425563](https://jq.qq.com/?_wv=1027&k=5QkOBSc) \xe4\xb8\x8e\xe6\x88\x91\xe4\xbb\xac\xe8\x81\x94\xe7\xb3\xbb\n\n### \xe8\xa7\x89\xe5\xbe\x97\xe6\x8f\x92\xe4\xbb\xb6\xe5\xa5\xbd\xe7\x94\xa8\xef\xbc\x8c\xe6\x83\xb3\xe6\x94\xaf\xe6\x8c\x81\xe4\xbd\x9c\xe8\x80\x85\xe7\xbb\xa7\xe7\xbb\xad\xe5\xbc\x80\xe5\x8f\x91\xe8\xbf\x99\xe6\xac\xbe\xe6\x8f\x92\xe4\xbb\xb6\xe5\x8f\xaf\xe4\xbb\xa5\xe9\x80\x89\xe6\x8b\xa9\xe6\x8a\x95\xe9\xa3\x9f\n![](doc/zfb.png)\n\n##\n![](doc/star.gif)\n'