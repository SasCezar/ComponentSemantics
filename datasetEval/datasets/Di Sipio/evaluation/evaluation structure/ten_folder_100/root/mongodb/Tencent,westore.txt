b'# Westore - \xe5\xbe\xae\xe4\xbf\xa1\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe8\xa7\xa3\xe5\x86\xb3\xe6\x96\xb9\xe6\xa1\x88\n\n> [1KB javascript](https://github.com/dntzhang/westore/blob/master/packages/westore/utils/create.js)\xe8\xa6\x86\xe7\x9b\x96\xe7\x8a\xb6\xe6\x80\x81\xe7\xae\xa1\xe7\x90\x86\xe3\x80\x81\xe8\xb7\xa8\xe9\xa1\xb5\xe9\x80\x9a\xe8\xae\xaf\xe3\x80\x81\xe6\x8f\x92\xe4\xbb\xb6\xe5\xbc\x80\xe5\x8f\x91\xe5\x92\x8c\xe4\xba\x91\xe6\x95\xb0\xe6\x8d\xae\xe5\xba\x93\xe5\xbc\x80\xe5\x8f\x91\n\n---\n\n- [omix![](https://raw.githubusercontent.com/dntzhang/cax/master/asset/hot.png)](https://github.com/Tencent/omi/tree/master/packages/omix) - westore \xe8\xbf\x9b\xe5\x8c\x96\xe7\x89\x88\n- [dd-store](https://github.com/linjc/dd-store) - \xe9\x92\x89\xe9\x92\x89E\xe5\xba\x94\xe7\x94\xa8\xe7\x8a\xb6\xe6\x80\x81\xe7\xae\xa1\xe7\x90\x86, westore \xe7\x81\xb5\xe6\x84\x9f\xe8\xa1\x8d\xe7\x94\x9f\xe8\x80\x8c\xe6\x9d\xa5\n- [Packages \xe7\xae\x80\xe4\xbb\x8b](#packages-\xe7\xae\x80\xe4\xbb\x8b)\n- [\xe5\x89\x8d\xe8\xa8\x80](#\xe5\x89\x8d\xe8\xa8\x80)\n- [\xe4\xba\x91\xe5\xbc\x80\xe5\x8f\x91![](https://raw.githubusercontent.com/dntzhang/cax/master/asset/hot.png)](./westore-cloud.md)\n- [\xe6\x8f\x92\xe4\xbb\xb6\xe5\xbc\x80\xe5\x8f\x91](./westore-plugin.md)\n- [\xe6\x99\xae\xe9\x80\x9a\xe5\xbc\x80\xe5\x8f\x91](#\xe6\x99\xae\xe9\x80\x9a\xe5\xbc\x80\xe5\x8f\x91)\n\t- [\xe5\xae\x9a\xe4\xb9\x89\xe5\x85\xa8\xe5\xb1\x80 store](#\xe5\xae\x9a\xe4\xb9\x89\xe5\x85\xa8\xe5\xb1\x80-store)\n  - [\xe5\x88\x9b\xe5\xbb\xba\xe9\xa1\xb5\xe9\x9d\xa2](#\xe5\x88\x9b\xe5\xbb\xba\xe9\xa1\xb5\xe9\x9d\xa2)\n  - [\xe7\xbb\x91\xe5\xae\x9a\xe6\x95\xb0\xe6\x8d\xae](#\xe7\xbb\x91\xe5\xae\x9a\xe6\x95\xb0\xe6\x8d\xae)\n  - [\xe6\x9b\xb4\xe6\x96\xb0\xe9\xa1\xb5\xe9\x9d\xa2](#\xe6\x9b\xb4\xe6\x96\xb0\xe9\xa1\xb5\xe9\x9d\xa2)\n  - [\xe5\x88\x9b\xe5\xbb\xba\xe7\xbb\x84\xe4\xbb\xb6](#\xe5\x88\x9b\xe5\xbb\xba\xe7\xbb\x84\xe4\xbb\xb6)\n  - [\xe6\x9b\xb4\xe6\x96\xb0\xe7\xbb\x84\xe4\xbb\xb6](#\xe6\x9b\xb4\xe6\x96\xb0\xe7\xbb\x84\xe4\xbb\xb6)\n  - [setData \xe5\x92\x8c update \xe5\xaf\xb9\xe6\xaf\x94](#setdata-\xe5\x92\x8c-update-\xe5\xaf\xb9\xe6\xaf\x94)\n  - [\xe8\xb7\xa8\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x90\x8c\xe6\xad\xa5\xe6\x95\xb0\xe6\x8d\xae](#\xe8\xb7\xa8\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x90\x8c\xe6\xad\xa5\xe6\x95\xb0\xe6\x8d\xae)\n  - [\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6](#\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6)\n  - [\xe8\xb0\x83\xe8\xaf\x95](#\xe8\xb0\x83\xe8\xaf\x95)\n  - [\xe8\xb6\x85\xe5\xa4\xa7\xe5\x9e\x8b\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\x9c\x80\xe4\xbd\xb3\xe5\xae\x9e\xe8\xb7\xb5](#\xe8\xb6\x85\xe5\xa4\xa7\xe5\x9e\x8b\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\x9c\x80\xe4\xbd\xb3\xe5\xae\x9e\xe8\xb7\xb5\xe4\xb8\xa4\xe7\xa7\x8d\xe6\x96\xb9\xe6\xa1\x88)\n- [API](#api)\n- [\xe6\xb3\xa8\xe6\x84\x8f\xe4\xba\x8b\xe9\xa1\xb9](#\xe6\xb3\xa8\xe6\x84\x8f\xe4\xba\x8b\xe9\xa1\xb9)\n- [\xe5\x8e\x9f\xe7\x90\x86](#\xe5\x8e\x9f\xe7\x90\x86)\n  - [JSON Diff](#json-diff)\n  - [Update](#update)\n  - [\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7](#\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7)\n- [License](#license)\n\n\n## Packages \xe7\xae\x80\xe4\xbb\x8b\n\n| Package | \xe4\xbb\x8b\xe7\xbb\x8d  |\n| ------ | ------  |\n| westore | \t\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\xbc\x94\xe7\xa4\xba\xe9\xa1\xb9\xe7\x9b\xae\t  |\n| westore-cloud  | \xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f + \xe8\x85\xbe\xe8\xae\xaf\xe4\xba\x91\xe6\xbc\x94\xe7\xa4\xba\xe9\xa1\xb9\xe7\x9b\xae(\xe9\x9a\x90\xe5\xbd\xa2\xe4\xba\x91\xe2\x98\x81\xef\xb8\x8f)\t  |\n| westore-plugin | \xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\x8f\x92\xe4\xbb\xb6\xe5\xbc\x80\xe5\x8f\x91\xe6\xbc\x94\xe7\xa4\xba\xe9\xa1\xb9\xe7\x9b\xae  |\n| westore-proxy | \xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe5\xba\x95\xe5\xb1\x82\xe4\xbd\xbf\xe7\x94\xa8 Proxy \xe6\xbc\x94\xe7\xa4\xba\xe9\xa1\xb9\xe7\x9b\xae\t  |\n| westore-test  |  \xe6\xb5\x8b\xe8\xaf\x95 westore API \xe7\x9a\x84\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f  |\n| ~~westore-web~~ \xe5\xb7\xb2\xe8\xbd\xac\xe7\xa7\xbb\xe8\x87\xb3 [omi-mp](https://github.com/Tencent/omi/tree/master/packages/omi-mp)|  \xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe5\xbc\x80\xe5\x8f\x91 Web \xe7\x9a\x84\xe9\xa1\xb9\xe7\x9b\xae  |\n\n## \xe5\x89\x8d\xe8\xa8\x80\n\n\xe4\xbc\x97\xe6\x89\x80\xe5\x91\xa8\xe7\x9f\xa5\xef\xbc\x8c\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe9\x80\x9a\xe8\xbf\x87\xe9\xa1\xb5\xe9\x9d\xa2\xe6\x88\x96\xe7\xbb\x84\xe4\xbb\xb6\xe5\x90\x84\xe8\x87\xaa\xe7\x9a\x84 setData \xe5\x86\x8d\xe5\x8a\xa0\xe4\xb8\x8a\xe5\x90\x84\xe7\xa7\x8d\xe7\x88\xb6\xe5\xad\x90\xe3\x80\x81\xe7\xa5\x96\xe5\xad\x99\xe3\x80\x81\xe5\xa7\x90\xe5\xbc\x9f\xe3\x80\x81\xe5\xa7\x91\xe5\xa7\x91\xe4\xb8\x8e\xe5\xa0\x82\xe5\x85\x84\xe7\xad\x89\xe7\xad\x89\xe7\xbb\x84\xe4\xbb\xb6\xe9\x97\xb4\xe7\x9a\x84\xe9\x80\x9a\xe8\xae\xaf\xe4\xbc\x9a\xe6\x8a\x8a\xe7\xa8\x8b\xe5\xba\x8f\xe6\x90\x9e\xe6\x88\x90\xe4\xb8\x80\xe5\x9b\xa2\xe6\xb5\x86\xe7\xb3\x8a\xef\xbc\x8c\xe5\xa6\x82\xe6\x9e\x9c\xe5\x86\x8d\xe5\x8a\xa0\xe4\xb8\x8a\xe8\xb7\xa8\xe9\xa1\xb5\xe9\x9d\xa2\xe4\xb9\x8b\xe9\x97\xb4\xe7\x9a\x84\xe7\xbb\x84\xe4\xbb\xb6\xe9\x80\x9a\xe8\xae\xaf\xef\xbc\x8c\xe4\xbc\x9a\xe8\xae\xa9\xe7\xa8\x8b\xe5\xba\x8f\xe9\x9d\x9e\xe5\xb8\xb8\xe9\x9a\xbe\xe7\xbb\xb4\xe6\x8a\xa4\xe5\x92\x8c\xe8\xb0\x83\xe8\xaf\x95\xe3\x80\x82\xe8\x99\xbd\xe7\x84\xb6\xe5\xb8\x82\xe9\x9d\xa2\xe4\xb8\x8a\xe5\x87\xba\xe7\x8e\xb0\xe4\xba\x86\xe8\xae\xb8\xe5\xa4\x9a\xe6\x8a\x80\xe6\x9c\xaf\xe6\xa0\x88\xe7\xbc\x96\xe8\xaf\x91\xe8\xbd\xac\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe6\x8a\x80\xe6\x9c\xaf\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf\xe6\x88\x91\xe8\xa7\x89\xe6\xb2\xa1\xe6\x9c\x89\xe6\x88\xb3\xe4\xb8\xad\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe7\x97\x9b\xe7\x82\xb9\xe3\x80\x82\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe4\xb8\x8d\xe7\xae\xa1\xe4\xbb\x8e\xe7\xbb\x84\xe4\xbb\xb6\xe5\x8c\x96\xe3\x80\x81\xe5\xbc\x80\xe5\x8f\x91\xe3\x80\x81\xe8\xb0\x83\xe8\xaf\x95\xe3\x80\x81\xe5\x8f\x91\xe5\xb8\x83\xe3\x80\x81\xe7\x81\xb0\xe5\xba\xa6\xe3\x80\x81\xe5\x9b\x9e\xe6\xbb\x9a\xe3\x80\x81\xe4\xb8\x8a\xe6\x8a\xa5\xe3\x80\x81\xe7\xbb\x9f\xe8\xae\xa1\xe3\x80\x81\xe7\x9b\x91\xe6\x8e\xa7\xe5\x92\x8c\xe6\x9c\x80\xe8\xbf\x91\xe7\x9a\x84\xe4\xba\x91\xe8\x83\xbd\xe5\x8a\x9b\xe9\x83\xbd\xe9\x9d\x9e\xe5\xb8\xb8\xe5\xae\x8c\xe5\x96\x84\xef\xbc\x8c\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe5\xb7\xa5\xe7\xa8\x8b\xe5\x8c\x96\xe7\xae\x80\xe7\x9b\xb4\xe5\xb0\xb1\xe6\x98\xaf\xe5\x89\x8d\xe7\xab\xaf\xe7\x9a\x84\xe5\x85\xb8\xe8\x8c\x83\xe3\x80\x82\xe8\x80\x8c\xe5\xbc\x80\xe5\x8f\x91\xe8\x80\x85\xe5\xb7\xa5\xe5\x85\xb7\xe4\xb9\x9f\xe5\x9c\xa8\xe6\x8c\x81\xe7\xbb\xad\xe6\x9b\xb4\xe6\x96\xb0\xef\xbc\x8c\xe5\x8f\xaf\xe4\xbb\xa5\xe6\x83\xb3\xe8\xb1\xa1\xe7\x9a\x84\xe6\x9c\xaa\xe6\x9d\xa5\xef\xbc\x8c\xe7\xbb\x84\xe4\xbb\xb6\xe5\xb8\x83\xe5\xb1\x80\xe7\x9a\x84\xe8\xaf\x9d\xe6\x9c\xaa\xe5\xbf\x85\xe9\x9c\x80\xe8\xa6\x81\xe5\x86\x99\xe4\xbb\xa3\xe7\xa0\x81\xe4\xba\x86\xe3\x80\x82\xe8\x80\x8c\xe4\xb8\x94\xe6\x8d\xae\xe7\xbb\x9f\xe8\xae\xa1\xef\xbc\x8c\xe5\xbc\x80\xe5\x8f\x91\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe4\xbd\xbf\xe7\x94\xa8\xe6\x9c\x80\xe5\xa4\x9a\xe7\x9a\x84\xe6\x8a\x80\xe6\x9c\xaf\xe6\xa0\x88\xe6\x98\xaf\xe4\xbd\xbf\xe7\x94\xa8\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\x9c\xac\xe8\xba\xab\xe7\x9a\x84\xe5\xbc\x80\xe5\x8f\x91\xe5\xb7\xa5\xe5\x85\xb7\xe5\x92\x8c\xe8\xaf\xad\xe6\xb3\x95\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe6\x9c\x80\xe5\xa4\xa7\xe7\x9a\x84\xe7\x97\x9b\xe7\x82\xb9\xe5\x8f\xaa\xe5\x89\xa9\xe4\xb8\x8b\xe7\x8a\xb6\xe6\x80\x81\xe7\xae\xa1\xe7\x90\x86\xe5\x92\x8c\xe8\xb7\xa8\xe9\xa1\xb5\xe9\x80\x9a\xe8\xae\xaf\xe3\x80\x82Westore \xe7\x9a\x84\xe6\x96\xb9\xe6\xa1\x88:\n\n![data-flow](./asset/data-flow2.jpg)\n\n\xe9\x9d\x9e\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe7\x9a\x84\xe8\xaf\x9d\xef\xbc\x8c\xe5\x8f\xaf\xe4\xbb\xa5\xe7\x9b\xb4\xe6\x8e\xa5\xe7\x9c\x81\xe5\x8e\xbb triggerEvent \xe7\x9a\x84\xe8\xbf\x87\xe7\xa8\x8b\xef\xbc\x8c\xe7\x9b\xb4\xe6\x8e\xa5\xe4\xbf\xae\xe6\x94\xb9 store.data \xe5\xb9\xb6\xe4\xb8\x94 update\xef\xbc\x8c\xe5\xbd\xa2\xe6\x88\x90\xe7\xbc\xa9\xe5\x87\x8f\xe7\x89\x88\xe5\x8d\x95\xe5\x90\x91\xe6\x95\xb0\xe6\x8d\xae\xe6\xb5\x81\xe3\x80\x82\n\n\xe5\x8f\x97 [Omi \xe6\xa1\x86\xe6\x9e\xb6](https://github.com/Tencent/omi) \xe7\x9a\x84\xe5\x90\xaf\xe5\x8f\x91\xef\xbc\x8c\xe4\xb8\x94\xe4\xb8\x93\xe9\x97\xa8\xe4\xb8\xba\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe5\xbc\x80\xe5\x8f\x91\xe7\x9a\x84 [JSON Diff \xe5\xba\x93](https://github.com/dntzhang/westore/blob/master/packages/westore/utils/diff.js)\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe6\x9c\x89\xe4\xba\x86 westore \xe5\x85\xa8\xe5\xb1\x80\xe7\x8a\xb6\xe6\x80\x81\xe7\xae\xa1\xe7\x90\x86\xe5\x92\x8c\xe8\xb7\xa8\xe9\xa1\xb5\xe9\x80\x9a\xe8\xae\xaf\xe6\xa1\x86\xe6\x9e\xb6\xe8\xae\xa9\xe4\xb8\x80\xe5\x88\x87\xe5\xb0\xbd\xe5\x9c\xa8\xe6\x8e\x8c\xe6\x8f\xa1\xe4\xb8\xad\xef\xbc\x8c\xe4\xb8\x94\xe5\x8f\x97\xe9\xab\x98\xe6\x80\xa7\xe8\x83\xbd JSON Diff \xe5\xba\x93\xe7\x9a\x84\xe5\x88\xa9\xe5\xa5\xbd\xef\xbc\x8c\xe9\x95\xbf\xe5\x88\x97\xe8\xa1\xa8\xe6\xbb\x9a\xe5\x8a\xa8\xe5\x8a\xa0\xe8\xbd\xbd\xe6\x98\xbe\xe7\xa4\xba\xe5\x8f\x98\xe5\xbe\x97\xe8\xbd\xbb\xe6\x9d\xbe\xe5\x8f\xaf\xe9\xa9\xbe\xe9\xa9\xad\xe3\x80\x82\xe6\x80\xbb\xe7\xbb\x93\xe4\xb8\x8b\xe6\x9d\xa5\xe6\x9c\x89\xe5\xa6\x82\xe4\xb8\x8b\xe7\x89\xb9\xe6\x80\xa7\xe5\x92\x8c\xe4\xbc\x98\xe5\x8a\xbf:\n\n* \xe5\x92\x8c Omi \xe5\x90\x8c\xe6\xa0\xb7\xe7\xae\x80\xe6\xb4\x81\xe7\x9a\x84 Store API\n* \xe8\xb6\x85\xe5\xb0\x8f\xe7\x9a\x84\xe4\xbb\xa3\xe7\xa0\x81\xe5\xb0\xba\xe5\xaf\xb8(\xe5\x8c\x85\xe6\x8b\xac json diff \xe5\x85\xb1100\xe5\xa4\x9a\xe8\xa1\x8c)\n* \xe5\xb0\x8a\xe9\x87\x8d\xe4\xb8\x94\xe9\xa1\xba\xe4\xbb\x8e\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe8\xae\xbe\xe8\xae\xa1(\xe5\x85\xb6\xe4\xbb\x96\xe8\xbd\xac\xe8\xaf\x91\xe5\xba\x93\xe7\x9b\xb8\xe5\xbd\x93\xe4\xba\x8e\xe5\x8f\x8d\xe5\x85\xb6\xe9\x81\x93\xe8\xa1\x8c)\n* \xe5\xa2\x9e\xe5\xbc\xba data \xe6\x95\xb0\xe6\x8d\xae\xe7\xbb\x91\xe5\xae\x9a\xef\xbc\x8c\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\xe5\x8f\xaf\xe7\x9b\xb4\xe6\x8e\xa5\xe7\xbb\x91\xe5\xae\x9a\xe5\x88\xb0 WXML\n* this.update \xe5\x92\x8c setData \xe8\xaf\xad\xe6\xb3\x95\xe7\xb1\xbb\xe4\xbc\xbc\xef\xbc\x8c\xe4\xbd\x86\xe8\xbf\x94\xe5\x9b\x9e\xe4\xb8\x80\xe4\xb8\xaaPromise\n* this.update \xe6\xaf\x94\xe5\x8e\x9f\xe7\x94\x9f setData \xe7\x9a\x84\xe6\x80\xa7\xe8\x83\xbd\xe6\x9b\xb4\xe4\xbc\x98\xef\xbc\x8c\xe6\x9b\xb4\xe5\x8a\xa0\xe6\x99\xba\xe8\x83\xbd\n* Westore \xe4\xb8\x93\xe4\xb8\xba\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\x8f\x92\xe4\xbb\xb6\xe5\xbc\x80\xe5\x8f\x91[\xe5\xae\x9a\xe5\x88\xb6\xe4\xba\x86\xe6\xa8\xa1\xe6\x9d\xbf](https://github.com/dntzhang/westore/tree/master/packages/westore-plugin)\n* Westore \xe9\x9b\x86\xe6\x88\x90\xe4\xba\x86\xe8\x85\xbe\xe8\xae\xaf\xe4\xba\x91\xe5\xbc\x80\xe5\x8f\x91\n\n\xe6\x80\xbb\xe7\xbb\x93\xe4\xb8\x8b\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe7\x97\x9b\xe7\x82\xb9:\n\n* \xe4\xbd\xbf\xe7\x94\xa8 this.data \xe5\x8f\xaf\xe4\xbb\xa5\xe8\x8e\xb7\xe5\x8f\x96\xe5\x86\x85\xe9\x83\xa8\xe6\x95\xb0\xe6\x8d\xae\xe5\x92\x8c\xe5\xb1\x9e\xe6\x80\xa7\xe5\x80\xbc\xef\xbc\x8c\xe4\xbd\x86\xe4\xb8\x8d\xe8\xa6\x81\xe7\x9b\xb4\xe6\x8e\xa5\xe4\xbf\xae\xe6\x94\xb9\xe5\xae\x83\xe4\xbb\xac\xef\xbc\x8c\xe5\xba\x94\xe4\xbd\xbf\xe7\x94\xa8 setData \xe4\xbf\xae\xe6\x94\xb9\n* setData \xe7\xbc\x96\xe7\xa8\x8b\xe4\xbd\x93\xe9\xaa\x8c\xe4\xb8\x8d\xe5\xa5\xbd\xef\xbc\x8c\xe5\xbe\x88\xe5\xa4\x9a\xe5\x9c\xba\xe6\x99\xaf\xe7\x9b\xb4\xe6\x8e\xa5\xe8\xb5\x8b\xe5\x80\xbc\xe6\x9b\xb4\xe5\x8a\xa0\xe7\x9b\xb4\xe8\xa7\x82\xe6\x96\xb9\xe4\xbe\xbf\n* setData \xe5\x8d\xa1\xe5\x8d\xa1\xe5\x8d\xa1\xe6\x85\xa2\xe6\x85\xa2\xe6\x85\xa2\xef\xbc\x8cJsCore \xe5\x92\x8c Webview \xe6\x95\xb0\xe6\x8d\xae\xe5\xaf\xb9\xe8\xb1\xa1\xe6\x9d\xa5\xe5\x9b\x9e\xe4\xbc\xa0\xe6\xb5\xaa\xe8\xb4\xb9\xe8\xae\xa1\xe7\xae\x97\xe8\xb5\x84\xe6\xba\x90\xe5\x92\x8c\xe5\x86\x85\xe5\xad\x98\xe8\xb5\x84\xe6\xba\x90\n* \xe7\xbb\x84\xe4\xbb\xb6\xe9\x97\xb4\xe9\x80\x9a\xe8\xae\xaf\xe6\x88\x96\xe8\xb7\xa8\xe9\xa1\xb5\xe9\x80\x9a\xe8\xae\xaf\xe4\xbc\x9a\xe6\x8a\x8a\xe7\xa8\x8b\xe5\xba\x8f\xe6\x90\x9e\xe5\xbe\x97\xe4\xb9\xb1\xe4\xb8\x83\xe5\x85\xab\xe7\xb3\x9f\xef\xbc\x8c\xe5\x8f\x98\xe5\xbe\x97\xe6\x9e\x81\xe9\x9a\xbe\xe7\xbb\xb4\xe6\x8a\xa4\xe5\x92\x8c\xe6\x89\xa9\xe5\xb1\x95\n\n\xe6\x89\x80\xe4\xbb\xa5\xe6\xb2\xa1\xe4\xbd\xbf\xe7\x94\xa8 westore \xe7\x9a\x84\xe6\x97\xb6\xe5\x80\x99\xe7\xbb\x8f\xe5\xb8\xb8\xe5\x8f\xaf\xe4\xbb\xa5\xe7\x9c\x8b\xe5\x88\xb0\xe8\xbf\x99\xe6\xa0\xb7\xe7\x9a\x84\xe4\xbb\xa3\xe7\xa0\x81:\n\n![not-westore](./asset/not-westore.png)\n\n\xe4\xbd\xbf\xe7\x94\xa8\xe5\xae\x8c westore \xe4\xb9\x8b\xe5\x90\x8e:\n\n![westore](./asset/westore2.png)\n\n\xe4\xb8\x8a\xe9\x9d\xa2\xe4\xb8\xa4\xe7\xa7\x8d\xe6\x96\xb9\xe5\xbc\x8f\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe6\xb7\xb7\xe5\x90\x88\xe4\xbd\xbf\xe7\x94\xa8\xe3\x80\x82\n\n\xe5\x8f\xaf\xe4\xbb\xa5\xe7\x9c\x8b\xe5\x88\xb0\xef\xbc\x8cwestore \xe4\xb8\x8d\xe4\xbb\x85\xe6\x94\xaf\xe6\x8c\x81\xe7\x9b\xb4\xe6\x8e\xa5\xe8\xb5\x8b\xe5\x80\xbc\xef\xbc\x8c\xe8\x80\x8c\xe4\xb8\x94 this.update \xe5\x85\xbc\xe5\xae\xb9\xe4\xba\x86 this.setData \xe7\x9a\x84\xe8\xaf\xad\xe6\xb3\x95\xef\xbc\x8c\xe4\xbd\x86\xe6\x80\xa7\xe8\x83\xbd\xe5\xa4\xa7\xe5\xa4\xa7\xe4\xbc\x98\xe4\xba\x8e this.setData\xef\xbc\x8c\xe5\x86\x8d\xe4\xb8\xbe\xe4\xb8\xaa\xe4\xbe\x8b\xe5\xad\x90\xef\xbc\x9a\n\n``` js\nthis.store.data.motto = \'Hello Westore\'\nthis.store.data.b.arr.push({ name: \'ccc\' })\nthis.update()\n```\n\n\xe7\xad\x89\xe5\x90\x8c\xe4\xba\x8e\n\n``` js\nthis.update({\n  motto:\'Hello Westore\',\n  [`b.arr[${this.store.data.b.arr.length}]`]:{name:\'ccc\'}\n})\n```\n\n\xe5\x92\x8c\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84setData\xe4\xb8\x8d\xe5\x90\x8c\xe7\x9a\x84\xe6\x98\xaf\xe5\x9b\x9e\xe8\xb0\x83\xe7\x9a\x84\xe6\x96\xb9\xe5\xbc\x8f\xef\xbc\x8c\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe5\x9b\x9e\xe8\xb0\x83\xe4\xb8\xbasetData\xe7\x9a\x84\xe7\xac\xac\xe4\xba\x8c\xe4\xb8\xaa\xe5\x85\xa5\xe5\x8f\x82\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xafupdate\xe5\x88\x99\xe7\x9b\xb4\xe6\x8e\xa5\xe8\xbf\x94\xe5\x9b\x9e\xe4\xb8\x80\xe4\xb8\xaaPromise\xef\xbc\x8c\xe5\xb9\xb6\xe4\xb8\x94\xe8\xbf\x94\xe5\x9b\x9e\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xae\xe5\x86\x85\xe6\x9c\x89\xe6\x9b\xb4\xe6\x96\xb0\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xae\xe5\x86\x85\xe5\xae\xb9\xe3\x80\x82\xe4\xbe\x8b\xe5\xa6\x82\xef\xbc\x9a\n\n``` js\nthis.setData({\n  motto: \'Hello Westore\'\n}, () => {\n  console.log(\'the motto has been set\')\n})\n```\n\n\xe8\xa2\xab\xe6\x94\xb9\xe8\xbf\x9b\xe4\xb8\xba\n\n``` js\nthis.store.data.mottto = \'Hello Westore\'\nthis.update().then(diff => {\n  console.log(\'the motto has been set\', diff)\n})\n```\n\n\xe8\xbf\x99\xe9\x87\x8c\xe9\x9c\x80\xe8\xa6\x81\xe7\x89\xb9\xe5\x88\xab\xe5\xbc\xba\xe8\xb0\x83\xef\xbc\x8c\xe8\x99\xbd\xe7\x84\xb6 this.update \xe5\x8f\xaf\xe4\xbb\xa5\xe5\x85\xbc\xe5\xae\xb9\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84 this.setData \xe7\x9a\x84\xe6\x96\xb9\xe5\xbc\x8f\xe4\xbc\xa0\xe5\x8f\x82\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf\xe6\x9b\xb4\xe5\x8a\xa0\xe6\x99\xba\xe8\x83\xbd\xef\xbc\x8cthis.update \xe4\xbc\x9a\xe5\x85\x88 Diff \xe7\x84\xb6\xe5\x90\x8e setData\xe3\x80\x82\xe5\x8e\x9f\xe7\x90\x86:\n\n![](./asset/update2.jpg)\n\n## API\n\nWestore API \xe5\x8f\xaa\xe6\x9c\x89\xe5\x85\xad\xe4\xb8\xaa, \xe5\xa4\xa7\xe9\x81\x93\xe8\x87\xb3\xe7\xae\x80:\n\n* create(store, option) \xe5\x88\x9b\xe5\xbb\xba\xe9\xa1\xb5\xe9\x9d\xa2\n* create(option)        \xe5\x88\x9b\xe5\xbb\xba\xe7\xbb\x84\xe4\xbb\xb6\n* this.update([data])   \xe6\x9b\xb4\xe6\x96\xb0\xe9\xa1\xb5\xe9\x9d\xa2\xe6\x88\x96\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x8c\xe5\x85\xb6\xe4\xb8\xad data \xe4\xb8\xba\xe5\x8f\xaf\xe9\x80\x89\xef\xbc\x8cdata \xe7\x9a\x84\xe6\xa0\xbc\xe5\xbc\x8f\xe5\x92\x8c setData \xe4\xb8\x80\xe8\x87\xb4\n* store.update([data])   \xe6\x9b\xb4\xe6\x96\xb0\xe9\xa1\xb5\xe9\x9d\xa2\xe6\x88\x96\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x8c\xe5\x9c\xa8\xe9\x9d\x9e\xe9\xa1\xb5\xe9\x9d\xa2\xe9\x9d\x9e\xe7\xbb\x84\xe4\xbb\xb6\xe7\x9a\x84 js \xe6\x96\x87\xe4\xbb\xb6\xe4\xb8\xad\xe4\xbd\xbf\xe7\x94\xa8\n* store.method(path, fn)   \xe6\x9b\xb4\xe6\x96\xb0\xe6\x88\x96\xe6\x89\xa9\xe5\xb1\x95\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\xef\xbc\x8c\xe6\xb3\xa8\xe6\x84\x8f\xe8\xbf\x99\xe9\x87\x8c\xe4\xb8\x8d\xe8\x83\xbd\xe7\x9b\xb4\xe6\x8e\xa5\xe8\xb5\x8b\xe5\x80\xbc\xe7\x9a\x84\xe6\x96\xb9\xe5\xbc\x8f\xe4\xbf\xae\xe6\x94\xb9\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\xef\xbc\x8c\xe9\x9c\x80\xe8\xa6\x81\xe4\xbd\xbf\xe7\x94\xa8 store.method\n* store.onChange = fn   \xe7\x9b\x91\xe5\x90\xac store data \xe7\x9a\x84\xe5\x8f\x98\xe5\x8c\x96\xe5\x9b\x9e\xe8\xb0\x83\xef\xbc\x8c\xe4\xb8\x80\xe8\x88\xac\xe5\x8f\xaf\xe5\x9c\xa8\xe9\x87\x8c\xe9\x9d\xa2\xe5\x86\x99\xe4\xb8\x80\xe4\xba\x9b\xe4\xb8\x8a\xe6\x8a\xa5\xe6\x88\x96\xe7\x9b\x91\xe6\x8e\xa7\xe6\x95\xb0\xe6\x8d\xae\xe5\x8f\x98\xe5\x8c\x96\xe7\x9a\x84\xe5\x85\xb6\xe4\xbb\x96\xe5\x85\xac\xe5\x85\xb1\xe9\x80\xbb\xe8\xbe\x91\n\n\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe4\xbd\xbf\xe7\x94\xa8\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe8\x87\xaa\xe5\xb8\xa6\xe7\x9a\x84 Component\xef\xbc\x8c\xe6\x88\x96\xe4\xbd\xbf\xe7\x94\xa8 `create({ pure: true })`\xe3\x80\x82create\xe7\x9a\x84\xe6\x96\xb9\xe5\xbc\x8f\xe5\x8f\xaf\xe4\xbb\xa5\xe4\xbd\xbf\xe7\x94\xa8 update \xe6\x96\xb9\xe6\xb3\x95\xef\xbc\x8cComponent \xe6\x96\xb9\xe5\xbc\x8f\xe4\xb8\x8d\xe8\xa1\x8c\xe3\x80\x82\n\n## \xe6\x99\xae\xe9\x80\x9a\xe5\xbc\x80\xe5\x8f\x91\n\n### \xe5\xae\x9a\xe4\xb9\x89\xe5\x85\xa8\xe5\xb1\x80 store\n\n```js\nexport default {\n  data: {\n    motto: \'Hello World\',\n    userInfo: {},\n    hasUserInfo: false,\n    canIUse: wx.canIUse(\'button.open-type.getUserInfo\'),\n    logs: [],\n    b: {\n      arr: [{ name: \'\xe6\x95\xb0\xe5\x80\xbc\xe9\xa1\xb9\xe7\x9b\xae1\' }] ,\n      //\xe6\xb7\xb1\xe5\xb1\x82\xe8\x8a\x82\xe7\x82\xb9\xe4\xb9\x9f\xe6\x94\xaf\xe6\x8c\x81\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\n      fnTest:function(){\n        return this.motto.split(\'\').reverse().join(\'\')\n      }\n    },\n    firstName: \'dnt\',\n    lastName: \'zhang\',\n    fullName: function () {\n      return this.firstName + this.lastName\n    },\n    pureProp: \'pureProp\',\n    globalPropTest: \'abc\', //\xe6\x9b\xb4\xe6\x94\xb9\xe6\x88\x91\xe4\xbc\x9a\xe5\x88\xb7\xe6\x96\xb0\xe6\x89\x80\xe6\x9c\x89\xe9\xa1\xb5\xe9\x9d\xa2,\xe4\xb8\x8d\xe9\x9c\x80\xe8\xa6\x81\xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\x92\x8c\xe9\xa1\xb5\xe9\x9d\xa2\xe5\xa3\xb0\xe6\x98\x8edata\xe4\xbe\x9d\xe8\xb5\x96\n    ccc: { ddd: 1 } //\xe6\x9b\xb4\xe6\x94\xb9\xe6\x88\x91\xe4\xbc\x9a\xe5\x88\xb7\xe6\x96\xb0\xe6\x89\x80\xe6\x9c\x89\xe9\xa1\xb5\xe9\x9d\xa2,\xe4\xb8\x8d\xe9\x9c\x80\xe8\xa6\x81\xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\x92\x8c\xe9\xa1\xb5\xe9\x9d\xa2\xe5\xa3\xb0\xe6\x98\x8edata\xe4\xbe\x9d\xe8\xb5\x96\n  },\n  globalData: [\'globalPropTest\', \'ccc.ddd\'],\n  logMotto: function () {\n    console.log(this.data.motto)\n  },\n  //\xe9\xbb\x98\xe8\xae\xa4 false\xef\xbc\x8c\xe4\xb8\xba true \xe4\xbc\x9a\xe6\x97\xa0\xe8\x84\x91\xe6\x9b\xb4\xe6\x96\xb0\xe6\x89\x80\xe6\x9c\x89\xe5\xae\x9e\xe4\xbe\x8b\n  //updateAll: true\n}\n```\n\n\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x92\x8c\xe7\xbb\x84\xe4\xbb\xb6\xe4\xb8\x8a\xe5\x90\x8c\xe6\xa0\xb7\xe9\x9c\x80\xe8\xa6\x81\xe5\xa3\xb0\xe6\x98\x8e\xe4\xbe\x9d\xe8\xb5\x96\xe7\x9a\x84 data\xef\xbc\x8c\xe8\xbf\x99\xe6\xa0\xb7 westore \xe4\xbc\x9a\xe6\x8c\x89\xe9\x9c\x80\xe5\xb1\x80\xe9\x83\xa8\xe6\x9b\xb4\xe6\x96\xb0\xe3\x80\x82\xe5\xa6\x82 Page \xe7\x9a\x84 data\xef\xbc\x9a\n\n```js\ndata: {\n  motto: null,\n  userInfo: null,\n  hasUserInfo: null,\n  canIUse: null,\n  b: { arr: [ ] },\n  firstName: null,\n  lastName: null,\n  fullName: null,\n  pureProp: null,\n  //privateProp \xe4\xbd\xa0\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe5\xae\x9a\xe4\xb9\x89 store.data \xe6\xb2\xa1\xe6\x9c\x89\xe7\x9a\x84\xe5\xb1\x9e\xe6\x80\xa7\xef\xbc\x8c\xe8\xaf\xa5\xe5\xb1\x9e\xe6\x80\xa7\xe7\x9a\x84\xe5\x8f\x98\xe6\x9b\xb4\xe5\x8f\xaa\xe8\x83\xbd\xe9\x80\x9a\xe8\xbf\x87 this.setData \xe8\xbf\x9b\xe8\xa1\x8c\xe6\x9b\xb4\xe6\x96\xb0\xe8\xa7\x86\xe5\x9b\xbe\n  privateProp: \'\xe7\xa7\x81\xe6\x9c\x89\xe6\x95\xb0\xe6\x8d\xae\',\n  xxxx: \'\xe7\xa7\x81\xe6\x9c\x89\xe6\x95\xb0\xe6\x8d\xae2\'\n}\n```\n\n\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x92\x8c\xe7\xbb\x84\xe4\xbb\xb6\xe4\xb8\x8a\xe5\xa3\xb0\xe6\x98\x8e\xe7\x9a\x84 data \xe7\x9a\x84\xe5\x80\xbc\xe4\xbc\x9a\xe8\xa2\xab store \xe4\xb8\x8a\xe7\x9a\x84\xe5\x80\xbc\xe8\xa6\x86\xe7\x9b\x96\xe6\x8e\x89\xe3\x80\x82\xe6\x89\x80\xe4\xbb\xa5\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x92\x8c\xe7\xbb\x84\xe4\xbb\xb6\xe9\xbb\x98\xe8\xae\xa4\xe5\x80\xbc\xe5\x9c\xa8 store.data \xe4\xb8\x8a\xe6\xa0\x87\xe8\xae\xb0\xef\xbc\x8c\xe8\x80\x8c\xe4\xb8\x8d\xe6\x98\xaf\xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\x92\x8c\xe9\xa1\xb5\xe9\x9d\xa2\xe7\x9a\x84 data\xe3\x80\x82\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\x86\x85\xe9\x83\xa8\xe7\x9a\x84 data \xe5\xae\x9a\xe4\xb9\x89\xe9\xbb\x98\xe8\xae\xa4\xe5\x80\xbc\xe3\x80\x82\xe6\x89\x80\xe4\xbb\xa5\xe5\xbd\x92\xe7\xba\xb3\xe4\xb8\x80\xe4\xb8\x8b\xef\xbc\x9a\n\n* store.data \xe7\x94\xa8\xe6\x9d\xa5\xe5\x88\x97\xe5\x87\xba\xe6\x89\x80\xe6\x9c\x89\xe5\xb1\x9e\xe6\x80\xa7\xe5\x92\x8c\xe9\xbb\x98\xe8\xae\xa4\xe5\x80\xbc\n* \xe7\xbb\x84\xe4\xbb\xb6\xe7\x9a\x84\xe7\xa7\x81\xe6\x9c\x89 data \xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe6\x94\xbe\xe5\x9c\xa8\xe8\x87\xaa\xe8\xba\xab\xe7\x9a\x84 data \xe4\xb8\x8a\xef\xbc\x8c\xe4\xb8\x8d\xe7\x94\xa8\xe6\x8c\x82\xe5\x9c\xa8 store.data \xe4\xb8\x8a\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf\xe4\xb8\x8d\xe8\x83\xbd\xe9\x80\x9a\xe8\xbf\x87 this.update \xe6\x9b\xb4\xe6\x96\xb0\xef\xbc\x8c\xe5\x8f\xaa\xe8\x83\xbd\xe9\x80\x9a\xe8\xbf\x87 setData\n* \xe7\xbb\x84\xe4\xbb\xb6\xe5\x92\x8c\xe9\xa1\xb5\xe9\x9d\xa2\xe7\x9a\x84 data \xe7\x94\xa8\xe6\x9d\xa5\xe5\x88\x97\xe5\x87\xba\xe4\xbe\x9d\xe8\xb5\x96\xe7\x9a\x84 store.data \xe7\x9a\x84\xe5\xb1\x9e\xe6\x80\xa7 (westore\xe4\xbc\x9a\xe8\xae\xb0\xe5\xbd\x95path)\xef\xbc\x8c\xe6\x8c\x89\xe9\x9c\x80\xe6\x9b\xb4\xe6\x96\xb0\n* \xe5\xa6\x82\xe6\x9e\x9c\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x92\x8c\xe7\xbb\x84\xe4\xbb\xb6\xe5\xbe\x88\xe5\xb0\x91\xef\xbc\x8c\xe5\x8f\xaf\xe4\xbb\xa5 updateAll \xe8\xae\xbe\xe7\xbd\xae\xe6\x88\x90 true\xef\xbc\x8c\xe5\xb9\xb6\xe4\xb8\x94\xe7\xbb\x84\xe4\xbb\xb6\xe5\x92\x8c\xe9\xa1\xb5\xe9\x9d\xa2\xe4\xb8\x8d\xe9\x9c\x80\xe8\xa6\x81\xe5\xa3\xb0\xe6\x98\x8e data\xef\xbc\x8c\xe4\xb9\x9f\xe5\xb0\xb1\xe4\xb8\x8d\xe4\xbc\x9a\xe6\x8c\x89\xe9\x9c\x80\xe6\x9b\xb4\xe6\x96\xb0\n* \xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe7\x9a\x84 data \xe5\x92\x8c store.data \xe6\xb2\xa1\xe6\x9c\x89\xe5\x85\xb3\xe7\xb3\xbb\xef\xbc\x8c\xe6\x89\x80\xe6\x9c\x89\xe5\x85\xb6 data \xe7\x94\xa8\xe6\x9d\xa5\xe5\x88\x97\xe5\x87\xba\xe6\x89\x80\xe6\x9c\x89\xe5\xb1\x9e\xe6\x80\xa7\xe5\x92\x8c\xe9\xbb\x98\xe8\xae\xa4\xe5\x80\xbc\n* globalData \xe9\x87\x8c\xe5\xa3\xb0\xe6\x98\x8e\xe7\x9a\x84 path\xef\xbc\x8c\xe5\x8f\xaa\xe8\xa6\x81\xe4\xbf\xae\xe6\x94\xb9\xe4\xba\x86\xe5\xaf\xb9\xe5\xba\x94 path \xe7\x9a\x84\xe5\x80\xbc\xef\xbc\x8c\xe5\xb0\xb1\xe4\xbc\x9a\xe5\x88\xb7\xe6\x96\xb0\xe6\x89\x80\xe6\x9c\x89\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x92\x8c\xe7\xbb\x84\xe4\xbb\xb6\n\n\xe6\xaf\x94\xe8\xb5\xb7\xe5\x8e\x9f\xe7\x94\x9f\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe5\xa2\x9e\xe5\xbc\xba\xe7\x9a\x84\xe5\x8a\x9f\xe8\x83\xbd\xe6\x98\xaf\xe6\x8f\x90\xe4\xbe\x9b\xe4\xba\x86 data \xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\xef\xbc\x8c\xe6\xaf\x94\xe5\xa6\x82\xe4\xb8\x8a\xe9\x9d\xa2\xe7\x9a\x84 fullName\xef\xbc\x8c\xe5\x9c\xa8\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f WXML \xe7\x9b\xb4\xe6\x8e\xa5\xe7\xbb\x91\xe5\xae\x9a\xef\xbc\x9a\n\n```jsx\n<view>{{fullName}}</view>\n```\n\n### \xe5\x88\x9b\xe5\xbb\xba\xe9\xa1\xb5\xe9\x9d\xa2\n\n```js\nimport store from \'../../store\'\nimport create from \'../../utils/create\'\n\nconst app = getApp()\n\ncreate(store, {\n  //\xe5\x8f\xaa\xe6\x98\xaf\xe7\x94\xa8\xe6\x9d\xa5\xe7\xbb\x99 westore \xe7\x94\x9f\xe6\x88\x90\xe4\xbe\x9d\xe8\xb5\x96 path \xe5\xb1\x80\xe9\x83\xa8\xe6\x9b\xb4\xe6\x96\xb0\n  data: {\n    motto: null,\n    userInfo: null,\n    hasUserInfo: null,\n    canIUse: null,\n    b: { arr: [ ] },\n    firstName: null,\n    lastName: null,\n    fullName: null,\n    pureProp: null\n  },\n  onLoad: function () {\n    if (app.globalData.userInfo) {\n      this.store.data.userInfo = app.globalData.userInfo\n      this.store.data.hasUserInfo = true\n      this.update()\n    } else if (this.data.canIUse) {\n      app.userInfoReadyCallback = res => {\n        this.store.data.userInfo = res.userInfo\n        this.store.data.hasUserInfo = true\n        this.update()\n      }\n    } else {\n      wx.getUserInfo({\n        success: res => {\n          app.globalData.userInfo = res.userInfo\n          this.store.data.userInfo = res.userInfo\n          this.store.data.hasUserInfo = true\n          this.update()\n        }\n      })\n    }\n  }\n\n})\n```\n\n\xe5\x88\x9b\xe5\xbb\xba Page \xe5\x8f\xaa\xe9\x9c\x80\xe4\xbc\xa0\xe5\x85\xa5\xe4\xb8\xa4\xe4\xb8\xaa\xe5\x8f\x82\xe6\x95\xb0\xef\xbc\x8cstore \xe4\xbb\x8e\xe6\xa0\xb9\xe8\x8a\x82\xe7\x82\xb9\xe6\xb3\xa8\xe5\x85\xa5\xef\xbc\x8c\xe6\x89\x80\xe6\x9c\x89\xe5\xad\x90\xe7\xbb\x84\xe4\xbb\xb6\xe9\x83\xbd\xe8\x83\xbd\xe9\x80\x9a\xe8\xbf\x87 this.store \xe8\xae\xbf\xe9\x97\xae\xe3\x80\x82\n\n### \xe7\xbb\x91\xe5\xae\x9a\xe6\x95\xb0\xe6\x8d\xae\n\n```jsx\n<view class="container">\n\n  <view class="userinfo">\n    <button wx:if="{{!hasUserInfo && canIUse}}" open-type="getUserInfo" bindgetuserinfo="getUserInfo"> \xe8\x8e\xb7\xe5\x8f\x96\xe5\xa4\xb4\xe5\x83\x8f\xe6\x98\xb5\xe7\xa7\xb0 </button>\n    <block wx:else>\n      <image bindtap="bindViewTap" class="userinfo-avatar" src="{{userInfo.avatarUrl}}" mode="cover"></image>\n      <text class="userinfo-nickname">{{userInfo.nickName}}</text>\n    </block>\n  </view>\n  <view class="usermotto">\n    <text class="user-motto">{{motto}}</text>\n  </view>\n  <view>{{fullName}}</view>\n  <hello></hello>\n</view>\n```\n\n\xe5\x92\x8c\xe4\xbb\xa5\xe5\x89\x8d\xe7\x9a\x84\xe5\x86\x99\xe6\xb3\x95\xe6\xb2\xa1\xe6\x9c\x89\xe5\xb7\xae\xe5\x88\xab\xef\xbc\x8c\xe7\x9b\xb4\xe6\x8e\xa5\xe6\x8a\x8a `store.data` \xe4\xbd\x9c\xe4\xb8\xba\xe7\xbb\x91\xe5\xae\x9a\xe6\x95\xb0\xe6\x8d\xae\xe6\xba\x90\xe3\x80\x82  \ndata \xe7\x9a\x84\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe7\x9b\xb4\xe6\x8e\xa5\xe7\xbb\x91\xe5\xae\x9a\xef\xbc\x8c\xe4\xbd\x86\xe5\x88\xab\xe5\xbf\x98\xe4\xba\x86\xe8\xa6\x81\xe5\x9c\xa8\xe9\xa1\xb5\xe9\x9d\xa2\xe4\xb8\x8a\xe5\xa3\xb0\xe6\x98\x8e\xe7\x9b\xb8\xe5\xba\x94\xe7\x9a\x84\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\xe4\xbe\x9d\xe8\xb5\x96\xe3\x80\x82\n\n### \xe6\x9b\xb4\xe6\x96\xb0\xe9\xa1\xb5\xe9\x9d\xa2\n\n```js\nthis.store.data.any_prop_you_want_to_change = \'any_thing_you_want_change_to\'\nthis.update()\n```\n\n### \xe5\x88\x9b\xe5\xbb\xba\xe7\xbb\x84\xe4\xbb\xb6\n\n```js\n\nimport create from \'../../utils/create\'\n\ncreate({\n  ready: function () {\n   //you can use this.store here\n  },\n\n  methods: {\n    //you can use this.store here\n  }\n})\n\n```\n\xe5\x92\x8c\xe5\x88\x9b\xe5\xbb\xba Page \xe4\xb8\x8d\xe4\xb8\x80\xe6\xa0\xb7\xe7\x9a\x84\xe6\x98\xaf\xef\xbc\x8c\xe5\x88\x9b\xe5\xbb\xba\xe7\xbb\x84\xe4\xbb\xb6\xe5\x8f\xaa\xe9\x9c\x80\xe4\xbc\xa0\xe5\x85\xa5\xe4\xb8\x80\xe4\xb8\xaa\xe5\x8f\x82\xe6\x95\xb0\xef\xbc\x8c\xe4\xb8\x8d\xe9\x9c\x80\xe8\xa6\x81\xe4\xbc\xa0\xe5\x85\xa5 store\xef\xbc\x8c\xe5\x9b\xa0\xe4\xb8\xba\xe5\xb7\xb2\xe7\xbb\x8f\xe4\xbb\x8e\xe6\xa0\xb9\xe8\x8a\x82\xe7\x82\xb9\xe6\xb3\xa8\xe5\x85\xa5\xe4\xba\x86\xe3\x80\x82\n\n### \xe6\x9b\xb4\xe6\x96\xb0\xe7\xbb\x84\xe4\xbb\xb6\n\n```js\nthis.store.data.any_prop_you_want_to_change = \'any_thing_you_want_change_to\'\nthis.update()\n```\n\n### setData \xe5\x92\x8c update \xe5\xaf\xb9\xe6\xaf\x94\n\n\xe6\x8b\xbf\xe5\xae\x98\xe6\x96\xb9\xe6\xa8\xa1\xe6\x9d\xbf\xe7\xa4\xba\xe4\xbe\x8b\xe7\x9a\x84 log \xe9\xa1\xb5\xe9\x9d\xa2\xe4\xbd\x9c\xe4\xb8\xba\xe4\xbe\x8b\xe5\xad\x90:\n\n```js\nthis.setData({\n  logs: (wx.getStorageSync(\'logs\') || []).map(log => {\n    return util.formatTime(new Date(log))\n  })\n}, () => {\n  console.log(\'setData\xe5\xae\x8c\xe6\x88\x90\xe4\xba\x86\')\n})\n```\n\n\xe4\xbd\xbf\xe7\x94\xa8 westore \xe5\x90\x8e:\n\n``` js\nthis.store.data.logs = (wx.getStorageSync(\'logs\') || []).map(log => {\n  return util.formatTime(new Date(log))\n})\nthis.update().then(diff => {\n  console.log(\'setData\xe5\xae\x8c\xe6\x88\x90\xe4\xba\x86\')\n  console.log(\'\xe6\x9b\xb4\xe6\x96\xb0\xe5\x86\x85\xe5\xae\xb9\xe4\xb8\xba\', diff)\n})\n```\n\n\xe7\x9c\x8b\xe4\xbc\xbc\xe4\xb8\x80\xe6\x9d\xa1\xe8\xaf\xad\xe5\x8f\xa5\xe5\x8f\x98\xe6\x88\x90\xe4\xba\x86\xe4\xb8\xa4\xe6\x9d\xa1\xe8\xaf\xad\xe5\x8f\xa5\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf this.update \xe8\xb0\x83\xe7\x94\xa8\xe7\x9a\x84 setData \xe6\x98\xaf diff \xe5\x90\x8e\xe7\x9a\x84\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe4\xbc\xa0\xe9\x80\x92\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xae\xe6\x9b\xb4\xe5\xb0\x91\xe3\x80\x82\n\n### \xe8\xb7\xa8\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x90\x8c\xe6\xad\xa5\xe6\x95\xb0\xe6\x8d\xae\n\n\xe4\xbd\xbf\xe7\x94\xa8 westore \xe4\xbd\xa0\xe4\xb8\x8d\xe7\x94\xa8\xe5\x85\xb3\xe5\xbf\x83\xe8\xb7\xa8\xe9\xa1\xb5\xe6\x95\xb0\xe6\x8d\xae\xe5\x90\x8c\xe6\xad\xa5\xef\xbc\x8c\xe4\xbd\xa0\xe5\x8f\xaa\xe9\x9c\x80\xe8\xa6\x81\xe4\xb8\x93\xe6\xb3\xa8 this.store.data \xe4\xbe\xbf\xe5\x8f\xaf\xef\xbc\x8c\xe4\xbf\xae\xe6\x94\xb9\xe5\xae\x8c\xe5\x9c\xa8\xe4\xbb\xbb\xe6\x84\x8f\xe5\x9c\xb0\xe6\x96\xb9\xe8\xb0\x83\xe7\x94\xa8 update \xe4\xbe\xbf\xe5\x8f\xaf\xef\xbc\x9a\n\n```js\nthis.update()\n```\n\n### \xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\n\n\xe8\xbf\x99\xe9\x87\x8c\xe8\xaf\xb4\xe7\x9a\x84\xe7\xbb\x84\xe4\xbb\xb6\xe4\xbe\xbf\xe6\x98\xaf\xe8\x87\xaa\xe5\xae\x9a\xe4\xb9\x89\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x8c\xe4\xbd\xbf\xe7\x94\xa8\xe5\x8e\x9f\xe7\x94\x9f\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe5\xbc\x80\xe5\x8f\x91\xe6\xa0\xbc\xe5\xbc\x8f\xe5\xa6\x82\xe4\xb8\x8b:\n\n```js\n\nComponent({\n  properties: { },\n\n  data: { },\n\n  methods: { }\n})\n```\n\n\xe4\xbd\xbf\xe7\x94\xa8 Westore \xe4\xb9\x8b\xe5\x90\x8e:\n\n```js\nimport create from \'../../utils/create\'\n\ncreate({\n  properties: { },\n\n  data: { },\n\n  methods: { }\n})\n```\n\n\xe7\x9c\x8b\xe7\x9d\x80\xe5\xb7\xae\xe5\x88\xab\xe4\xb8\x8d\xe5\xa4\xa7\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf\xe5\x8c\xba\xe5\x88\xab\xef\xbc\x9a\n\n* Component \xe7\x9a\x84\xe6\x96\xb9\xe5\xbc\x8f\xe4\xbd\xbf\xe7\x94\xa8 setData \xe6\x9b\xb4\xe6\x96\xb0\xe8\xa7\x86\xe5\x9b\xbe\n* create \xe7\x9a\x84\xe6\x96\xb9\xe5\xbc\x8f\xe7\x9b\xb4\xe6\x8e\xa5\xe6\x9b\xb4\xe6\x94\xb9 store.data \xe7\x84\xb6\xe5\x90\x8e\xe8\xb0\x83\xe7\x94\xa8 update\n* create \xe7\x9a\x84\xe6\x96\xb9\xe5\xbc\x8f\xe5\x8f\xaf\xe4\xbb\xa5\xe4\xbd\xbf\xe7\x94\xa8\xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\xef\xbc\x8cComponent \xe4\xb8\x8d\xe5\x8f\xaf\xe4\xbb\xa5\xef\xbc\x8c\xe5\xa6\x82\xef\xbc\x9a\n\n```js\nexport default {\n  data: {\n    firstName: \'dnt\',\n    lastName: \'zhang\',\n    fullName:function(){\n      return this.firstName + this.lastName\n    }\n  }\n}\n```\n\n\xe7\xbb\x91\xe5\xae\x9a\xe5\x88\xb0\xe8\xa7\x86\xe5\x9b\xbe:\n\n```jsx\n<view>{{fullName}}</view>\n```\n\n\xe6\x9c\x89\xe4\xb8\x80\xe4\xba\x9b\xe7\xbb\x84\xe4\xbb\xb6\xe5\x8c\xba\xe5\x88\xab\xe4\xba\x8e\xe4\xb8\x9a\xe5\x8a\xa1\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x8c\xe5\x8f\xab\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe3\x80\x82\xe5\xa6\x82 tip\xe3\x80\x81alert\xe3\x80\x81dialog\xe3\x80\x81pager\xe3\x80\x81\xe6\x97\xa5\xe5\x8e\x86\xe7\xad\x89\xef\xbc\x8c\xe4\xb8\x8e\xe4\xb8\x9a\xe5\x8a\xa1\xe6\x95\xb0\xe6\x8d\xae\xe6\x97\xa0\xe7\x9b\xb4\xe6\x8e\xa5\xe8\x80\xa6\xe5\x90\x88\xe5\x85\xb3\xe7\xb3\xbb\xe3\x80\x82\n\xe7\xbb\x84\xe4\xbb\xb6\xe7\x9a\x84\xe6\x98\xbe\xe7\xa4\xba\xe7\x8a\xb6\xe6\x80\x81\xe7\x94\xb1\xe4\xbc\xa0\xe5\x85\xa5\xe7\x9a\x84 props \xe5\x86\xb3\xe5\xae\x9a\xef\xbc\x8c\xe4\xb8\x8e\xe5\xa4\x96\xe7\x95\x8c\xe7\x9a\x84\xe9\x80\x9a\xe8\xae\xaf\xe9\x80\x9a\xe8\xbf\x87\xe5\x86\x85\xe9\x83\xa8 triggerEvent \xe6\x9a\xb4\xe9\x9c\xb2\xe7\x9a\x84\xe5\x9b\x9e\xe8\xb0\x83\xe3\x80\x82\ntriggerEvent \xe7\x9a\x84\xe5\x9b\x9e\xe8\xb0\x83\xe5\x87\xbd\xe6\x95\xb0\xe5\x8f\xaf\xe4\xbb\xa5\xe6\x94\xb9\xe5\x8f\x98\xe5\x85\xa8\xe5\xb1\x80\xe7\x8a\xb6\xe6\x80\x81\xef\xbc\x8c\xe5\xae\x9e\xe7\x8e\xb0\xe5\x8d\x95\xe5\x90\x91\xe6\x95\xb0\xe6\x8d\xae\xe6\xb5\x81\xe5\x90\x8c\xe6\xad\xa5\xe6\x89\x80\xe6\x9c\x89\xe7\x8a\xb6\xe6\x80\x81\xe7\xbb\x99\xe5\x85\xb6\xe4\xbb\x96\xe5\x85\x84\xe5\xbc\x9f\xe3\x80\x81\xe5\xa0\x82\xe5\x85\x84\xe3\x80\x81\xe5\xa7\x91\xe5\xa7\x91\xe7\xad\x89\xe7\xbb\x84\xe4\xbb\xb6\xe6\x88\x96\xe8\x80\x85\xe5\x85\xb6\xe4\xbb\x96\xe9\xa1\xb5\xe9\x9d\xa2\xe3\x80\x82\n\nWestore\xe9\x87\x8c\xe5\x8f\xaf\xe4\xbb\xa5\xe4\xbd\xbf\xe7\x94\xa8 `create({ pure: true })` \xe5\x88\x9b\xe5\xbb\xba\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x88\xe5\xbd\x93\xe7\x84\xb6\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe7\x9b\xb4\xe6\x8e\xa5\xe4\xbd\xbf\xe7\x94\xa8 Component\xef\xbc\x89\xef\xbc\x8c\xe6\xaf\x94\xe5\xa6\x82 \xef\xbc\x9a\n\n```js\n\nimport create from \'../../utils/create\'\n\ncreate({\n  pure : true,\n\n  properties: {\n    text: {\n      type: String,\n      value: \'\',\n      observer(newValue, oldValue) { }\n    }\n  },\n\n  data: {\n    privateData: \'privateData\'\n  },\n\n  ready: function () {\n    console.log(this.properties.text)\n  },\n\n  methods: {\n    onTap: function(){\n      this.store.data.privateData = \'\xe6\x88\x90\xe5\x8a\x9f\xe4\xbf\xae\xe6\x94\xb9 privateData\'\n      this.update()\n      this.triggerEvent(\'random\', {rd:\'\xe6\x88\x90\xe5\x8a\x9f\xe5\x8f\x91\xe8\xb5\xb7\xe5\x8d\x95\xe5\x90\x91\xe6\x95\xb0\xe6\x8d\xae\xe6\xb5\x81\' + Math.floor( Math.random()*1000)})\n    }\n  }\n})\n```\n\n\xe9\x9c\x80\xe8\xa6\x81\xe6\xb3\xa8\xe6\x84\x8f\xe7\x9a\x84\xe6\x98\xaf\xef\xbc\x8c\xe5\x8a\xa0\xe4\xb8\x8a `pure : true` \xe4\xb9\x8b\xe5\x90\x8e\xe5\xb0\xb1\xe6\x98\xaf\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x8c\xe7\xbb\x84\xe4\xbb\xb6\xe7\x9a\x84 data \xe4\xb8\x8d\xe4\xbc\x9a\xe8\xa2\xab\xe5\x90\x88\xe5\xb9\xb6\xe5\x88\xb0\xe5\x85\xa8\xe5\xb1\x80\xe7\x9a\x84 store.data \xe4\xb8\x8a\xe3\x80\x82\n\n\xe7\xbb\x84\xe4\xbb\xb6\xe5\x8c\xba\xe5\x88\x86\xe4\xb8\x9a\xe5\x8a\xa1\xe7\xbb\x84\xe4\xbb\xb6\xe5\x92\x8c\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x8c\xe4\xbb\x96\xe4\xbb\xac\xe7\x9a\x84\xe5\x8c\xba\xe5\x88\xab\xe5\xa6\x82\xe4\xb8\x8b\xef\xbc\x9a\n\n* \xe4\xb8\x9a\xe5\x8a\xa1\xe7\xbb\x84\xe4\xbb\xb6\xe4\xb8\x8e\xe4\xb8\x9a\xe5\x8a\xa1\xe6\x95\xb0\xe6\x8d\xae\xe7\xb4\xa7\xe8\x80\xa6\xe5\x90\x88\xef\xbc\x8c\xe6\x8d\xa2\xe4\xb8\x80\xe4\xb8\xaa\xe9\xa1\xb9\xe7\x9b\xae\xe5\x8f\xaf\xe8\x83\xbd\xe8\xaf\xa5\xe7\xbb\x84\xe4\xbb\xb6\xe5\xb0\xb1\xe7\x94\xa8\xe4\xb8\x8d\xe4\xb8\x8a\xef\xbc\x8c\xe9\x99\xa4\xe9\x9d\x9e\xe9\x9d\x9e\xe5\xb8\xb8\xe7\xb1\xbb\xe4\xbc\xbc\xe7\x9a\x84\xe9\xa1\xb9\xe7\x9b\xae\n* \xe4\xb8\x9a\xe5\x8a\xa1\xe7\xbb\x84\xe4\xbb\xb6\xe9\x80\x9a\xe8\xbf\x87 store \xe8\x8e\xb7\xe5\xbe\x97\xe6\x89\x80\xe9\x9c\x80\xe5\x8f\x82\xe6\x95\xb0\xef\xbc\x8c\xe9\x80\x9a\xe8\xbf\x87\xe6\x9b\xb4\xe6\x94\xb9 store \xe4\xb8\x8e\xe5\xa4\x96\xe7\x95\x8c\xe9\x80\x9a\xe8\xae\xaf\n* \xe4\xb8\x9a\xe5\x8a\xa1\xe7\xbb\x84\xe4\xbb\xb6\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe9\x80\x9a\xe8\xbf\x87 props \xe8\x8e\xb7\xe5\xbe\x97\xe6\x89\x80\xe9\x9c\x80\xe5\x8f\x82\xe6\x95\xb0\xef\xbc\x8c\xe9\x80\x9a\xe8\xbf\x87 triggerEvent \xe4\xb8\x8e\xe5\xa4\x96\xe7\x95\x8c\xe9\x80\x9a\xe8\xae\xaf\n* \xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe4\xb8\x8e\xe4\xb8\x9a\xe5\x8a\xa1\xe6\x95\xb0\xe6\x8d\xae\xe6\x97\xa0\xe5\x85\xb3\xef\xbc\x8c\xe5\x8f\xaf\xe7\xa7\xbb\xe6\xa4\x8d\xe5\x92\x8c\xe5\xa4\x8d\xe7\x94\xa8\n* \xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe5\x8f\xaa\xe8\x83\xbd\xe9\x80\x9a\xe8\xbf\x87 props \xe8\x8e\xb7\xe5\xbe\x97\xe6\x89\x80\xe9\x9c\x80\xe5\x8f\x82\xe6\x95\xb0\xef\xbc\x8c\xe9\x80\x9a\xe8\xbf\x87 triggerEvent \xe4\xb8\x8e\xe5\xa4\x96\xe7\x95\x8c\xe9\x80\x9a\xe8\xae\xaf\n\n\xe5\xa4\xa7\xe5\x9e\x8b\xe9\xa1\xb9\xe7\x9b\xae\xe4\xb8\x80\xe5\xae\x9a\xe4\xbc\x9a\xe5\x8c\x85\xe5\x90\xab\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xe3\x80\x81\xe4\xb8\x9a\xe5\x8a\xa1\xe7\xbb\x84\xe4\xbb\xb6\xe3\x80\x82\xe9\x80\x9a\xe8\xbf\x87\xe7\xba\xaf\xe7\xbb\x84\xe4\xbb\xb6\xef\xbc\x8c\xe5\x8f\xaf\xe4\xbb\xa5\xe5\xbe\x88\xe5\xa5\xbd\xe7\x90\x86\xe8\xa7\xa3\xe5\x8d\x95\xe5\x90\x91\xe6\x95\xb0\xe6\x8d\xae\xe6\xb5\x81:\n\n![data-flow](./asset/data-flow2.jpg)\n\n### \xe8\xb0\x83\xe8\xaf\x95\n\n```js\nconsole.log(getApp().globalData.store.data)\n```\n\n### \xe8\xb6\x85\xe5\xa4\xa7\xe5\x9e\x8b\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\x9c\x80\xe4\xbd\xb3\xe5\xae\x9e\xe8\xb7\xb5(\xe4\xb8\xa4\xe7\xa7\x8d\xe6\x96\xb9\xe6\xa1\x88)\n\n\xe4\xb8\x8d\xe6\x8e\x92\xe9\x99\xa4\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe8\xa2\xab\xe5\x81\x9a\xe5\xa4\xa7\xe5\xbe\x97\xe5\x8f\xaf\xe8\x83\xbd\xef\xbc\x8c\xe6\x8e\xa5\xe8\xa7\xa6\xe7\x9a\x84\xe6\x9c\x80\xe5\xa4\xa7\xe7\x9a\x84\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe6\x9c\x89 60+ \xe7\x9a\x84\xe9\xa1\xb5\xe9\x9d\xa2\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe6\x80\x8e\xe4\xb9\x88\xe7\xae\xa1\xe7\x90\x86\xef\xbc\x9f\xe8\xbf\x99\xe9\x87\x8c\xe7\xbb\x99\xe5\x87\xba\xe4\xba\x86\xe4\xb8\xa4\xe4\xb8\xaa\xe6\x9c\x80\xe4\xbd\xb3\xe5\xae\x9e\xe8\xb7\xb5\xe6\x96\xb9\xe6\xa1\x88\xe3\x80\x82\n\n* \xe7\xac\xac\xe4\xb8\x80\xe7\xa7\x8d\xe6\x96\xb9\xe6\xa1\x88\xef\xbc\x8c\xe6\x8b\x86\xe5\x88\x86 store \xe7\x9a\x84 data \xe4\xb8\xba\xe4\xb8\x8d\xe5\x90\x8c\xe6\xa8\xa1\xe5\x9d\x97\xef\xbc\x8c\xe5\xa6\x82:\n\n```js\nexport default {\n  data: {\n    commonA: \'a\',\n    commonB: \'b\',\n    pageA: {\n      a: 1\n      xx: \'xxx\'\n    },\n    pageB: {\n      b: 2,\n      c: 3\n    }\n  },\n  xxx: function () {\n    console.log(this.data)\n  }\n}\n```\n\n* \xe7\xac\xac\xe4\xba\x8c\xe7\xa7\x8d\xe6\x96\xb9\xe6\xa1\x88\xef\xbc\x8c\xe6\x8b\x86\xe5\x88\x86 store \xe7\x9a\x84 data \xe5\x88\xb0\xe4\xb8\x8d\xe5\x90\x8c\xe6\x96\x87\xe4\xbb\xb6\xe4\xb8\x94\xe5\x90\x88\xe5\xb9\xb6\xe5\x88\xb0\xe4\xb8\x80\xe4\xb8\xaa store \xe6\x9a\xb4\xe9\x9c\xb2\xe7\xbb\x99 create \xe6\x96\xb9\xe6\xb3\x95\xef\xbc\x8c\xe5\xa6\x82\xef\xbc\x9a\n\na.js\n\n```js\nexport default {\n  data: {\n    a: 1\n    xx: \'xxx\'\n  },\n  aMethod: function (num) {\n    this.data.a += num\n  }\n}\n```\n\nb.js\n\n\n```js\nexport default {\n  data: {\n    b: 2,\n    c: 3\n  },\n  bMethod: function () {\n\n  }\n}\n```\n\nstore.js\n\n```js\nimport a from \'a.js\'\nimport b from \'b.js\'\n\nexport default {\n  data: {\n    commonNum: 1,\n    commonB: \'b\',\n    pageA: a.data\n    pageB: b.data\n  },\n  xxx: function () {\n    //you can call the methods of a or b and can pass args to them\n    console.log(a.aMethod(commonNum))\n  },\n  xx: function(){\n\n  }\n}\n```\n\n\xe5\xbd\x93\xe7\x84\xb6\xef\xbc\x8c\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe4\xb8\x8d\xe7\x94\xa8\xe6\x8c\x89\xe7\x85\xa7\xe9\xa1\xb5\xe9\x9d\xa2\xe6\x8b\x86\xe5\x88\x86\xe6\x96\x87\xe4\xbb\xb6\xe6\x88\x96\xe6\xa8\xa1\xe5\x9d\x97\xef\xbc\x8c\xe4\xb9\x9f\xe5\x8f\xaf\xe4\xbb\xa5\xe6\x8c\x89\xe7\x85\xa7\xe9\xa2\x86\xe5\x9f\x9f\xe6\x9d\xa5\xe6\x8b\x86\xe5\x88\x86\xef\xbc\x8c\xe8\xbf\x99\xe4\xb8\xaa\xe5\xbe\x88\xe8\x87\xaa\xe7\x94\xb1\xef\xbc\x8c\xe8\xa7\x86\xe6\x83\x85\xe5\x86\xb5\xe8\x80\x8c\xe5\xae\x9a\xe3\x80\x82\n\n## \xe6\xb3\xa8\xe6\x84\x8f\xe4\xba\x8b\xe9\xa1\xb9\n\n\xe8\xa7\xa3\xe5\x86\xb3\xe5\x85\x83\xe7\xb4\xa0\xe7\xbb\x84\xe4\xbb\xb6\xe7\x8a\xb6\xe6\x80\x81\xe4\xb8\x8d\xe5\x90\x8c\xe6\xad\xa5\xe7\x9a\x84\xe9\x97\xae\xe9\xa2\x98\xef\xbc\x8c\xe6\xaf\x94\xe5\xa6\x82 switch \xe9\x9c\x80\xe8\xa6\x81\xe9\x80\x9a\xe8\xbf\x87\xe7\xbb\x91\xe5\xae\x9a bindtap \xe5\x8e\xbb\xe8\xae\xb0\xe5\xbd\x95\xe7\x8a\xb6\xe6\x80\x81\xef\xbc\x8c\xe4\xb8\x8d\xe7\x84\xb6\xe6\x97\xa0\xe6\xb3\x95 diff \xe5\x87\xba\xe6\x9b\xb4\xe6\x94\xb9\xef\xbc\x9a\n\n```html\n<switch bindtap=\'switchTap\' checked="{{value}}"></switch>\n```\n\n```js\n  switchTap() {\n    this.store.data.value = !this.store.data.value\n    this.update()\n  },\n  restore() {\n    this.store.data.value = true\n    this.update()\n  }\n```\n\n\xe5\x8e\x9f\xe6\x9c\xac\xe6\x98\xaf\xe7\x94\xa8\xe6\x88\xb7\xe4\xba\xa4\xe4\xba\x92\xe7\x8a\xb6\xe6\x80\x81\xe4\xb8\x8d\xe5\xbd\xb1\xe5\x93\x8d data \xe7\x9a\x84\xef\xbc\x8c\xe9\x9c\x80\xe8\xa6\x81\xe7\x89\xb9\xe5\x88\xab\xe6\xb3\xa8\xe6\x84\x8f\xe5\x90\x8c\xe6\xad\xa5 data \xe5\x88\xb0 store.data\xef\xbc\x8c\xe4\xb8\x8d\xe7\x84\xb6\xe6\x97\xa0\xe6\xb3\x95 diff \xe5\x87\xba patch\xef\xbc\x8c\xe5\xa4\x9a\xe8\xb0\xa2 @i7soft\xe3\x80\x82\n\n## \xe5\x8e\x9f\xe7\x90\x86\n\n```\n ---------------       -------------------        -----------------------\n| this.update  |  \xe2\x86\x92  |     json diff     |   \xe2\x86\x92  | setData()-setData()...|  \xe2\x86\x92  \xe4\xb9\x8b\xe5\x90\x8e\xe5\xb0\xb1\xe6\x98\xaf\xe9\xbb\x91\xe7\x9b\x92(\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe5\xae\x98\xe6\x96\xb9\xe5\xae\x9e\xe7\x8e\xb0\xef\xbc\x8c\xe4\xbd\x86\xe6\x98\xaf dom/apply diff \xe8\x82\xaf\xe5\xae\x9a\xe6\x98\xaf\xe5\xb0\x91\xe4\xb8\x8d\xe4\xba\x86)\n ---------------       -------------------        -----------------------\n```\n\n\xe8\x99\xbd\xe7\x84\xb6\xe5\x92\x8c Omi \xe4\xb8\x80\xe6\xa0\xb7\xe5\x90\x8c\xe4\xb8\xba this.updata \xe4\xbd\x86\xe6\x98\xaf\xe5\x8d\xb4\xe6\x9c\x89\xe7\x9d\x80\xe6\x9c\xac\xe8\xb4\xa8\xe7\x9a\x84\xe5\x8c\xba\xe5\x88\xab\xe3\x80\x82Omi \xe7\x9a\x84\xe5\xa6\x82\xe4\xb8\x8b:\n\n```\n ---------------       -------------------        ----------------         ------------------------------\n|  this.update  |  \xe2\x86\x92  |     setState      |   \xe2\x86\x92  |  jsx rerender  |   \xe2\x86\x92   |   vdom diff \xe2\x86\x92 apply diff...  |\n ---------------       -------------------        ----------------         ------------------------------\n```\n\n\xe9\x83\xbd\xe6\x98\xaf\xe6\x95\xb0\xe6\x8d\xae\xe9\xa9\xb1\xe5\x8a\xa8\xe8\xa7\x86\xe5\x9b\xbe\xef\xbc\x8c\xe4\xbd\x86\xe6\x9c\xac\xe8\xb4\xa8\xe4\xb8\x8d\xe5\x90\x8c\xef\xbc\x8c\xe5\x8e\x9f\xe5\x9b\xa0:\n\n* \xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f store \xe5\x92\x8c dom \xe4\xb8\x8d\xe5\x9c\xa8\xe5\x90\x8c\xe4\xb8\x80\xe4\xb8\xaa\xe7\x8e\xaf\xe5\xa2\x83\xef\xbc\x8c\xe5\x85\x88\xe5\x9c\xa8 js \xe7\x8e\xaf\xe5\xa2\x83\xe8\xbf\x9b\xe8\xa1\x8c json diff\xef\xbc\x8c\xe7\x84\xb6\xe5\x90\x8e\xe4\xbd\xbf\xe7\x94\xa8 diff \xe7\xbb\x93\xe6\x9e\x9c\xe9\x80\x9a\xe8\xbf\x87 setData \xe9\x80\x9a\xe8\xae\xaf\xe5\x91\x8a\xe8\xaf\x89 webview\n* Web \xe9\x87\x8c\xe4\xbd\xbf\xe7\x94\xa8 omi \xe7\x9a\x84\xe8\xaf\x9d store \xe5\x92\x8c dom \xe5\x9c\xa8\xe5\x90\x8c\xe4\xb8\x80\xe7\x8e\xaf\xe5\xa2\x83\xef\xbc\x8csetState \xe7\x9b\xb4\xe6\x8e\xa5\xe9\xa9\xb1\xe5\x8a\xa8\xe7\x9a\x84 vdom diff \xe7\x84\xb6\xe5\x90\x8e\xe6\x8a\x8a diff \xe7\xbb\x93\xe6\x9e\x9c\xe4\xbd\x9c\xe7\x94\xa8\xe5\x9c\xa8\xe7\x9c\x9f\xe5\xae\x9e dom \xe4\xb8\x8a\n* Native \xe9\x87\x8c\xe4\xbd\xbf\xe7\x94\xa8 omi \xe7\x9a\x84\xe8\xaf\x9d\xef\xbc\x8comi \xe9\x80\x9a\xe8\xbf\x87 jsbridge \xe5\x90\x91 \xe5\xae\xa2\xe6\x88\xb7\xe7\xab\xaf\xe5\x8f\x91\xe9\x80\x81\xe7\x9a\x84\xe6\x98\xaf dom \xe6\x8c\x87\xe4\xbb\xa4\xe8\x80\x8c\xe9\x9d\x9e \xe6\x95\xb0\xe6\x8d\xae\n\n### JSON Diff\n\n\xe5\x85\x88\xe7\x9c\x8b\xe4\xb8\x80\xe4\xb8\x8b\xe6\x88\x91\xe4\xb8\xba westore \xe4\xb8\x93\xe9\x97\xa8\xe5\xae\x9a\xe5\x88\xb6\xe5\xbc\x80\xe5\x8f\x91\xe7\x9a\x84 [JSON Diff \xe5\xba\x93](https://github.com/dntzhang/westore/blob/master/packages/westore/utils/diff.js) \xe7\x9a\x84\xe8\x83\xbd\xe5\x8a\x9b:\n\n``` js\ndiff({\n    a: 1, b: 2, c: "str", d: { e: [2, { a: 4 }, 5] }, f: true, h: [1], g: { a: [1, 2], j: 111 }\n}, {\n    a: [], b: "aa", c: 3, d: { e: [3, { a: 3 }] }, f: false, h: [1, 2], g: { a: [1, 1, 1], i: "delete" }, k: \'del\'\n})\n```\n\nDiff \xe7\x9a\x84\xe7\xbb\x93\xe6\x9e\x9c\xe6\x98\xaf:\n\n``` js\n{ "a": 1, "b": 2, "c": "str", "d.e[0]": 2, "d.e[1].a": 4, "d.e[2]": 5, "f": true, "h": [1], "g.a": [1, 2], "g.j": 111, "g.i": null, "k": null }\n```\n\n![diff](./asset/diff.jpg)\n\nDiff \xe5\x8e\x9f\xe7\x90\x86:\n\n* \xe5\x90\x8c\xe6\xad\xa5\xe6\x89\x80\xe6\x9c\x89 key \xe5\x88\xb0\xe5\xbd\x93\xe5\x89\x8d store.data\n* \xe6\x90\xba\xe5\xb8\xa6 path \xe5\x92\x8c result \xe9\x80\x92\xe5\xbd\x92\xe9\x81\x8d\xe5\x8e\x86\xe5\xaf\xb9\xe6\xaf\x94\xe6\x89\x80\xe6\x9c\x89 key value\n\n``` js\nexport default function diff(current, pre) {\n    const result = {}\n    syncKeys(current, pre)\n    _diff(current, pre, \'\', result)\n    return result\n}\n```\n\n\xe5\x90\x8c\xe6\xad\xa5\xe4\xb8\x8a\xe4\xb8\x80\xe8\xbd\xae state.data \xe7\x9a\x84 key \xe4\xb8\xbb\xe8\xa6\x81\xe6\x98\xaf\xe4\xb8\xba\xe4\xba\x86\xe6\xa3\x80\xe6\xb5\x8b array \xe4\xb8\xad\xe5\x88\xa0\xe9\x99\xa4\xe7\x9a\x84\xe5\x85\x83\xe7\xb4\xa0\xe6\x88\x96\xe8\x80\x85 obj \xe4\xb8\xad\xe5\x88\xa0\xe9\x99\xa4\xe7\x9a\x84 key\xe3\x80\x82\n\n### \xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f setData\n\nsetData \xe6\x98\xaf\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe5\xbc\x80\xe5\x8f\x91\xe4\xb8\xad\xe4\xbd\xbf\xe7\x94\xa8\xe6\x9c\x80\xe9\xa2\x91\xe7\xb9\x81\xe7\x9a\x84\xe6\x8e\xa5\xe5\x8f\xa3\xef\xbc\x8c\xe4\xb9\x9f\xe6\x98\xaf\xe6\x9c\x80\xe5\xae\xb9\xe6\x98\x93\xe5\xbc\x95\xe5\x8f\x91\xe6\x80\xa7\xe8\x83\xbd\xe9\x97\xae\xe9\xa2\x98\xe7\x9a\x84\xe6\x8e\xa5\xe5\x8f\xa3\xe3\x80\x82\xe5\x9c\xa8\xe4\xbb\x8b\xe7\xbb\x8d\xe5\xb8\xb8\xe8\xa7\x81\xe7\x9a\x84\xe9\x94\x99\xe8\xaf\xaf\xe7\x94\xa8\xe6\xb3\x95\xe5\x89\x8d\xef\xbc\x8c\xe5\x85\x88\xe7\xae\x80\xe5\x8d\x95\xe4\xbb\x8b\xe7\xbb\x8d\xe4\xb8\x80\xe4\xb8\x8b setData \xe8\x83\x8c\xe5\x90\x8e\xe7\x9a\x84\xe5\xb7\xa5\xe4\xbd\x9c\xe5\x8e\x9f\xe7\x90\x86\xe3\x80\x82setData \xe5\x87\xbd\xe6\x95\xb0\xe7\x94\xa8\xe4\xba\x8e\xe5\xb0\x86\xe6\x95\xb0\xe6\x8d\xae\xe4\xbb\x8e\xe9\x80\xbb\xe8\xbe\x91\xe5\xb1\x82\xe5\x8f\x91\xe9\x80\x81\xe5\x88\xb0\xe8\xa7\x86\xe5\x9b\xbe\xe5\xb1\x82\xef\xbc\x88\xe5\xbc\x82\xe6\xad\xa5\xef\xbc\x89\xef\xbc\x8c\xe5\x90\x8c\xe6\x97\xb6\xe6\x94\xb9\xe5\x8f\x98\xe5\xaf\xb9\xe5\xba\x94\xe7\x9a\x84 this.data \xe7\x9a\x84\xe5\x80\xbc\xef\xbc\x88\xe5\x90\x8c\xe6\xad\xa5\xef\xbc\x89\xe3\x80\x82\n\n\xe5\x85\xb6\xe4\xb8\xad key \xe5\x8f\xaf\xe4\xbb\xa5\xe4\xbb\xa5\xe6\x95\xb0\xe6\x8d\xae\xe8\xb7\xaf\xe5\xbe\x84\xe7\x9a\x84\xe5\xbd\xa2\xe5\xbc\x8f\xe7\xbb\x99\xe5\x87\xba\xef\xbc\x8c\xe6\x94\xaf\xe6\x8c\x81\xe6\x94\xb9\xe5\x8f\x98\xe6\x95\xb0\xe7\xbb\x84\xe4\xb8\xad\xe7\x9a\x84\xe6\x9f\x90\xe4\xb8\x80\xe9\xa1\xb9\xe6\x88\x96\xe5\xaf\xb9\xe8\xb1\xa1\xe7\x9a\x84\xe6\x9f\x90\xe4\xb8\xaa\xe5\xb1\x9e\xe6\x80\xa7\xef\xbc\x8c\xe5\xa6\x82 array[2].message\xef\xbc\x8ca.b.c.d\xef\xbc\x8c\xe5\xb9\xb6\xe4\xb8\x94\xe4\xb8\x8d\xe9\x9c\x80\xe8\xa6\x81\xe5\x9c\xa8 this.data \xe4\xb8\xad\xe9\xa2\x84\xe5\x85\x88\xe5\xae\x9a\xe4\xb9\x89\xe3\x80\x82\xe6\xaf\x94\xe5\xa6\x82\xef\xbc\x9a\n\n```js\nthis.setData({\n      \'array[0].text\':\'changed data\'\n})\n```\n\n\xe6\x89\x80\xe4\xbb\xa5 diff \xe7\x9a\x84\xe7\xbb\x93\xe6\x9e\x9c\xe5\x8f\xaf\xe4\xbb\xa5\xe7\x9b\xb4\xe6\x8e\xa5\xe4\xbc\xa0\xe9\x80\x92\xe7\xbb\x99 `setData`\xef\xbc\x8c\xe4\xb9\x9f\xe5\xb0\xb1\xe6\x98\xaf `this.update`\xe3\x80\x82\n\n#### setData \xe5\xb7\xa5\xe4\xbd\x9c\xe5\x8e\x9f\xe7\x90\x86\n\n\xe5\xb0\x8f\xe7\xa8\x8b\xe5\xba\x8f\xe7\x9a\x84\xe8\xa7\x86\xe5\x9b\xbe\xe5\xb1\x82\xe7\x9b\xae\xe5\x89\x8d\xe4\xbd\xbf\xe7\x94\xa8 WebView \xe4\xbd\x9c\xe4\xb8\xba\xe6\xb8\xb2\xe6\x9f\x93\xe8\xbd\xbd\xe4\xbd\x93\xef\xbc\x8c\xe8\x80\x8c\xe9\x80\xbb\xe8\xbe\x91\xe5\xb1\x82\xe6\x98\xaf\xe7\x94\xb1\xe7\x8b\xac\xe7\xab\x8b\xe7\x9a\x84 JavascriptCore \xe4\xbd\x9c\xe4\xb8\xba\xe8\xbf\x90\xe8\xa1\x8c\xe7\x8e\xaf\xe5\xa2\x83\xe3\x80\x82\xe5\x9c\xa8\xe6\x9e\xb6\xe6\x9e\x84\xe4\xb8\x8a\xef\xbc\x8cWebView \xe5\x92\x8c JavascriptCore \xe9\x83\xbd\xe6\x98\xaf\xe7\x8b\xac\xe7\xab\x8b\xe7\x9a\x84\xe6\xa8\xa1\xe5\x9d\x97\xef\xbc\x8c\xe5\xb9\xb6\xe4\xb8\x8d\xe5\x85\xb7\xe5\xa4\x87\xe6\x95\xb0\xe6\x8d\xae\xe7\x9b\xb4\xe6\x8e\xa5\xe5\x85\xb1\xe4\xba\xab\xe7\x9a\x84\xe9\x80\x9a\xe9\x81\x93\xe3\x80\x82\xe5\xbd\x93\xe5\x89\x8d\xef\xbc\x8c\xe8\xa7\x86\xe5\x9b\xbe\xe5\xb1\x82\xe5\x92\x8c\xe9\x80\xbb\xe8\xbe\x91\xe5\xb1\x82\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xae\xe4\xbc\xa0\xe8\xbe\x93\xef\xbc\x8c\xe5\xae\x9e\xe9\x99\x85\xe4\xb8\x8a\xe9\x80\x9a\xe8\xbf\x87\xe4\xb8\xa4\xe8\xbe\xb9\xe6\x8f\x90\xe4\xbe\x9b\xe7\x9a\x84 evaluateJavascript \xe6\x89\x80\xe5\xae\x9e\xe7\x8e\xb0\xe3\x80\x82\xe5\x8d\xb3\xe7\x94\xa8\xe6\x88\xb7\xe4\xbc\xa0\xe8\xbe\x93\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xae\xef\xbc\x8c\xe9\x9c\x80\xe8\xa6\x81\xe5\xb0\x86\xe5\x85\xb6\xe8\xbd\xac\xe6\x8d\xa2\xe4\xb8\xba\xe5\xad\x97\xe7\xac\xa6\xe4\xb8\xb2\xe5\xbd\xa2\xe5\xbc\x8f\xe4\xbc\xa0\xe9\x80\x92\xef\xbc\x8c\xe5\x90\x8c\xe6\x97\xb6\xe6\x8a\x8a\xe8\xbd\xac\xe6\x8d\xa2\xe5\x90\x8e\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xae\xe5\x86\x85\xe5\xae\xb9\xe6\x8b\xbc\xe6\x8e\xa5\xe6\x88\x90\xe4\xb8\x80\xe4\xbb\xbd JS \xe8\x84\x9a\xe6\x9c\xac\xef\xbc\x8c\xe5\x86\x8d\xe9\x80\x9a\xe8\xbf\x87\xe6\x89\xa7\xe8\xa1\x8c JS \xe8\x84\x9a\xe6\x9c\xac\xe7\x9a\x84\xe5\xbd\xa2\xe5\xbc\x8f\xe4\xbc\xa0\xe9\x80\x92\xe5\x88\xb0\xe4\xb8\xa4\xe8\xbe\xb9\xe7\x8b\xac\xe7\xab\x8b\xe7\x8e\xaf\xe5\xa2\x83\xe3\x80\x82\n\n\xe8\x80\x8c evaluateJavascript \xe7\x9a\x84\xe6\x89\xa7\xe8\xa1\x8c\xe4\xbc\x9a\xe5\x8f\x97\xe5\xbe\x88\xe5\xa4\x9a\xe6\x96\xb9\xe9\x9d\xa2\xe7\x9a\x84\xe5\xbd\xb1\xe5\x93\x8d\xef\xbc\x8c\xe6\x95\xb0\xe6\x8d\xae\xe5\x88\xb0\xe8\xbe\xbe\xe8\xa7\x86\xe5\x9b\xbe\xe5\xb1\x82\xe5\xb9\xb6\xe4\xb8\x8d\xe6\x98\xaf\xe5\xae\x9e\xe6\x97\xb6\xe7\x9a\x84\xe3\x80\x82\n\n\xe5\xb8\xb8\xe8\xa7\x81\xe7\x9a\x84 setData \xe6\x93\x8d\xe4\xbd\x9c\xe9\x94\x99\xe8\xaf\xaf:\n\n* \xe9\xa2\x91\xe7\xb9\x81\xe7\x9a\x84\xe5\x8e\xbb setData\n* \xe6\xaf\x8f\xe6\xac\xa1 setData \xe9\x83\xbd\xe4\xbc\xa0\xe9\x80\x92\xe5\xa4\xa7\xe9\x87\x8f\xe6\x96\xb0\xe6\x95\xb0\xe6\x8d\xae\n* \xe5\x90\x8e\xe5\x8f\xb0\xe6\x80\x81\xe9\xa1\xb5\xe9\x9d\xa2\xe8\xbf\x9b\xe8\xa1\x8c setData\n\n\xe4\xb8\x8a\xe9\x9d\xa2\xe6\x98\xaf\xe5\xae\x98\xe6\x96\xb9\xe6\x88\xaa\xe5\x8f\x96\xe7\x9a\x84\xe5\x86\x85\xe5\xae\xb9\xe3\x80\x82\xe4\xbd\xbf\xe7\x94\xa8 webstore \xe7\x9a\x84 this.update \xe6\x9c\xac\xe8\xb4\xa8\xe6\x98\xaf\xe5\x85\x88 diff\xef\xbc\x8c\xe5\x86\x8d\xe6\x89\xa7\xe8\xa1\x8c\xe4\xb8\x80\xe8\xbf\x9e\xe4\xb8\xb2\xe7\x9a\x84 setData\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe5\x8f\xaf\xe4\xbb\xa5\xe4\xbf\x9d\xe8\xaf\x81\xe4\xbc\xa0\xe9\x80\x92\xe7\x9a\x84\xe6\x95\xb0\xe6\x8d\xae\xe6\xaf\x8f\xe6\xac\xa1\xe7\xbb\xb4\xe6\x8c\x81\xe5\x9c\xa8\xe6\x9c\x80\xe5\xb0\x8f\xe3\x80\x82\xe6\x97\xa2\xe7\x84\xb6\xe5\x8f\xaf\xe4\xbb\xa5\xe4\xbd\xbf\xe5\xbe\x97\xe4\xbc\xa0\xe9\x80\x92\xe6\x95\xb0\xe6\x8d\xae\xe6\x9c\x80\xe5\xb0\x8f\xef\xbc\x8c\xe6\x89\x80\xe4\xbb\xa5\xe7\xac\xac\xe4\xb8\x80\xe7\x82\xb9\xe5\x92\x8c\xe7\xac\xac\xe4\xb8\x89\xe7\x82\xb9\xe8\x99\xbd\xe6\x9c\x89\xe8\xbf\x9d\xe5\x8f\x8d\xe4\xbd\x86\xe5\x8f\xaf\xe4\xbb\xa5\xe5\x95\x86\xe6\xa6\xb7\xe3\x80\x82\n\n### Update\n\n#### \xe9\xa1\xb5\xe9\x9d\xa2\xe7\x94\x9f\xe5\x91\xbd\xe5\x91\xa8\xe6\x9c\x9f\xe5\x87\xbd\xe6\x95\xb0\n\n| \xe5\x90\x8d\xe7\xa7\xb0 | \xe6\x8f\x8f\xe8\xbf\xb0  |\n| ------ | ------  |\n| onLoad | \t\xe7\x9b\x91\xe5\x90\xac\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x8a\xa0\xe8\xbd\xbd\t  |\n| onShow | \xe7\x9b\x91\xe5\x90\xac\xe9\xa1\xb5\xe9\x9d\xa2\xe6\x98\xbe\xe7\xa4\xba\t  |\n| onReady | \xe7\x9b\x91\xe5\x90\xac\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x88\x9d\xe6\xac\xa1\xe6\xb8\xb2\xe6\x9f\x93\xe5\xae\x8c\xe6\x88\x90  |\n| onHide | \xe7\x9b\x91\xe5\x90\xac\xe9\xa1\xb5\xe9\x9d\xa2\xe9\x9a\x90\xe8\x97\x8f\t  |\n| onUnload | \xe7\x9b\x91\xe5\x90\xac\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x8d\xb8\xe8\xbd\xbd  |\n\n### \xe7\xbb\x84\xe4\xbb\xb6\xe7\x94\x9f\xe5\x91\xbd\xe5\x91\xa8\xe6\x9c\x9f\xe5\x87\xbd\xe6\x95\xb0\n\n| \xe5\x90\x8d\xe7\xa7\xb0 | \xe6\x8f\x8f\xe8\xbf\xb0  |\n| ------ | ------  |\n| created | \t\xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\xae\x9e\xe4\xbe\x8b\xe8\xbf\x9b\xe5\x85\xa5\xe9\xa1\xb5\xe9\x9d\xa2\xe8\x8a\x82\xe7\x82\xb9\xe6\xa0\x91\xe6\x97\xb6\xe6\x89\xa7\xe8\xa1\x8c\xef\xbc\x8c\xe6\xb3\xa8\xe6\x84\x8f\xe6\xad\xa4\xe6\x97\xb6\xe4\xb8\x8d\xe8\x83\xbd\xe8\xb0\x83\xe7\x94\xa8 setData\t  |\n| attached | \xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\xae\x9e\xe4\xbe\x8b\xe8\xbf\x9b\xe5\x85\xa5\xe9\xa1\xb5\xe9\x9d\xa2\xe8\x8a\x82\xe7\x82\xb9\xe6\xa0\x91\xe6\x97\xb6\xe6\x89\xa7\xe8\xa1\x8c\t  |\n| ready | \xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\xb8\x83\xe5\xb1\x80\xe5\xae\x8c\xe6\x88\x90\xe5\x90\x8e\xe6\x89\xa7\xe8\xa1\x8c\xef\xbc\x8c\xe6\xad\xa4\xe6\x97\xb6\xe5\x8f\xaf\xe4\xbb\xa5\xe8\x8e\xb7\xe5\x8f\x96\xe8\x8a\x82\xe7\x82\xb9\xe4\xbf\xa1\xe6\x81\xaf\xef\xbc\x88\xe4\xbd\xbf\xe7\x94\xa8 SelectorQuery \xef\xbc\x89\t  |\n| moved | \xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\xae\x9e\xe4\xbe\x8b\xe8\xa2\xab\xe7\xa7\xbb\xe5\x8a\xa8\xe5\x88\xb0\xe8\x8a\x82\xe7\x82\xb9\xe6\xa0\x91\xe5\x8f\xa6\xe4\xb8\x80\xe4\xb8\xaa\xe4\xbd\x8d\xe7\xbd\xae\xe6\x97\xb6\xe6\x89\xa7\xe8\xa1\x8c\t  |\n| detached | \xe5\x9c\xa8\xe7\xbb\x84\xe4\xbb\xb6\xe5\xae\x9e\xe4\xbe\x8b\xe8\xa2\xab\xe4\xbb\x8e\xe9\xa1\xb5\xe9\x9d\xa2\xe8\x8a\x82\xe7\x82\xb9\xe6\xa0\x91\xe7\xa7\xbb\xe9\x99\xa4\xe6\x97\xb6\xe6\x89\xa7\xe8\xa1\x8c  |\n\n\xe8\xbf\x99\xe9\x87\x8c\xe5\x8c\xba\xe5\x88\x86\xe5\x9c\xa8\xe9\xa1\xb5\xe9\x9d\xa2\xe4\xb8\xad\xe7\x9a\x84 update \xe5\x92\x8c \xe7\xbb\x84\xe4\xbb\xb6\xe4\xb8\xad\xe7\x9a\x84 update\xe3\x80\x82\xe9\xa1\xb5\xe9\x9d\xa2\xe4\xb8\xad\xe7\x9a\x84 update \xe5\x9c\xa8 onLoad \xe4\xba\x8b\xe4\xbb\xb6\xe4\xb8\xad\xe8\xbf\x9b\xe8\xa1\x8c\xe5\xae\x9e\xe4\xbe\x8b\xe6\x94\xb6\xe9\x9b\x86\xe3\x80\x82\n\n```js\nconst onLoad = option.onLoad\noption.onLoad = function () {\n    this.store = store\n    rewriteUpdate(this)\n    store.instances[this.route] = []\n    store.instances[this.route].push(this)\n    onLoad && onLoad.call(this)\n}\nPage(option)\n```\n\n\xe7\xbb\x84\xe4\xbb\xb6\xe4\xb8\xad\xe7\x9a\x84 update \xe5\x9c\xa8 ready \xe4\xba\x8b\xe4\xbb\xb6\xe4\xb8\xad\xe8\xbf\x9b\xe8\xa1\x8c\xe8\xa1\x8c\xe5\xae\x9e\xe4\xbe\x8b\xe6\x94\xb6\xe9\x9b\x86:\n\n```js\nconst ready = store.ready\nstore.ready = function () {\n    this.page = getCurrentPages()[getCurrentPages().length - 1]\n    this.store = this.page.store\n    this.setData.call(this, this.store.data)\n    rewriteUpdate(this)\n    this.store.instances[this.page.route].push(this)\n    ready && ready.call(this)\n}\nComponent(store)\n```\n\nrewriteUpdate \xe7\x9a\x84\xe5\xae\x9e\xe7\x8e\xb0\xe5\xa6\x82\xe4\xb8\x8b:\n\n``` js\nfunction rewriteUpdate(ctx) {\n    ctx.update = (patch) => {\n        let needDiff = false\n        let diffResult = patch\n        if (patch) {\n            for (let key in patch) {\n                updateByPath(ctx.store.data, key, patch[key])\n                if (typeof patch[key] === \'object\') {\n                    needDiff = true\n                }\n            }\n        } else {\n            needDiff = true\n        }\n        if (needDiff) {\n            diffResult = diff(ctx.store.data, originData)\n        }\n        for (let key in ctx.store.instances) {\n            ctx.store.instances[key].forEach(ins => {\n                ins.setData.call(ins, diffResult)\n            })\n        }\n        ctx.store.onChange && ctx.store.onChange(diffResult)\n        for (let key in diffResult) {\n            updateByPath(originData, key, diffResult[key])\n        }\n    }\n}\n```\n\nwestore \xe4\xbc\x9a\xe6\x94\xb6\xe9\x9b\x86\xe6\x89\x80\xe6\x9c\x89\xe9\xa1\xb5\xe9\x9d\xa2\xe5\x92\x8c\xe7\xbb\x84\xe4\xbb\xb6\xe7\x9a\x84\xe5\xae\x9e\xe4\xbe\x8b\xef\xbc\x8c\xe5\x9c\xa8\xe5\xbc\x80\xe5\x8f\x91\xe8\x80\x85\xe6\x89\xa7\xe8\xa1\x8c this.update \xe7\x9a\x84\xe6\x97\xb6\xe5\x80\x99\xe9\x81\x8d\xe5\x8e\x86\xe6\x89\x80\xe6\x9c\x89\xe5\xae\x9e\xe4\xbe\x8b\xe8\xbf\x9b\xe8\xa1\x8c setData\xe3\x80\x82\n\n### \xe5\x87\xbd\xe6\x95\xb0\xe5\xb1\x9e\xe6\x80\xa7\n\n``` js\nfunction defineFnProp(data) {\n    Object.keys(data).forEach(key => {\n        const fn = data[key]\n        if (typeof fn == \'function\') {\n            fnMapping[key] = fn\n            Object.defineProperty(globalStore.data, key, {\n                enumerable: true,\n                get: () => {\n                    return fnMapping[key].call(globalStore.data)\n                },\n                set: (value) => {\n                    fnMapping[key] = value\n                }\n            })\n        }\n    })\n}\n```\n\n\xe9\x80\x9a\xe8\xbf\x87 defineProperty \xe9\x87\x8d\xe5\x86\x99\xe4\xba\x86\xe5\xb1\x9e\xe6\x80\xa7\xe7\x9a\x84 get \xe5\x92\x8c set\xef\xbc\x8cfnMapping \xe5\xad\x98\xe6\x94\xbe\xe6\x89\x80\xe6\x9c\x89 key \xe5\x92\x8c\xe5\x87\xbd\xe6\x95\xb0\xe7\x9a\x84\xe6\x98\xa0\xe5\xb0\x84\xe3\x80\x82\xe8\xbf\x99\xe9\x87\x8c\xe4\xb8\x80\xe5\xae\x9a\xe8\xa6\x81\xe8\xae\xbe\xe7\xbd\xae enumerable \xe4\xb8\xba true\xef\xbc\x8c\xe5\x9b\xa0\xe4\xb8\xba diff \xe7\x9a\x84\xe6\x97\xb6\xe5\x80\x99\xe9\x9c\x80\xe8\xa6\x81\xe9\x81\x8d\xe5\x8e\x86\xe3\x80\x82\n\n## License\nMIT [@dntzhang](https://github.com/dntzhang)\n'