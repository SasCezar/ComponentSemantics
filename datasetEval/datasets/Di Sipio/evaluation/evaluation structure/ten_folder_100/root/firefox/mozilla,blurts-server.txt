b'# Firefox Monitor Server\n\n## Summary\n\nFirefox Monitor notifies users when their credentials have been compromised in a data breach.\n\nThis code is for the monitor.firefox.com service & website.\n\nBreach data is powered by [haveibeenpwned.com](https://haveibeenpwned.com/).\n\nSee the [Have I Been Pwned about page](https://haveibeenpwned.com/About) for\nthe "what" and "why" of data breach alerts.\n\n## Development\n\n### Requirements\n\n* [Node](https://nodejs.org/) 8+ (with npm)\n* [Postgres](https://www.postgresql.org/)\n\n### Install\n\n1. Clone and change to the directory:\n\n    ```sh\n    git clone https://github.com/mozilla/blurts-server.git\n    cd blurts-server\n    ```\n\n2. Install dependencies:\n\n    ```sh\n    npm install\n    ```\n\n3. Copy the `.env-dist` file to `.env`:\n\n    ```sh\n    cp .env-dist .env\n    ```\n\n### Run\n\n1. Run the server:\n\n    ```sh\n    npm start\n    ```\n\nNote: `npm start` uses `onchange` and `nodemon` to automatically detect file\nchanges, re-compile static assets, and restart the express process. If you want\nmore control, see the `scripts` section of `package.json` for more commands.\n\n2. Navigate to [localhost:6060/](http://localhost:6060/)\n\n#### Database\n\nTo create the database tables ...\n\n1. Create the `blurts` database:\n\n   ```sh\n   createdb blurts\n   createdb test-blurts # for tests\n   ```\n\n2. Update the `DATABASE_URL` value in your `.env` file with your local db\n   credentials:\n\n   ```\n   DATABASE_URL="postgres://<username>@localhost:<port>/blurts"\n   ```\n\n3. Run the migrations:\n\n   ```\n   npm run db:migrate\n   ```\n\n#### Emails\n\nThe included `.env-dist` sets `DEBUG_DUMMY_SMTP=1` which disables emails.\n\nTo send emails, you\'ll need to unset `DEBUG_DUMMY_SMTP` and supply real SMTP\nconfig values for sending email.\n\nYou can set and source these via the `.env` file, or set them directly:\n\n```sh\nexport DEBUG_DUMMY_SMTP=\nexport SMTP_HOST=<your-smtp-host>\nexport SMTP_PORT=<your-smtp-port>\nexport SMTP_USERNAME=<your-username>\nexport SMTP_PASSWORD=<your-password>\n```\n\n#### Firefox Accounts\n\nSubscribe with a Firefox Account is controlled via the `FXA_ENABLED`\nenvironment variable. (See `.env-dist`)\n\nThe repo comes with a development FxA oauth app pre-configured in `.env`, which\nshould work fine running the app on http://localhost:6060\n\nTo use a different Firefox Accounts oauth relying party,\nyou\'ll need to [create an FxA Oauth Client](https://oauth-stable.dev.lcip.org/console/clients) and then set some `OAUTH` config values.\n\nYou can set and source these via the `.env` file:\n\n```sh\nOAUTH_CLIENT_ID=<your-fxa-oauth-client-id>\nOAUTH_CLIENT_SECRET=<your-fxa-oauth-client-secret>\nOAUTH_AUTHORIZATION_URI="https://oauth-stable.dev.lcip.org/v1/authorization"\nOAUTH_PROFILE_URI="https://stable.dev.lcip.org/profile/v1/profile"\nOAUTH_TOKEN_URI="https://oauth-stable.dev.lcip.org/v1/token"\n```\n\n## Testing\n\nThe full test suite can be run via `npm test`.\n\n### Individual tests\n\nTo run individual tests, use `NODE_ENV=tests` and `jest`:\n\n```\nNODE_ENV=tests jest --runInBand tests/home.test.js\n```\n\nTo run tests with interactive `debugger` lines enabled:\n\n```\nNODE_ENV=tests node inspect --harmony ./node_modules/.bin/jest tests/home.test.js\n```\n\n### Lint\n\nAfter installing the dependencies, you can lint the code by calling:\n\n```sh\nnpm run lint\n```\n\n## Deployment\n\nFirefox Monitor Breach Alerts is designed with [12-factor](https://12factor.net/) methodology.\n\n### Deploy on Heroku\n\nYou will need to set some required environment variables on Heroku.\n\n```sh\nheroku config:set COOKIE_SECRET=unsafe-cookie-secret-for-heroku\nheroku config:set DEBUG_DUMMY_SMTP=1\n```\n\nAnd any others, depending on the features you\'re running on Heroku - e.g.,\nEmail or Firefox Accounts.\n'