b'<a id="top" name="top"></a>\n\n<p align="center"><b>THIS PROJECT IS DEPRECATED IN FAVOR OF ITS SUCCESSOR<br><a href="https://github.com/aws/aws-lambda-go">aws/aws-lambda-go</a></b></p><br><br>\n\n[<img src="asset/logo_powered-by-aws.png" alt="Powered by Amazon Web Services" align="right">][aws-home]\n[<img src="asset/logo_created-by-eawsy.png" alt="Created by eawsy" align="right">][eawsy-home]\n\n# eawsy/aws-lambda-go-shim\n\n> Author your AWS Lambda functions in Go, effectively.\n\n[![Status][badge-status]](#top)\n[![License][badge-license]](LICENSE)\n[![Help][badge-help]][eawsy-chat]\n[![Social][badge-social]][eawsy-twitter]\n\n[AWS Lambda][aws-lambda-home] lets you run code without thinking about servers. [For now][aws-lambda-lng], you can \nauthor your AWS Lambda functions, natively, in [C#][aws-lambda-csharp], [Java][aws-lambda-java], \n[Node.js][aws-lambda-nodejs] and [Python][aws-lambda-python]. This project provides a **native** and **full-featured** \nshim for authoring your AWS Lambda functions in Go.\n\n<details>\n<summary><b>Table of Contents</b></summary>\n\n<sub>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generated with [DocToc](https://github.com/thlorenz/doctoc)</sub>\n\n<!-- START doctoc generated TOC please keep comment here to allow auto update -->\n<!-- DON\'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->\n\n\n- [Preview](#preview)\n- [Features](#features)\n- [Performance](#performance)\n- [How It Works](#how-it-works)\n  - [Quick Hands-On](#quick-hands-on)\n  - [Under the Hood](#under-the-hood)\n    - [Main Package](#main-package)\n    - [Runtime Context](#runtime-context)\n    - [Get Dependencies](#get-dependencies)\n    - [Handler Signature](#handler-signature)\n    - [Logging](#logging)\n    - [Exceptions](#exceptions)\n    - [Building](#building)\n    - [Deployment](#deployment)\n  - [Known Limitations](#known-limitations)\n  - [Edge Behaviors](#edge-behaviors)\n- [License](#license)\n\n<!-- END doctoc generated TOC please keep comment here to allow auto update -->\n</details>\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## Preview\n\n```go\npackage main\n\nimport "github.com/eawsy/aws-lambda-go-core/service/lambda/runtime"\n\nfunc Handle(evt interface{}, ctx *runtime.Context) (string, error) {\n\treturn "Hello, World!", nil\n}\n```\n```sh\nwget -qO- https://github.com/eawsy/aws-lambda-go-shim/raw/master/src/preview.bash | bash\n# "Hello, World!" executed in 0.45 ms\n```\n\n:hatching_chick: If you like the experience, please [spread the word][eawsy-spread]!\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## Features\n\n[Serialization](#handler-signature) | [Context](#runtime-context) | [Logging](#logging)    | [Exceptions](#exceptions) | [Environment][golang-env] | [Events][eawsy-evt]     | [API Gateway][eawsy-net]\n:---------------------------------: | :-------------------------: | :--------------------: | :-----------------------: | :-----------------------: | :---------------------: | :----------------------:\n[![OK][ok]](#features)              | [![OK][ok]](#features)      | [![OK][ok]](#features) | [![OK][ok]](#features)    | [![OK][ok]](#features)    | [![OK][mok]](#features) | [![OK][ok]](#features)\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## Performance\n\n> DISCLAIMER:\n  We do not intend to compare Go with other languages but to appreciate the overhead of our shim compared to officially\n  supported AWS Lambda languages.\n\n:sunglasses: It is the 2nd fastest way to run an AWS Lambda function and makes the Node.js *spawn process* technique \nobsolete.\n\n![Benchmark](asset/bench_1000.png)\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## How It Works\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n### Quick Hands-On\n\n0. Requirements\n\n      ```sh\n      docker pull eawsy/aws-lambda-go-shim:latest\n      go get -u -d github.com/eawsy/aws-lambda-go-core/...\n      wget -O Makefile https://git.io/vytH8\n      ```\n\n1. Code\n\n      ```go\n      package main\n\n      import (\n        "encoding/json"\n\n        "github.com/eawsy/aws-lambda-go-core/service/lambda/runtime"\n      )\n\n      func Handle(evt json.RawMessage, ctx *runtime.Context) (interface{}, error) {\n        // ...\n      }\n      ```\n\n2. Build\n\n      ```sh\n      make\n      ```\n\n3. Deploy\n\n      You can use your preferred deployment method by providing it the following\n      configuration:\n\n      - Runtime: **python2.7**\n      - Handler: **handler.Handle**\n\n      For example, if you deploy your function through the \n      [AWS Lambda Management Console](https://console.aws.amazon.com/lambda/home#/create/configure-function),\n      you will have to fill a bunch of parameters like:\n\n      <p align="center">\n        <img src="asset/aws_config-preview.png" align="center">\n      </p>\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n### Under the Hood\n\nConsidering for example the above preview section, we have the following structure:\n\n```\n.\n\xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 preview\n    \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 handler.go\n    \xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 Makefile\n```\n\nThe `handler.go` file is where resides the main entrypoint of your AWS Lambda function. There is no restriction on how\nmany files and dependencies you can have, nor on how you must name your files and functions. Nevertheless however we \nadvocate to retain the `handler` name and to use `Handle` as the name of your entrypoint. \n\nLet\'s review the content of `handler.go`:\n\n```go\n1 package main\n2 \n3 import "github.com/eawsy/aws-lambda-go-core/service/lambda/runtime"\n4 \n5 func Handle(evt interface{}, ctx *runtime.Context) (string, error) {\n6 \treturn "Hello, World!", nil\n7 }\n```\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Main Package\n\nFor a seamless experience we leverage [Go 1.8 plugins][golang-plug] to separate the shim from your code. At run time, \nAWS Lambda loads our pre-compiled shim which in turn loads your code (your plugin). A plugin is a \n**Go main package** and that is why your entrypoint **must** be in the main package, as seen at line 1. Notice that this\nrestriction only applies to your entrypoint and you are free to organize the rest of your code in different packages.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Runtime Context\n\nWhile your function is executing, it can interact with AWS Lambda to get useful runtime information such as, how much \ntime is remaining before AWS Lambda terminates your function, the AWS request id, etc. This information is passed as the \nsecond parameter to your function via the `runtime.Context` object, as seen at line 5.  \nWith [`eawsy/aws-lambda-go-core`][eawsy-ctx] we empower you with a full-featured context object to **access any \navailable information** in the exact same way that official AWS Lambda runtimes do. This is the only dependency you ever \nneed, as seen in line 3. \n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Get Dependencies\n\n`eawsy/aws-lambda-go-core` dependency can be retrieved using the well known `go get` command:\n\n```sh\ngo get -u -d github.com/eawsy/aws-lambda-go-core/...\n```\n\n[Go vendoring][golang-vnd] is also supported out of the box and behaves the same way expected when building usual go \nprojects:\n\n- If the `preview` folder is inside `GOPATH`, then `vendor` folder prevails over `GOPATH` dependencies.\n- If the `preview` folder is outside `GOPATH`, then `vendor` folder is ignored in favor of `GOPATH` dependencies.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Handler Signature\n\n```go\n5 func Handle(evt interface{}, ctx *runtime.Context) (string, error) {\n6 \treturn "Hello, World!", nil\n7 }\n```\n\nFor AWS Lambda being able to call your handler, you have to [make it visible][golang-name] outside your plugin, as seen\nat line 5. There is no other naming restriction but keep in mind that if you change the name of your function, you must\nalso update it in the [AWS Lambda configuration](#deployment).\n\n> Tip: Use a variable to expose a handler from the inside of a package:\n  ```go\n  var Handle = mypackage.MyHandle\n  ```\n\nFor the rest, the handler follows the [AWS Lambda programming model][aws-lambda-model] by:\n\n- Taking 2 parameters:\n  - **Event** \xe2\x80\x93 Event data is **automatically json unmarshalled** and passed as the first argument.  \n    You are free to use the well known [`json.RawMessage`][golang-jsonraw] type, any other valid Go type or even your \n    own custom type. We also provide an [extensive set of predefined event definitions][eawsy-evt] if you plan to play \n    with [AWS Lambda event source mapping][aws-lambda-map].\n  - **Context** \xe2\x80\x93 Context information is passed as the second argument [as explained above](#runtime-context).\n\n- Returning 2 values:\n  - **Result** \xe2\x80\x93 The first return value is **automatically json marshalled** and forwarded back to the client.  \n    You are free to use the well known `interface{}` type, any other valid Go type or even your own custom type to \n    leverage [fine grained json marshalling][golang-jsoncus].\n  - **Error** \xe2\x80\x93 The second return value notifies AWS Lambda an error occurred during execution. As expected it prevails \n    over the first return value. You are free to return native Go errors or custom ones:\n    ```go\n    type CustomError struct {\n\t    s string\n    }\n\n    func (e *CustomError) Error() string {\n\t    return e.s\n    }\n\n    func Handle(evt interface{}, ctx *runtime.Context) (interface{}, error) {\n      return nil, &CustomError{"somthing bad happened"}\n    }\n    ```\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Logging\n\nIn line with the [AWS Lambda programming model][aws-lambda-model], one should be able to output logs using standard\nabilities of the language. Your function can contain logging statements using the official [Go log package][golang-log]\nand AWS Lambda writes theses logs to [AWS CloudWatch Logs][aws-cw-logs] asynchronously. There is no restriction on how \nto configure or use the Go log package.\n\n```go\npackage main\n\nimport (\n\t"log"\n\n\t"github.com/eawsy/aws-lambda-go-core/service/lambda/runtime"\n)\n\nfunc Handle(evt interface{}, ctx *runtime.Context) (interface{}, error) {\n\tlog.Println("Hello, World!")\n\treturn nil, nil\n}\n```\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Exceptions\n\nIn the course of a normal and controlled execution flow, you can notify AWS Lambda an error occurred by returning an \n`error` as [explained above](#handler-signature).  \nIn case of unexpected situations when the ordinary flow of control stops and begins *panicking* and if you have not any\n[recover mechanism][golang-recover] in place, then the stack trace is logged in AWS CloudWatch Logs and AWS Lambda is\nnotified an error occurred.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Building\n\nWe provide a [Docker image][eawsy-docker] based on [Amazon Linux container image][aws-docker-image] to build your binary\nin the exact same environment than AWS Lambda. This image embeds our pre-compiled shim along with helper scripts to\npackage your function. You can use it as such or [build your own custom image][docker-custom] from it:\n\n```sh\ndocker pull eawsy/aws-lambda-go-shim:latest\n```\n\nAlthough not strictly required, we also provide an [example Makefile](src/Makefile.example) to streamline common use\ncases. You are free to customize, modify and adapt it to your needs. Let\'s review its content briefly:\n\n```Makefile\nHANDLER ?= handler\nPACKAGE ?= $(HANDLER)\n\ndocker:\n  @docker run ...\n\nbuild:\n  @go build ...\n\npack:\n  @pack ...\n```\n\n- **Customize** \xe2\x80\x93 The first two environment variables allow you to customize the name of your handler and the generated \n  package:\n\n  ```sh\n  make\n  .\n  \xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 preview\n      \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 handler.go\n      \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 handler.so\n      \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 handler.zip\n      \xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 Makefile\n  ```\n\n  ```sh\n  HANDLER=myhandler PACKAGE=mypackage make\n  .\n  \xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 preview\n      \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 handler.go\n      \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 Makefile\n      \xe2\x94\x9c\xe2\x94\x80\xe2\x94\x80 myhandler.so\n      \xe2\x94\x94\xe2\x94\x80\xe2\x94\x80 mypackage.zip\n  ```\n\n- **Dockerize** \xe2\x80\x93 The `docker` target runs our Docker image and executes the rest of the build process inside it.\n\n- **Build** \xe2\x80\x93 The `build` target builds your code with the [plugin build mode][golang-mode]. Feel free to customize \n  build flags.\n\n- **Package** \xe2\x80\x93 The `pack` target is by far the most important one. It packages your previously built plugin and inject \n  our pre-compiled shim, with the correct name, into the package.  \n  Be careful if you customize the example `Makefile` or if you build your own custom image, the way the shim is injected \n  into the package ensures its correct functioning.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n#### Deployment\n\nThe only intent of this project is to provide the most seamless and effective way to run Go on AWS Lambda. We do not \nprovide any sugar and you are free to use your tools of predilection for deployment with the following settings in AWS \nLambda:\n\n- Runtime: `python2.7`\n- Handler: `handler.Handle` (unless customized as explained above)\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n### Known Limitations\n\n- The behavior of the Go fmt package is non-deterministic in AWS CloudWatch Logs. Please use Go log package instead.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n### Edge Behaviors\n\n> Even if some of these behaviors can be overcome, we mimic the official AWS Lambda runtimes.\n\n- Log statements are not visible during initialization. If you log anything in the `init` function, it won\'t be written\n  in AWS CloudWatch Logs.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## About\n\n[![eawsy](asset/logo_eawsy.png)][eawsy-home]\n\nThis project is maintained and funded by Alsanium, SAS.\n\n[We][eawsy-home] :heart: [AWS][aws-home] and open source software. See [our other projects][eawsy-github], or \n[hire us][eawsy-hire] to help you build modern applications on AWS.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## Contact\n\nWe want to make it easy for you, users and contributers, to talk with us and connect with each others, to share ideas, \nsolve problems and make help this project awesome. Here are the main channels we\'re running currently and we\'d love to \nhear from you on them.\n\n### Twitter \n  \n[eawsyhq][eawsy-twitter] \n\nFollow and chat with us on Twitter. \n\nShare stories!\n\n### Gitter \n\n[eawsy/bavardage][eawsy-chat]\n\nThis is for all of you. Users, developers and curious. You can find help, links, questions and answers from all the \ncommunity including the core team.\n\nAsk questions!\n\n### GitHub\n\n[pull requests][eawsy-pr] & [issues][eawsy-issues]\n\nYou are invited to contribute new features, fixes, or updates, large or small; we are always thrilled to receive pull \nrequests, and do our best to process them as fast as we can.\n\nBefore you start to code, we recommend discussing your plans through the [eawsy/bavardage channel][eawsy-chat], \nespecially for more ambitious contributions. This gives other contributors a chance to point you in the right direction, \ngive you feedback on your design, and help you find out if someone else is working on the same thing.\n\nWrite code!\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## License\n\nThis product is licensed to you under the Apache License, Version 2.0 (the "License"); you may not use this product \nexcept in compliance with the License. See [LICENSE](LICENSE) and [NOTICE](NOTICE) for more information.\n\n[<img src="asset/misc_arrow-up.png" align="right">](#top)\n## Trademark\n\nAlsanium, eawsy, the "Created by eawsy" logo, and the "eawsy" logo are trademarks of Alsanium, SAS. or its affiliates in \nFrance and/or other countries.\n\nAmazon Web Services, the "Powered by Amazon Web Services" logo, and AWS Lambda are trademarks of Amazon.com, Inc. or its \naffiliates in the United States and/or other countries.\n\n\n[eawsy-home]:        https://eawsy.com\n[eawsy-chat]:        https://gitter.im/eawsy/bavardage\n[eawsy-twitter]:     https://twitter.com/eawsyhq\n[eawsy-spread]:      https://twitter.com/intent/tweet?text=Ran+my+first+native+%23golang+function+on+%23AWSLambda+with+%40eawsyhq+%23NotYetAnotherProcessSpawn&url=https://github.com/eawsy/aws-lambda-go-shim\n[eawsy-net]:         https://github.com/eawsy/aws-lambda-go-net\n[eawsy-ctx]:         https://github.com/eawsy/aws-lambda-go-core\n[eawsy-evt]:         https://github.com/eawsy/aws-lambda-go-event\n[eawsy-docker]:      https://hub.docker.com/r/eawsy/aws-lambda-go-shim/\n[eawsy-github]:      https://github.com/eawsy/\n[eawsy-hire]:        https://docs.google.com/forms/d/e/1FAIpQLSfPvn1Dgp95DXfvr3ClPHCNF5abi4D1grveT5btVyBHUk0nXw/viewform\n[eawsy-pr]:          https://github.com/eawsy/aws-lambda-go-shim/issues?q=is:pr%20is:open\n[eawsy-issues]:      https://github.com/eawsy/aws-lambda-go-shim/issues?q=is:issue%20is:open\n\n[aws-home]:          https://aws.amazon.com\n[aws-lambda-home]:   https://aws.amazon.com/lambda/\n[aws-lambda-lng]:    http://docs.aws.amazon.com/lambda/latest/dg/lambda-app.html#lambda-app-author\n[aws-lambda-csharp]: http://docs.aws.amazon.com/lambda/latest/dg/dotnet-programming-model.html\n[aws-lambda-java]:   http://docs.aws.amazon.com/lambda/latest/dg/java-programming-model.html\n[aws-lambda-nodejs]: http://docs.aws.amazon.com/lambda/latest/dg/programming-model.html\n[aws-lambda-python]: http://docs.aws.amazon.com/lambda/latest/dg/python-programming-model.html\n[aws-lambda-model]:  http://docs.aws.amazon.com/lambda/latest/dg/programming-model-v2.html\n[aws-lambda-map]:    http://docs.aws.amazon.com/lambda/latest/dg/intro-invocation-modes.html\n[aws-cw-logs]:       http://docs.aws.amazon.com/AmazonCloudWatch/latest/logs/WhatIsCloudWatchLogs.html\n[aws-docker-image]:  http://docs.aws.amazon.com/AmazonECR/latest/userguide/amazon_linux_container_image.html\n\n[golang-plug]:       https://golang.org/doc/go1.8#plugin\n[golang-vnd]:        https://golang.org/doc/go1.6#go_command\n[golang-name]:       https://golang.org/doc/effective_go.html#names\n[golang-jsonraw]:    https://golang.org/pkg/encoding/json/#RawMessage\n[golang-jsoncus]:    https://golang.org/pkg/encoding/json/#example__customMarshalJSON\n[golang-log]:        https://golang.org/pkg/log/\n[golang-recover]:    https://blog.golang.org/defer-panic-and-recover\n[golang-mode]:       https://golang.org/cmd/go/#hdr-Description_of_build_modes\n[golang-env]:        https://golang.org/pkg/os/#Getenv\n\n[docker-custom]:     https://docs.docker.com/engine/getstarted/step_four/\n\n[badge-status]:      http://img.shields.io/badge/status-stable-4CAF50.svg?style=flat-square\n[badge-license]:     http://img.shields.io/badge/license-apache-FF5722.svg?style=flat-square\n[badge-help]:        http://img.shields.io/badge/help-gitter-E91E63.svg?style=flat-square\n[badge-social]:      http://img.shields.io/badge/social-twitter-03A9F4.svg?style=flat-square\n\n[ok]:                asset/misc_check-green.png\n[mok]:               asset/misc_check-yellow.png\n'