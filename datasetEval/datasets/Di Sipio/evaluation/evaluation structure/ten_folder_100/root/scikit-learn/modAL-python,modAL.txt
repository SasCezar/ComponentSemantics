b'<img src="https://modal-python.readthedocs.io/en/latest/_static/modAL_b.png" alt="modAL" style="width: 400px;">\n\nModular Active Learning framework for Python3\n\n[![travis-ci-master](https://travis-ci.org/modAL-python/modAL.svg?branch=master)](https://travis-ci.org/modAL-python/modAL) [![codecov-master](https://codecov.io/gh/modAL-python/modAL/branch/master/graph/badge.svg)](https://codecov.io/gh/modAL-python/modAL) [![readthedocs](https://readthedocs.org/projects/modal-python/badge/?version=latest)](http://modal-python.readthedocs.io/en/latest/?badge=latest)\n\n## Page contents\n- [Introduction](#introduction)  \n- [Active learning from bird\'s-eye view](#active-learning)  \n- [modAL in action](#modAL-in-action)\n  - [From zero to one in a few lines of code](#initialization)  \n  - [Replacing parts quickly](#replacing-parts)  \n  - [Replacing parts with your own solutions](#replacing-parts-with-your-own-solutions)  \n  - [An example with active regression](#active-regression)\n  - [Additional examples](#additional-examples)  \n- [Installation](#installation)  \n- [Documentation](#documentation)  \n- [Citing](#citing)  \n- [About the developer](#about-the-developer)\n\n# Introduction<a name="introduction"></a>\nmodAL is an active learning framework for Python3, designed with *modularity, flexibility* and *extensibility* in mind. Built on top of scikit-learn, it allows you to rapidly create active learning workflows with nearly complete freedom. What is more, you can easily replace parts with your custom built solutions, allowing you to design novel algorithms with ease.\n\n# Active learning from bird\'s-eye view<a name="active-learning"></a>\nWith the recent explosion of available data, you have can have millions of unlabelled examples with a high cost to obtain labels. For instance, when trying to predict the sentiment of tweets, obtaining a training set can require immense manual labour. But worry not, active learning comes to the rescue! In general, AL is a framework allowing you to increase classification performance by intelligently querying you to label the most informative instances. To give an example, suppose that you have the following data and classifier with shaded regions signifying the classification probability.\n\n<p align="center">\n  <img src="https://modal-python.readthedocs.io/en/latest/_images/motivating-example.png" height="600px" width="600px"/>\n</p>\n\nSuppose that you can query the label of an unlabelled instance, but it costs you a lot. Which one would you choose? By querying an instance in the uncertain region, surely you obtain more information than querying by random. Active learning gives you a set of tools to handle problems like this. In general, an active learning workflow looks like the following.\n\n<p align="center">\n <img src="https://modal-python.readthedocs.io/en/latest/_images/active-learning.png"/>\n</p>\n\nThe key components of any workflow are the **model** you choose, the **uncertainty** measure you use and the **query** strategy you apply to request labels. With modAL, instead of choosing from a small set of built-in components, you have the freedom to seamlessly integrate scikit-learn or Keras models into your algorithm and easily tailor your custom query strategies and uncertainty measures.\n\n# modAL in action<a name="modAL-in-action"></a>\nLet\'s see what modAL can do for you!\n\n## From zero to one in a few lines of code<a name="initialization"></a>\nActive learning with a scikit-learn classifier, for instance RandomForestClassifier, can be as simple as the following.\n```python\nfrom modAL.models import ActiveLearner\nfrom sklearn.ensemble import RandomForestClassifier\n\n# initializing the learner\nlearner = ActiveLearner(\n    estimator=RandomForestClassifier(),\n    X_training=X_training, y_training=y_training\n)\n\n# query for labels\nquery_idx, query_inst = learner.query(X_pool)\n\n# ...obtaining new labels from the Oracle...\n\n# supply label for queried instance\nlearner.teach(X_pool[query_idx], y_new)\n```\n\n## Replacing parts quickly<a name="replacing-parts"></a>\nIf you would like to use different uncertainty measures and query strategies than the default uncertainty sampling, you can either replace them with several built-in strategies or you can design your own by following a few very simple design principles. For instance, replacing the default uncertainty measure to classification entropy looks the following.\n```python\nfrom modAL.models import ActiveLearner\nfrom modAL.uncertainty import entropy_sampling\nfrom sklearn.ensemble import RandomForestClassifier\n\nlearner = ActiveLearner(\n    estimator=RandomForestClassifier(),\n    query_strategy=entropy_sampling,\n    X_training=X_training, y_training=y_training\n)\n```\n\n## Replacing parts with your own solutions<a name="replacing-parts-with-your-own-solutions"></a>\nmodAL was designed to make it easy for you to implement your own query strategy. For example, implementing and using a simple random sampling strategy is as easy as the following.\n```python\nimport numpy as np\n\ndef random_sampling(classifier, X_pool):\n    n_samples = len(X_pool)\n    query_idx = np.random.choice(range(n_samples))\n    return query_idx, X_pool[query_idx]\n\nlearner = ActiveLearner(\n    estimator=RandomForestClassifier(),\n    query_strategy=random_sampling,\n    X_training=X_training, y_training=y_training\n)\n```\nFor more details on how to implement your custom strategies, visit the page [Extending modAL](https://modal-python.readthedocs.io/en/latest/content/overview/Extending-modAL.html)!\n\n## An example with active regression<a name="active-regression"></a>\nTo see modAL in *real* action, let\'s consider an active regression problem with Gaussian Processes! In this example, we shall try to learn the *noisy sine* function:\n```python\nimport numpy as np\n\nX = np.random.choice(np.linspace(0, 20, 10000), size=200, replace=False).reshape(-1, 1)\ny = np.sin(X) + np.random.normal(scale=0.3, size=X.shape)\n```\nFor active learning, we shall define a custom query strategy tailored to Gaussian processes. In a nutshell, a *query stategy* in modAL is a function taking (at least) two arguments (an estimator object and a pool of examples), outputting the index of the queried instance and the instance itself. In our case, the arguments are ```regressor``` and ```X```.\n```python\ndef GP_regression_std(regressor, X):\n    _, std = regressor.predict(X, return_std=True)\n    query_idx = np.argmax(std)\n    return query_idx, X[query_idx]\n```\nAfter setting up the query strategy and the data, the active learner can be initialized.\n```python\nfrom modAL.models import ActiveLearner\nfrom sklearn.gaussian_process import GaussianProcessRegressor\nfrom sklearn.gaussian_process.kernels import WhiteKernel, RBF\n\nn_initial = 5\ninitial_idx = np.random.choice(range(len(X)), size=n_initial, replace=False)\nX_training, y_training = X[initial_idx], y[initial_idx]\n\nkernel = RBF(length_scale=1.0, length_scale_bounds=(1e-2, 1e3)) \\\n         + WhiteKernel(noise_level=1, noise_level_bounds=(1e-10, 1e+1))\n\nregressor = ActiveLearner(\n    estimator=GaussianProcessRegressor(kernel=kernel),\n    query_strategy=GP_regression_std,\n    X_training=X_training.reshape(-1, 1), y_training=y_training.reshape(-1, 1)\n)\n```\nThe initial regressor is not very accurate.\n<p align="center">\n  <img src="https://modal-python.readthedocs.io/en/latest/_images/gp-initial.png">\n</p>\n\nThe blue band enveloping the regressor represents the standard deviation of the Gaussian process at the given point. Now we are ready to do active learning!\n```python\n# active learning\nn_queries = 10\nfor idx in range(n_queries):\n    query_idx, query_instance = regressor.query(X)\n    regressor.teach(X[query_idx].reshape(1, -1), y[query_idx].reshape(1, -1))\n```\nAfter a few queries, we can see that the prediction is much improved.\n\n<p align="center">\n <img src="https://modal-python.readthedocs.io/en/latest/_images/gp-final.png">\n</p>\n\n## Additional examples<a name="additional-examples"></a>\nIncluding this, many examples are available:\n- [Pool-based sampling](https://modal-python.readthedocs.io/en/latest/content/examples/pool-based_sampling.html)  \n- [Stream-based sampling](https://modal-python.readthedocs.io/en/latest/content/examples/stream-based_sampling.html)  \n- [Active regression](https://modal-python.readthedocs.io/en/latest/content/examples/active_regression.html)  \n- [Ensemble regression](https://modal-python.readthedocs.io/en/latest/content/examples/ensemble_regression.html)  \n- [Bayesian optimization](https://modal-python.readthedocs.io/en/latest/content/examples/bayesian_optimization.html)  \n- [Query by committee](https://modal-python.readthedocs.io/en/latest/content/examples/query_by_committee.html)  \n- [Bootstrapping and bagging](https://modal-python.readthedocs.io/en/latest/content/examples/bootstrapping_and_bagging.html)  \n- [Keras integration](https://modal-python.readthedocs.io/en/latest/content/examples/Keras_integration.html)\n\n# Installation<a name="installation"></a>\nmodAL requires\n- Python >= 3.5\n- NumPy >= 1.13\n- SciPy >= 0.18\n- scikit-learn >= 0.18\n\nYou can install modAL directly with pip:  \n```\npip install modAL\n```\nAlternatively, you can install modAL directly from source:  \n```\npip install git+https://github.com/modAL-python/modAL.git\n```\n\n# Documentation<a name="documentation"></a>\nYou can find the documentation of modAL at [https://modAL-python.github.io](https://modAL-python.github.io), where several tutorials and working examples are available, along with a complete API reference. For running the examples, Matplotlib >= 2.0 is recommended.\n\n# Citing<a name="citing"></a>\nIf you use modAL in your projects, you can cite it as\n```\n@article{modAL2018,\n    title={mod{AL}: {A} modular active learning framework for {P}ython},\n    author={Tivadar Danka and Peter Horvath},\n    url={https://github.com/modAL-python/modAL},\n    note={available on arXiv at \\url{https://arxiv.org/abs/1805.00979}}\n}\n```\n\n# About the developer<a name="about-the-developer">\nmodAL is developed by me, [Tivadar Danka](https://www.tivadardanka.com) (aka [cosmic-cortex](https://github.com/cosmic-cortex) in GitHub). I have a PhD in pure mathematics, but I fell in love with biology and machine learning right after I finished my PhD. I have changed fields and now I work in the [Bioimage Analysis and Machine Learning Group of Peter Horvath](http://group.szbk.u-szeged.hu/sysbiol/horvath-peter-lab-index.html), where I am working to develop active learning strategies for intelligent sample analysis in biology. During my work I realized that in Python, creating and prototyping active learning workflows can be made really easy and fast with scikit-learn, so I ended up developing a general framework for this. The result is modAL :) If you have any questions, requests or suggestions, you can contact me at <a href="mailto:85a5187a@opayq.com">85a5187a@opayq.com</a>! I hope you\'ll find modAL useful!\n'