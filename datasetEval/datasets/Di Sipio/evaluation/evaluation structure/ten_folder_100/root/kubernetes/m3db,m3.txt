b'# M3 [![GoDoc][doc-img]][doc] [![Build Status][ci-img]][ci] [![Coverage Status][cov-img]][cov] [![FOSSA Status][fossa-img]][fossa] [![Gitter chat][gitter-img]][gitter]\n\n<p align="center"><img src="docs/theme/assets/images/M3-logo.png" alt="M3 Logo" width="256" height="270"></p>\n\n[Distributed TSDB](http://m3db.github.io/m3/m3db/) and [Query Engine](http://m3db.github.io/m3/how_to/query/), [Prometheus Sidecar](http://m3db.github.io/m3/integrations/prometheus/), [Metrics Aggregator](http://m3db.github.io/m3/introduction/components/components/#m3-aggregator), and more. "More" now includes [Graphite storage and query engine](http://m3db.github.io/m3/integrations/graphite/)!\n\nMore information:\n\n- [Documentation](https://m3db.github.io/m3/)\n- [Developer: Getting Started](https://github.com/m3db/m3/blob/master/DEVELOPER.md)\n- [Gitter (chat channel)](https://gitter.im/m3db/Lobby)\n- [Forum (Google Group)](https://groups.google.com/forum/#!forum/m3db)\n- [Twitter](https://twitter.com/m3db_io)\n\n## Community meetings\n\nM3 contributors and maintainers have monthly (every four weeks) meetings at 11:00 AM (USA Pacific) on Tuesday.\n\nAn initial agenda is posted to the [community meeting shared Google doc](https://docs.google.com/document/d/1eGAd2A8FVtiip5wHxHnmSkz7e_qHc9k_4hGI0vUGdHM/edit?usp=sharing) a day before each meeting, and everyone is welcome to suggest additional topics or other agendas.\n\nYou can add the following public Google Calendar if you\'re using Google Calendar (so that any changes are reflected in your own calendar when the invite is updated):\n[https://calendar.google.com/calendar?cid=aWc5YWFxZWw0azFmMnRoZDA2dHBtZzZva2tAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ](https://calendar.google.com/calendar?cid=aWc5YWFxZWw0azFmMnRoZDA2dHBtZzZva2tAZ3JvdXAuY2FsZW5kYXIuZ29vZ2xlLmNvbQ)\n\nFor those not using Google Calendar, please download and import the following iCalendar (.ics) files to calendar system for the monthly invite: \n[https://calendar.google.com/calendar/ical/ig9aaqel4k1f2thd06tpmg6okk%40group.calendar.google.com/public/basic.ics](https://calendar.google.com/calendar/ical/ig9aaqel4k1f2thd06tpmg6okk%40group.calendar.google.com/public/basic.ics)\n\nJoin Zoom Meeting: [us04web.zoom.us/j/519434268](https://us04web.zoom.us/j/519434268)\n\n## Test it out\n\nThe easiest way to testing out M3 is to follow one of the guides from the documentation. For a fully comprehensive getting started guide, see our [single node how-to](https://m3db.github.io/m3/how_to/single_node/).\n\n### Starting a node\n\n```\n# to build a local m3dbnode process\nmake m3dbnode (note that we currently require at least Go 1.10 or higher)\n\n# run it with the sample configuration\n./bin/m3dbnode -f ./src/dbnode/config/m3dbnode-local-etcd.yml\n```\n\nTo cross-compile and build for Linux AMD64 build with `make m3dbnode-linux-amd64`.\n\n### Creating a namespace to store metrics\n\n```\ncurl -X POST http://localhost:7201/api/v1/database/create -d \'{\n  "type": "local",\n  "namespaceName": "default",\n  "retentionTime": "2h"\n}\'\n```\n\n### Test RPC\n\nTo test out some of the functionality of M3DB there are some user friendly HTTP JSON APIs that you can use. These use the DB node cluster service endpoints.\n\nNote: performance sensitive users are expected to use the more performant endpoints via either the Go `src/dbnode/client/Session` API, or the GRPC endpoints exposed via `src/coordinator`.\n\n#### Write a datapoint\n\n```\ncurl http://localhost:9003/writetagged -s -X POST -d \'{\n  "namespace": "default",\n  "id": "foo",\n  "tags": [\n    {\n      "name": "__name__",\n      "value": "user_login"\n    },\n    {\n      "name": "city",\n      "value": "new_york"\n    },\n    {\n      "name": "endpoint",\n      "value": "/request"\n    }\n  ],\n  "datapoint": {\n    "timestamp":\'"$(date +"%s")"\',\n    "value": 42.123456789\n  }\n}\'\n```\n\n#### Query for reverse indexed time series data\n\n```\ncurl http://localhost:9003/query -s -X POST -d \'{\n  "namespace": "default",\n  "query": {\n    "regexp": {\n      "field": "city",\n      "regexp": ".*"\n    }\n  },\n  "rangeStart": 0,\n  "rangeEnd":\'"$(date +"%s")"\'\n}\' | jq .\n```\n\n## Building with Docker\n\nA Dockerfile is included for both development and production deployment purposes. It uses a\n[multi-stage build](https://docs.docker.com/develop/develop-images/multistage-build/) in order to\nproduce a lightweight production image from a single Dockerfile. Accordingly, it requires Docker\n17.05 or later to build.\n\n```\ndocker build -f docker/m3dbnode/Dockerfile -t m3dbnode:$(git rev-parse head) .\ndocker run --name m3dbnode m3dbnode:$(git rev-parse head)\n```\n\nIf you wish to build an image with the source code included you can stop the build after the\n`builder` stage:\n\n```\ndocker build -f docker/m3dbnode/Dockerfile -t m3dbnode:$(git rev-parse head) --target builder .\n```\n\n## Configuration\n\nThe default Docker image will start a single `m3dbnode` process with an embedded etcd instance to\nmimic a production environment. If you would like to further customize the configuration, you must\nprovide your own and mount it into the container:\n\n```\ndocker run --name m3dbnode -v /host/config.yml:/etc/m3dbnode/myconfig.yml m3dbnode:tag -f /etc/m3dbnode/myconfig.yml\n```\n\n<hr>\n\nThis project is released under the [Apache License, Version 2.0](LICENSE).\n\n[doc-img]: https://godoc.org/github.com/m3db/m3?status.svg\n[doc]: https://godoc.org/github.com/m3db/m3\n[ci-img]: https://badge.buildkite.com/5509d9360bfea7f99ac3a07fd029feb1aafa5cff9ed5ab667b.svg?branch=master\n[ci]: https://buildkite.com/uberopensource/m3-monorepo-ci\n[cov-img]: https://codecov.io/gh/m3db/m3/branch/master/graph/badge.svg\n[cov]: https://codecov.io/gh/m3db/m3\n[fossa-img]: https://app.fossa.io/api/projects/custom%2B4529%2Fgithub.com%2Fm3db%2Fm3.svg?type=shield\n[fossa]: https://app.fossa.io/projects/custom%2B4529%2Fgithub.com%2Fm3db%2Fm3?ref=badge_shield\n[gitter-img]: https://badges.gitter.im/m3db.png\n[gitter]: https://gitter.im/m3db/Lobby\n'