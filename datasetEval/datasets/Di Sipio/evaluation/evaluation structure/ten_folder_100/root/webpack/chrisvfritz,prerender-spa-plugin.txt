b'<h1 align="center">Prerender SPA Plugin</h1>\n<p align="center">\n  <em>Flexible, framework-agnostic static site generation for sites and SPAs built with webpack.</em>\n</p>\n\n<p align="center"><img width="200" src="https://raw.githubusercontent.com/chrisvfritz/prerender-spa-plugin/master/assets/logo.png?raw=true"></p>\n\n---\n\n<div align="center">\n\n[![npm version](https://img.shields.io/npm/v/prerender-spa-plugin.svg)]()\n[![npm downloads](https://img.shields.io/npm/dt/prerender-spa-plugin.svg)]()\n[![Dependency Status](https://img.shields.io/david/chrisvfritz/prerender-spa-plugin.svg)](https://david-dm.org/chrisvfritz/prerender-spa-plugin)\n[![js-standard-style](https://img.shields.io/badge/code%20style-standard-brightgreen.svg)](https://standardjs.com/)\n[![license](https://img.shields.io/github/license/chrisvfritz/prerender-spa-plugin.svg)]()\n\n</div>\n\n---\n\n<div align="center">\n\n[![NPM](https://nodei.co/npm/prerender-spa-plugin.png?downloads=true&downloadRank=true&stars=true)](https://nodei.co/npm/prerender-spa-plugin/)\n\n</div>\n\n## About prerender-spa-plugin\n\n**:point_right: This is the stable `3.x` version of `prerender-spa-plugin` based on puppeteer. If you\'re looking for the (now-deprecated) `2.x` version, based on PhantomJS, take a look at the `v2` branch.**\n\nThe goal of this plugin is to provide a simple prerendering solution that is easily extensible and usable for any site or single-page-app built with webpack.\n\nPlugins for other task runners and build systems are planned.\n\n## Examples\nFramework-specific examples can be found in the `examples/` directory.\n\n- [Vanilla JS](examples/vanilla-simple)\n- [Vue.js 2 Simple](examples/vue2-webpack-simple)\n- [Vue.js 2 Router](examples/vue2-webpack-router)\n- [React (Create React App)](examples/create-react-app)\n- [Angular (Angular CLI + Eject)](examples/angular-cli-eject)\n\n### Basic Usage (`webpack.config.js`)\n```js\nconst path = require(\'path\')\nconst PrerenderSPAPlugin = require(\'prerender-spa-plugin\')\n\nmodule.exports = {\n  plugins: [\n    ...\n    new PrerenderSPAPlugin({\n      // Required - The path to the webpack-outputted app to prerender.\n      staticDir: path.join(__dirname, \'dist\'),\n      // Required - Routes to render.\n      routes: [ \'/\', \'/about\', \'/some/deep/nested/route\' ],\n    })\n  ]\n}\n```\n\n### Advanced Usage (`webpack.config.js`)\n\n```js\nconst path = require(\'path\')\nconst PrerenderSPAPlugin = require(\'prerender-spa-plugin\')\nconst Renderer = PrerenderSPAPlugin.PuppeteerRenderer\n\nmodule.exports = {\n  plugins: [\n    ...\n    new PrerenderSPAPlugin({\n      // Required - The path to the webpack-outputted app to prerender.\n      staticDir: path.join(__dirname, \'dist\'),\n\n      // Optional - The path your rendered app should be output to.\n      // (Defaults to staticDir.)\n      outputDir: path.join(__dirname, \'prerendered\'),\n\n      // Optional - The location of index.html\n      indexPath: path.join(__dirname, \'dist\', \'index.html\'),\n\n      // Required - Routes to render.\n      routes: [ \'/\', \'/about\', \'/some/deep/nested/route\' ],\n\n      // Optional - Allows you to customize the HTML and output path before\n      // writing the rendered contents to a file.\n      // renderedRoute can be modified and it or an equivelant should be returned.\n      // renderedRoute format:\n      // {\n      //   route: String, // Where the output file will end up (relative to outputDir)\n      //   originalRoute: String, // The route that was passed into the renderer, before redirects.\n      //   html: String, // The rendered HTML for this route.\n      //   outputPath: String // The path the rendered HTML will be written to.\n      // }\n      postProcess (renderedRoute) {\n        // Ignore any redirects.\n        renderedRoute.route = renderedRoute.originalRoute\n        // Basic whitespace removal. (Don\'t use this in production.)\n        renderedRoute.html = renderedRoute.html.split(/>[\\s]+</gmi).join(\'><\')\n        // Remove /index.html from the output path if the dir name ends with a .html file extension.\n        // For example: /dist/dir/special.html/index.html -> /dist/dir/special.html\n        if (renderedRoute.route.endsWith(\'.html\')) {\n          renderedRoute.outputPath = path.join(__dirname, \'dist\', renderedRoute.route)\n        }\n\n        return renderedRoute\n      },\n\n      // Optional - Uses html-minifier (https://github.com/kangax/html-minifier)\n      // To minify the resulting HTML.\n      // Option reference: https://github.com/kangax/html-minifier#options-quick-reference\n      minify: {\n        collapseBooleanAttributes: true,\n        collapseWhitespace: true,\n        decodeEntities: true,\n        keepClosingSlash: true,\n        sortAttributes: true\n      },\n\n      // Server configuration options.\n      server: {\n        // Normally a free port is autodetected, but feel free to set this if needed.\n        port: 8001\n      },\n\n      // The actual renderer to use. (Feel free to write your own)\n      // Available renderers: https://github.com/Tribex/prerenderer/tree/master/renderers\n      renderer: new Renderer({\n        // Optional - The name of the property to add to the window object with the contents of `inject`.\n        injectProperty: \'__PRERENDER_INJECTED\',\n        // Optional - Any values you\'d like your app to have access to via `window.injectProperty`.\n        inject: {\n          foo: \'bar\'\n        },\n\n        // Optional - defaults to 0, no limit.\n        // Routes are rendered asynchronously.\n        // Use this to limit the number of routes rendered in parallel.\n        maxConcurrentRoutes: 4,\n\n        // Optional - Wait to render until the specified event is dispatched on the document.\n        // eg, with `document.dispatchEvent(new Event(\'custom-render-trigger\'))`\n        renderAfterDocumentEvent: \'custom-render-trigger\',\n\n        // Optional - Wait to render until the specified element is detected using `document.querySelector`\n        renderAfterElementExists: \'my-app-element\',\n\n        // Optional - Wait to render until a certain amount of time has passed.\n        // NOT RECOMMENDED\n        renderAfterTime: 5000, // Wait 5 seconds.\n\n        // Other puppeteer options.\n        // (See here: https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#puppeteerlaunchoptions)\n        headless: false // Display the browser window when rendering. Useful for debugging.\n      })\n    })\n  ]\n}\n```\n\n### v2.x Compability\nMost usages of `prerender-spa-plugin` v2.x should be compatible with v3.x.\nThe exception being advanced configuration options that controlled PhantomJS. These have been replaced by pluggable renderers with their own specific configuration options.\n\nIf you use this format, you will be greeted with a warning prompting you to migrate to the new object-based configuration format, but it should still function for the time being.\n\n```js\nconst path = require(\'path\')\nconst PrerenderSPAPlugin = require(\'prerender-spa-plugin\')\n\nmodule.exports = {\n\n  // ...\n\n  plugins: [\n    new PrerenderSPAPlugin(\n      // (REQUIRED) Absolute path to static root\n      path.join(__dirname, \'relative/path/to/static/root\'),\n      // (REQUIRED) List of routes to prerender\n      [ \'/\', \'/about\', \'/contact\' ],\n      // (OPTIONAL) Compatible options from v2.\n      {\n        // NOTE: Unless you are relying on asynchronously rendered content,\n        // such as after an Ajax request, none of these options should be\n        // necessary. All synchronous scripts are already executed before\n        // capturing the page content.\n\n        // Wait until a specific event is fired on the document.\n        captureAfterDocumentEvent: \'custom-post-render-event\',\n        // This is how you would trigger this example event:\n        // document.dispatchEvent(new Event(\'custom-post-render-event\'))\n\n        // Wait until a specific element is detected with\n        // document.querySelector.\n        captureAfterElementExists: \'#content\',\n\n        // Wait until a number of milliseconds has passed after scripts\n        // have been executed. It\'s important to note that this may\n        // produce unreliable results when relying on network\n        // communication or other operations with highly variable timing.\n        captureAfterTime: 5000,\n\n        // path of index file. By default it\'s index.html in static root.\n        indexPath: path.resolve(\'/dist/path/to/index.html\'),\n\n        // Manually transform the HTML for each page after prerendering,\n        // for example to set the page title and metadata in edge cases\n        // where you cannot handle this via your routing solution.\n        //\n        // The function\'s context argument contains two properties:\n        //\n        // - html :: the resulting HTML after prerendering)\n        // - route :: the route currently being processed\n        //            e.g. "/", "/about", or "/contact")\n        //\n        // Whatever is returned will be printed to the prerendered file.\n        // NOTE: this has been deprecated in favor of the `postProcess` option.\n        // See the documentation below.\n        postProcessHtml: function (context) {\n          var titles = {\n            \'/\': \'Home\',\n            \'/about\': \'Our Story\',\n            \'/contact\': \'Contact Us\'\n          }\n          return context.html.replace(\n            /<title>[^<]*<\\/title>/i,\n            \'<title>\' + titles[context.route] + \'</title>\'\n          )\n        }\n      }\n    )\n  ]\n}\n```\n\n#### Additional Changes\n- It is no longer possible to use multiple `renderAfterX` (`captureAfterX`) options at the same time. Only one may be selected. The reason for this removal is to prevent ambiguity.\n- The recommended configuration format has changed from `new PrerenderSPAPlugin(staticDir: String, routes: Array<String>, config: Object)` to\n  ```javascript\n  new PrerenderSPAPlugin({\n    staticDir: String,\n    routes: String,\n    ...\n  })\n  ```\n  in order to reduce ambiguity. The old format still works for the time being.\n- The default renderer is no longer PhantomJS. It has been replaced with [puppeteer](https://github.com/GoogleChrome/puppeteer). It is fairly simple to develop your own renderer as well. An alternate [jsdom](https://github.com/tmpvar/jsdom)-based renderer is available at [@prerenderer/renderer-jsdom](https://www.npmjs.com/package/@prerenderer/renderer-jsdom).\n- `prerender-spa-plugin` is now based on [prerenderer](https://github.com/Tribex/prerenderer). Accordingly, most bugs should be reported in that repository.\n\n## What is Prerendering?\n\nRecently, SSR (Server Side Rendering) has taken the JavaScript front-end world by storm. The fact that you can now render your sites and apps on the server before sending them to your clients is an absolutely *revolutionary* idea (and totally not what everyone was doing before JS client-side apps got popular in the first place...)\n\nHowever, the same criticisms that were valid for PHP, ASP, JSP, (and such) sites are valid for server-side rendering today. It\'s slow, breaks fairly easily, and is difficult to implement properly.\n\nThing is, despite what everyone might be telling you, you probably don\'t *need* SSR. You can get almost all the advantages of it (without the disadvantages) by using **prerendering.** Prerendering is basically firing up a headless browser, loading your app\'s routes, and saving the results to a static HTML file. You can then serve it with whatever static-file-serving solution you were using previously. It *just works* with HTML5 navigation and the likes. No need to change your code or add server-side rendering workarounds.\n\nIn the interest of transparency, there are some use-cases where prerendering might not be a great idea.\n\n- **Tons of routes** - If your site has hundreds or thousands of routes, prerendering will be really slow. Sure you only have to do it once per update, but it could take ages. Most people don\'t end up with thousands of static routes, but just in-case...\n- **Dynamic Content** - If your render routes that have content that\'s specific to the user viewing it or other dynamic sources, you should make sure you have placeholder components that can display until the dynamic content loads on the client-side. Otherwise it might be a tad weird.\n\n## Available Renderers\n- `@prerenderer/renderer-puppeteer` - Uses [puppeteer](https://github.com/GoogleChrome/puppeteer) to render pages in headless Chrome.\n- `@prerenderer/renderer-jsdom` - Uses [jsdom](https://npmjs.com/package/jsdom). Extremely fast, but unreliable and cannot handle advanced usages. May not work with all front-end frameworks and apps.\n\n### Which renderer should I use?\n\n**Use `@prerenderer/renderer-puppeteer` if:** You\'re prerendering up to a couple hundred pages and want accurate results (bye-bye RAM!).\n\n**Use `@prerenderer/renderer-jsdom` if:** You need to prerender thousands upon thousands of pages, but quality isn\'t all that important, and you\'re willing to work around issues for more advanced cases. (Programmatic SVG support, etc.)\n\n## Documentation\n\n### Plugin Options\n\n| Option | Type | Required? | Default | Description |\n|-------------|-------------------------------------------|-----------|---------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| staticDir | String | Yes | None | The root path to serve your app from. |\n| outputDir | String | No | None | Where the prerendered pages should be output. If not set, defaults to staticDir. |\n| indexPath | String | No | `staticDir/index.html` | The index file to fall back on for SPAs. |\n| postProcess | Function(Object context): [Object \\| Promise] | No | None | See the [Using the postProcess Option](#using-the-postprocess-option) section. |\n| minify | Object | No | None | Minifies the resulting HTML using [html-minifier](https://github.com/kangax/html-minifier). Full list of options available [here](https://github.com/kangax/html-minifier#options-quick-reference). |\n| server | Object | No | None | App server configuration options (See below) |\n| renderer | Renderer Instance or Configuration Object | No | `new PuppeteerRenderer()` | The renderer you\'d like to use to prerender the app. It\'s recommended that you specify this, but if not it will default to `@prerenderer/renderer-puppeteer`. |\n\n#### Server Options\n\n| Option | Type    | Required? | Default                    | Description                            |\n|--------|---------|-----------|----------------------------|----------------------------------------|\n| port   | Integer | No        | First free port after 8000 | The port for the app server to run on. |\n| proxy  | Object  | No        | No proxying                | Proxy configuration. Has the same signature as [webpack-dev-server](https://github.com/webpack/docs/wiki/webpack-dev-server#proxy) |\n\n\n#### Using The postProcess Option\n\nThe `postProcess(Object context): Object | Promise` function in your renderer configuration allows you to adjust the output of `prerender-spa-plugin` before writing it to a file. It is called once per rendered route and is passed a `context` object in the form of:\n\n```javascript\n{\n  // The prerendered route, after following redirects.\n  route: String,\n  // The original route passed, before redirects.\n  originalRoute: String,\n  // The resulting HTML for the route.\n  html: String,\n  // The path to write the rendered HTML to.\n  // This is null (automatically calculated after postProcess)\n  // unless explicitly set.\n  outputPath: String || null\n}\n```\n\nYou can modify `context.html` to change what gets written to the prerendered files and/or modify `context.route` or `context.outputPath` to change the output location.\n\nYou are expected to adjust those properties as needed, then return the context object, or a promise that resolves to it like so:\n\n```javascript\npostProcess(context) {\n  // Remove /index.html from the output path if the dir name ends with a .html file extension.\n  // For example: /dist/dir/special.html/index.html -> /dist/dir/special.html\n  if (context.route.endsWith(\'.html\')) {\n    context.outputPath = path.join(__dirname, \'dist\', context.route)\n  }\n\n  return context\n}\n\npostProcess(context) {\n  return someAsyncProcessing(context.html)\n    .then((html) => {\n      context.html = html;\n      return context;\n    });\n}\n```\n\n#### Vue.js Notes\nIf you are having issues prerendering with Vue.js, try adding the [`data-server-rendered="true"`](https://ssr.vuejs.org/guide/hydration.html) attribute to your root app element. This will cause Vue to treat your current page as an already-rendered app and update it rather than completely rerendering the whole tree. You can add the attribute using `postProcess` or by manipulating the DOM with JavaScript prior prerendering with `renderAfterDocumentEvent`.\n\n---\n\n### `@prerenderer/renderer-puppeteer` options\n\n| Option                                                                                                                 | Type                                                                                                                                       | Required? | Default                | Description                                                                                                                                                                                                                                                           |\n|------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|-----------|------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| maxConcurrentRoutes                                                                                                    | Number                                                                                                                                     | No        | 0 (No limit)           | The number of routes allowed to be rendered at the same time. Useful for breaking down massive batches of routes into smaller chunks.                                                                                                                                 |\n| inject                                                                                                                 | Object                                                                                                                                     | No        | None                   | An object to inject into the global scope of the rendered page before it finishes loading. Must be `JSON.stringifiy`-able. The property injected to is `window[\'__PRERENDER_INJECTED\']` by default.                                                                   |\n| injectProperty                                                                                                         | String                                                                                                                                     | No        | `__PRERENDER_INJECTED` | The property to mount `inject` to during rendering.                                                                                                                                                                                                                   |\n| renderAfterDocumentEvent                                                                                               | String                                                                                                                                     | No        | None                   | Wait to render until the specified event is fired on the document. (You can fire an event like so: `document.dispatchEvent(new Event(\'custom-render-trigger\'))`                                                                                                       |\n| renderAfterElementExists                                                                                               | String (Selector)                                                                                                                          | No        | None                   | Wait to render until the specified element is detected using `document.querySelector`                                                                                                                                                                                 |\n| renderAfterTime                                                                                                        | Integer (Milliseconds)                                                                                                                     | No        | None                   | Wait to render until a certain amount of time has passed.                                                                                                                                                                                                             |\n| skipThirdPartyRequests                                                                                                 | Boolean                                                                                                                                    | No        | `false`                | Automatically block any third-party requests. (This can make your pages load faster by not loading non-essential scripts, styles, or fonts.)                                                                                                                          |\n| consoleHandler                                                                                                         | function(route: String, message: [ConsoleMessage](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#class-consolemessage)) | No        | None                   | Allows you to provide a custom console.* handler for pages. Argument one to your function is the route being rendered, argument two is the [Puppeteer ConsoleMessage](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#class-consolemessage) object. |\n| [[Puppeteer Launch Options]](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#puppeteerlaunchoptions) | ?                                                                                                                                          | No        | None                   | Any additional options will be passed to `puppeteer.launch()`, such as `headless: false`.                                                                                                                                                                             |\n\n---\n\n### `@prerenderer/renderer-jsdom` options\n\n| Option                   | Type                   | Required? | Default                  | Description                                                                                                                                                                                         |\n|--------------------------|------------------------|-----------|--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| maxConcurrentRoutes      | Number                 | No        | 0 (No limit)             | The number of routes allowed to be rendered at the same time. Useful for breaking down massive batches of routes into smaller chunks.                                                               |\n| inject                   | Object                 | No        | None                     | An object to inject into the global scope of the rendered page before it finishes loading. Must be `JSON.stringifiy`-able. The property injected to is `window[\'__PRERENDER_INJECTED\']` by default. |\n| injectProperty           | String                 | No        | `__PRERENDER_INJECTED` | The property to mount `inject` to during rendering.                                                                                                                                                 |\n| renderAfterDocumentEvent | String                 | No        | None                     | Wait to render until the specified event is fired on the document. (You can fire an event like so: `document.dispatchEvent(new Event(\'custom-render-trigger\'))`                                     |\n| renderAfterElementExists | String (Selector)      | No        | None                     | Wait to render until the specified element is detected using `document.querySelector`                                                                                                               |\n| renderAfterTime          | Integer (Milliseconds) | No        | None                     | Wait to render until a certain amount of time has passed.                                                                                                                                           |\n\n---\n\n## Tips & Troubleshooting\n\n### JS not firing before prerender?\n\nIf you have code that relies on the existence of `<body>` (and you almost certainly do), simply run it in a callback to the `DOMContentLoaded` event:\n*(Otherwise you\'ll find that `prerender-spa-plugin` will output the contents of your page before your JS runs.)*\n\n```js\ndocument.addEventListener(\'DOMContentLoaded\', function () {\n  // your code\n})\n```\n\nFor example, if you\'re using Vue.js and mounting to a `<div id="app">` in `<body>`:\n\n``` js\nconst root = new Vue({\n  // ...\n})\n\ndocument.addEventListener(\'DOMContentLoaded\', function () {\n  root.$mount(\'#app\')\n})\n```\n\n### Inline Styles\n\nIf you rely on inline CSS, i.e. you do not extract CSS from your bundle and, thus, experience duplicate CSS style tags, consider using [extract-text-webpack-plugin](https://github.com/webpack-contrib/extract-text-webpack-plugin) to extract CSS into a separate file and then either inject CSS back into a `template.html` file using [html-webpack-plugin](https://github.com/jantimon/html-webpack-plugin) or just call it as an external CSS file.\n\nEither way, there will not be any unnecessary styles inside JS.\n\n### Caveats\n\n- For obvious reasons, `prerender-spa-plugin` only works for SPAs that route using the HTML5 history API. `index.html#/hash/route` URLs will unfortunately not work.\n- Whatever client-side rendering library you\'re using should be able to at least replace any server-rendered content or diff with it.\n  - For **Vue.js 1** use [`replace: false`](http://vuejs.org/api/#replace) on root components.\n  - For **Vue.js 2**  Ensure your root component has the same id as the prerendered element it\'s replacing. Otherwise you\'ll end up with duplicated content.\n\n---\n\n## Alternatives\n\n- [react-snap](https://github.com/stereobooster/react-snap) - Zero-configuration framework-agnostic prerendering. Does not depend on webpack. Handles a variety of edge-cases.\n- [snapshotify](https://github.com/errorception/snapshotify) - An experimental prerenderer that performes a number of speed optimizations.\n- [presite](https://github.com/egoist/presite) - Minimal-configuration framework-agnostic prerendering.\n- [prerenderer](https://github.com/tribex/prerenderer) - Pluggable prerendering library that `prerender-spa-plugin` `v3+` is based on.\n\n## License (MIT)\n\n```\nCopyright (c) 2017 Chris Fritz\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the "Software"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n```\n\n## Maintainers\n\n<table>\n  <tbody>\n    <tr>\n      <td align="center">\n        <a href="https://github.com/chrisvfritz">\n          <img width="150" height="150" src="https://github.com/chrisvfritz.png?v=3&s=150">\n          </br>\n          Chris Fritz\n        </a>\n      </td>\n      <td align="center">\n        <a href="https://github.com/drewlustro">\n          <img width="150" height="150" src="https://github.com/drewlustro.png?v=3&s=150">\n          </br>\n          Drew Lustro\n        </a>\n      </td>\n      <td align="center">\n        <a href="https://github.com/tribex">\n          <img width="150" height="150" src="https://github.com/tribex.png?v=3&s=150">\n          </br>\n          Joshua Bemenderfer\n        </a>\n      </td>\n    </tr>\n  <tbody>\n</table>\n'