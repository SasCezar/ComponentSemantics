b'# Headless Chrome Crawler [![npm](https://badge.fury.io/js/headless-chrome-crawler.svg)](https://www.npmjs.com/package/headless-chrome-crawler) [![build](https://circleci.com/gh/yujiosaka/headless-chrome-crawler/tree/master.svg?style=shield&circle-token=ba45f930aed7057b79f2ac09df6be3e1b8ee954b)](https://circleci.com/gh/yujiosaka/headless-chrome-crawler/tree/master) [![Greenkeeper badge](https://badges.greenkeeper.io/yujiosaka/headless-chrome-crawler.svg)](https://greenkeeper.io/)\n\n###### [API](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/docs/API.md) | [Examples](https://github.com/yujiosaka/headless-chrome-crawler/tree/master/examples) | [Tips](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/docs/TIPS.md) | [Code of Conduct](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/docs/CODE_OF_CONDUCT.md) | [Contributing](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/docs/CONTRIBUTING.md) | [Changelog](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/docs/CHANGELOG.md)\n\nDistributed crawler powered by Headless Chrome\n\n<img src="https://user-images.githubusercontent.com/2261067/36531211-81d54840-1800-11e8-8aa7-019c777712bf.png" height="300" align="right">\n\n## Features\n\nCrawlers based on simple requests to HTML files are generally fast. However, it sometimes ends up capturing empty bodies, especially when the websites are built on such modern frontend frameworks as [AngularJS](https://angularjs.org), [React](https://reactjs.org) and [Vue.js](https://jp.vuejs.org/index.html).\n\nPowered by Headless Chrome, the crawler provides [simple APIs](#api-reference) to crawl these dynamic websites with the following features:\n\n* Distributed crawling\n* Configure concurrency, delay and retry\n* Support both [depth-first search](https://en.wikipedia.org/wiki/Depth-first_search) and [breadth-first search](https://en.wikipedia.org/wiki/Breadth-first_search) algorithm\n* Pluggable cache storages such as [Redis](https://redis.io)\n* Support [CSV](https://tools.ietf.org/html/rfc4180) and [JSON Lines](http://jsonlines.org) for exporting results\n* Pause at the max request and resume at any time\n* Insert [jQuery](https://jquery.com) automatically for scraping\n* Save screenshots for the crawling evidence\n* Emulate devices and user agents\n* Priority queue for crawling efficiency\n* Obey [robots.txt](https://developers.google.com/search/reference/robots_txt)\n* Follow [sitemap.xml](https://www.sitemaps.org/)\n* [Promise] support\n\n## Getting Started\n\n### Installation\n\n```sh\nyarn add headless-chrome-crawler\n# or "npm i headless-chrome-crawler"\n```\n\n> **Note**: headless-chrome-crawler contains [Puppeteer](https://github.com/GoogleChrome/puppeteer). During installation, it automatically downloads a recent version of Chromium. To skip the download, see [Environment variables](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#environment-variables).\n\n### Usage\n\n```js\nconst HCCrawler = require(\'headless-chrome-crawler\');\n\n(async () => {\n  const crawler = await HCCrawler.launch({\n    // Function to be evaluated in browsers\n    evaluatePage: (() => ({\n      title: $(\'title\').text(),\n    })),\n    // Function to be called with evaluated results from browsers\n    onSuccess: (result => {\n      console.log(result);\n    }),\n  });\n  // Queue a request\n  await crawler.queue(\'https://example.com/\');\n  // Queue multiple requests\n  await crawler.queue([\'https://example.net/\', \'https://example.org/\']);\n  // Queue a request with custom options\n  await crawler.queue({\n    url: \'https://example.com/\',\n    // Emulate a tablet device\n    device: \'Nexus 7\',\n    // Enable screenshot by passing options\n    screenshot: {\n      path: \'./tmp/example-com.png\'\n    },\n  });\n  await crawler.onIdle(); // Resolved when no queue is left\n  await crawler.close(); // Close the crawler\n})();\n```\n\n## Examples\n\n* [Priority queue for crawling efficiency](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/examples/priority-queue.js)\n* [Emulate device and user agent](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/examples/emulate-device.js)\n* [Redis cache to skip duplicate requests](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/examples/redis-cache.js)\n* [Export a CSV file for crawled results](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/examples/csv-exporter.js)\n* [Conditionally saving screenshots](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/examples/conditional-screenshot.js)\n\nSee [here](https://github.com/yujiosaka/headless-chrome-crawler/tree/master/examples) for the full examples list. The examples can be run from the root folder as follows:\n\n```sh\nNODE_PATH=../ node examples/priority-queue.js\n```\n\n## API reference\n\nSee [here](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/docs/API.md) for the API reference.\n\n## Debugging tips\n\nSee [here](https://github.com/yujiosaka/headless-chrome-crawler/blob/master/docs/TIPS.md) for the debugging tips.\n\n## FAQ\n\n### How is this different from other crawlers?\n\nThere are roughly two types of crawlers. One is static and the other is dynamic.\n\nThe static crawlers are based on simple requests to HTML files. They are generally fast, but fail scraping the contents when the HTML dynamically changes on browsers.\n\nDynamic crawlers based on [PhantomJS](http://phantomjs.org) and [Selenium](http://www.seleniumhq.org) work magically on such dynamic applications. However, [PhantomJS\'s maintainer has stepped down and recommended to switch to Headless Chrome](https://groups.google.com/forum/#!topic/phantomjs/9aI5d-LDuNE), which is fast and stable. [Selenium](http://www.seleniumhq.org) is still a well-maintained cross browser platform which runs on Chrome, Safari, IE and so on. However, crawlers do not need such cross browsers support.\n\nThis crawler is dynamic and based on Headless Chrome.\n\n### How is this different from Puppeteer?\n\nThis crawler is built on top of [Puppeteer](https://github.com/GoogleChrome/puppeteer).\n\n[Puppeteer](https://github.com/GoogleChrome/puppeteer) provides low to mid level APIs to manupulate Headless Chrome, so you can build your own crawler with it. This way you have more controls on what features to implement in order to satisfy your needs.\n\nHowever, most crawlers requires such common features as following links, obeying [robots.txt](https://developers.google.com/search/reference/robots_txt) and etc. This crawler is a general solution for most crawling purposes. If you want to quickly start crawling with Headless Chrome, this crawler is for you.\n'