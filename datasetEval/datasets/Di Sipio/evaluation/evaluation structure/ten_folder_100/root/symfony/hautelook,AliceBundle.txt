b'AliceBundle\n===========\n\nA [Symfony](http://symfony.com) bundle to manage fixtures with [nelmio/alice](https://github.com/nelmio/alice) and\n[fzaninotto/Faker](https://github.com/fzaninotto/Faker).\n\nThe database support is done in [FidryAliceDataFixtures](https://github.com/theofidry/AliceDataFixtures). Check this\nproject to know which database/ORM is supported.\n\n**Warning: this is the documentation for HautelookAliceBundle 2.0. If you want to check the documentation for 1.x, head\n[this way](https://github.com/hautelook/AliceBundle/tree/1.x).**\n\n[![Package version](https://img.shields.io/packagist/v/hautelook/alice-bundle.svg?style=flat-square)](https://packagist.org/packages/hautelook/alice-bundle)\n[![Build Status](https://img.shields.io/travis/hautelook/AliceBundle/master.svg?style=flat-square)](https://travis-ci.org/hautelook/AliceBundle?branch=master)\n[![SensioLabsInsight](https://img.shields.io/sensiolabs/i/d93a3fc4-3fe8-4be3-aa62-307f53898199.svg?style=flat-square)](https://insight.sensiolabs.com/projects/d93a3fc4-3fe8-4be3-aa62-307f53898199)\n[![Dependency Status](https://www.versioneye.com/user/projects/55d26478265ff6001a000084/badge.svg?style=flat)](https://www.versioneye.com/user/projects/55d26478265ff6001a000084)\n[![Scrutinizer Code Quality](https://img.shields.io/scrutinizer/g/hautelook/AliceBundle.svg?style=flat-square)](https://scrutinizer-ci.com/g/hautelook/AliceBundle/?branch=master)\n[![Code Coverage](https://img.shields.io/scrutinizer/coverage/g/hautelook/AliceBundle.svg?b=master&style=flat-square)](https://scrutinizer-ci.com/g/hautelook/AliceBundle/?branch=master)\n[![Slack](https://img.shields.io/badge/slack-%23alice--fixtures-red.svg?style=flat-square)](https://symfony-devs.slack.com/shared_invite/MTYxMjcxMjc0MTc5LTE0OTA3ODE4OTQtYzc4NWVmMzRmZQ)\n\n\n## When to use this bundle?\n\nHautelookAliceBundle changed a lot, it first was acting as a simple bundle for [nelmio/alice](https://github.com/nelmio/alice),\nit then started to ship some additional features to enrich it.\n\nHautelookAliceBundle 1.x was the first milestone reaching a certain level of maturity in its usage:\n\n- Easily load a set of fixtures from a command\n- Being able to define different sets of fixtures for multiple environments\n- Customize the data generation with custom Faker providers\n- Customize the loading behaviour with processors\n\nHautelookAliceBundle 2.x changes a lot, although not so much. In 1.x, a lot of complexity was brought in the bundle\ndue to nelmio/alice 2.x limitations and were at best workarounds (like the lack of handling of circular references).\nA lot of that complexity has been pushed back to nelmio/alice 3.x which has a much more flexible design. As a result:\n\n- [nelmio/alice](https://github.com/nelmio/alice) 3.x allows you to easily create PHP objects with random data in an elegant way\n- [FidryAliceDataFixtures](https://github.com/theofidry/AliceDataFixtures) is a persistence layer for nelmio/alice 3.x. If you need to persist the loaded objects,\n  it is the package you need. It provides you the flexibility to be able to purge the data between each loadings or\n  wrap the loading in a transaction for your tests for example to simply rollback once the test is finished instead of\n  calling an expansive purge.\n- hautelook/alice-bundle 2.x provides high-level features including fixtures discovery (find the appropriate files and load them),\n  and helpers for database testing.\n  If you just need to load specific sets of files for your tests, [FidryAliceDataFixtures](https://github.com/theofidry/AliceDataFixtures) is enough.\n\n\n## Documentation\n\n1. [Install](#installation)\n1. [Basic usage](#basic-usage)\n1. [Database testing](#database-testing)\n1. [Advanced usage](doc/advanced-usage.md)\n    1. [Enabling databases](doc/advanced-usage.md#enabling-databases)\n    1. [Environment specific fixtures](doc/advanced-usage.md#environment-specific-fixtures)\n    1. [Fixtures parameters](doc/advanced-usage.md#fixtures-parameters)\n        1. [Alice parameters](doc/advanced-usage.md#alice-parameters)\n        1. [Application parameters](doc/advanced-usage.md#application-parameters)\n    1. [Use service factories](doc/advanced-usage.md#use-service-factories)\n    1. [Load fixtures in a specific order](doc/advanced-usage.md#load-fixtures-in-a-specific-order)\n        1. [Load fixtures in a specific order](doc/advanced-usage.md#ordering-the-files-found)\n        1. [Persisting the classes in a specific order](doc/advanced-usage.md#persisting-the-classes-in-a-specific-order)\n1. [Custom Faker Providers](doc/faker-providers.md)\n1. [Custom Alice Processors](doc/alice-processors.md)\n1. [Resources](#resources)\n\n\n## Installation\n\nWith [Symfony Flex](https://symfony.com/doc/current/setup/flex.html) (recommended):\n\n```\n# If you do not have Doctrine installed yet:\ncomposer require doctrine-orm\n\ncomposer require --dev hautelook/alice-bundle \n```\n\nYou\'re ready to use AliceBundle, and can jump to the next section!\n\nWithout Flex you will have to install `doctrine/orm` and register the bundles accordingly in `app/AppKernel.php` or\nwherever your Kernel class is located:\n\n```php\n<?php\n// app/AppKernel.php\n\npublic function registerBundles()\n{\n    $bundles = [\n        new Symfony\\Bundle\\FrameworkBundle\\FrameworkBundle(),\n        // ...\n        new Doctrine\\Bundle\\DoctrineBundle\\DoctrineBundle(),\n    ];\n    \n    if (in_array($this->getEnvironment(), [\'dev\', \'test\'])) {\n        //...\n        $bundles[] = new Nelmio\\Alice\\Bridge\\Symfony\\NelmioAliceBundle();\n        $bundles[] = new Fidry\\AliceDataFixtures\\Bridge\\Symfony\\FidryAliceDataFixturesBundle();\n        $bundles[] = new Hautelook\\AliceBundle\\HautelookAliceBundle();\n    }\n\n    return $bundles;\n}\n```\n\nConfigure the bundle to your needs, for example:\n\n```yaml\n# config/packages/dev/hautelook_alice.yaml\n\nhautelook_alice:\n    fixtures_path: \'fixtures\' # Path to which to look for fixtures relative to the project directory or the bundle path. May be a string or an array of strings.\n    root_dirs:\n        - \'%kernel.root_dir%\'\n        - \'%kernel.project_dir%\'\n```\n\nIf you are using a non-flex architecture, you may want to use `Resources/fixtures` instead of `fixtures`.\n\n\n## Basic usage\n\nAssuming you are using [Doctrine](http://www.doctrine-project.org/projects/orm.html), make sure you\nhave the [`doctrine/doctrine-bundle`](https://github.com/doctrine/DoctrineBundle) and\n[`doctrine/data-fixtures`](https://github.com/doctrine/data-fixtures) packages installed.\n\nThen create a fixture file in one of the following location:\n\n- `fixtures` if you are using flex\n- `app/Resources/fixtures` if you have a non-flex bundle-less Symfony application\n- `src/AppBundle/Resources/fixtures` or any bundle under which you want to place the fixtures\n\n```yaml\n# fixtures/dummy.yaml\n\nApp\\Entity\\Dummy:\n    dummy_{1..10}:\n        name: <name()>\n        related_dummy: \'@related_dummy*\'\n```\n\n```yaml\n# fixtures/related_dummy.yaml\n\nApp\\Entity\\RelatedDummy:\n    related_dummy_{1..10}:\n        name: <name()>\n```\n\nThen simply load your fixtures with the doctrine command `php bin/console hautelook:fixtures:load`.\n\nIf you want to load the fixtures of a bundle only, do `php bin/console hautelook:fixtures:load -b MyFirstBundle -b MySecondBundle`.\n\n[See more](#documentation).<br />\nNext chapter: [Advanced usage](doc/advanced-usage.md)\n\n\n## Database testing\n\nThe bundle provides nice helpers, [inspired by Laravel](https://laravel.com/docs/5.6/database-testing#resetting-the-database-after-each-test),\ndedicated for database testing: `RefreshDatabaseTrait`, `ReloadDatabaseTrait` and `RecreateDatabaseTrait`.\nThese traits allow to easily reset the database in a known state before each PHPUnit test: it purges the database then loads\nthe fixtures.\n\nThey are particularly helpful when writing [functional tests](https://symfony.com/doc/current/testing.html#functional-tests)\nand when using [Panther](https://github.com/symfony/panther).\n\nTo improve performance, `RefreshDatabaseTrait` populates the database only one time, then wraps every tests in a\ntransaction that will be rolled back at the end after its execution (regardless of if it\'s a success or a failure):\n\n```php\n<?php\n\nnamespace App\\Tests;\n\nuse Hautelook\\AliceBundle\\PhpUnit\\RefreshDatabaseTrait;\nuse Symfony\\Bundle\\FrameworkBundle\\Test\\WebTestCase;\n\nclass NewsTest extends WebTestCase\n{\n    use RefreshDatabaseTrait;\n\n    public function postCommentTest()\n    {\n        $client = static::createClient(); // The transaction starts just after the boot of the Symfony kernel\n        $crawler = $client->request(\'GET\', \'/my-news\');\n        $form = $crawler->filter(\'#post-comment\')->form([\'new-comment\' => \'Symfony is so cool!\']);\n        $client->submit($form);\n        // At the end of this test, the transaction will be rolled back (even if the test fails)\n    }\n}\n```\n\nSometimes, wrapping tests in transactions is not possible. For instance, when using Panther, changes to the database\nare made by another PHP process, so it wont work.\nIn such cases, use the `ReloadDatabase` trait. It will purge the DB and load fixtures before every tests:\n\n```php\n<?php\n\nnamespace App\\Tests;\n\nuse Hautelook\\AliceBundle\\PhpUnit\\ReloadDatabaseTrait;\nuse Symfony\\Component\\Panther\\PantherTestCase;\n\nclass NewsTest extends PantherTestCase // Be sure to extends KernelTestCase, WebTestCase or PantherTestCase\n{\n    use ReloadDatabaseTrait;\n\n    public function postCommentTest()\n    {\n        $client = static::createPantherClient();// The database will be reset after every boot of the Symfony kernel\n\n        $crawler = $client->request(\'GET\', \'/my-news\');\n        $form = $crawler->filter(\'#post-comment\')->form([\'new-comment\' => \'Symfony is so cool!\']);\n        $client->submit($form);\n    }\n}\n```\n\nThis strategy doesn\'t work when using Panther, because the changes to the database are done by another process, outside\nof the transaction.\n\nBoth traits provide several configuration options as protected static properties:\n\n* `self::$manager`: The name of the Doctrine manager to use\n* `self::$bundles`: The list of bundles where to look for fixtures\n* `self::$append`: Append fixtures instead of purging\n* `self::$purgeWithTruncate`: Use TRUNCATE to purge\n* `self::$shard`: The name of the Doctrine shard to use\n* `self::$connection`: The name of the Doctrine connection to use\n\nUse them in the `setUpBeforeClass` method.\n\n```php\n<?php\n\nnamespace App\\Tests;\n\nuse Hautelook\\AliceBundle\\PhpUnit\\RefreshDatabaseTrait;\nuse Symfony\\Bundle\\FrameworkBundle\\Test\\WebTestCase;\n\nclass NewsTest extends WebTestCase\n{\n    use RefreshDatabaseTrait;\n\n    public static function setUpBeforeClass()\n    {\n        self::$append = true;\n    }\n\n    // ...\n}\n```\n\nFinally, if you\'re using in memory SQLite for your tests, use `RecreateDatabaseTrait` to create the database schema "on the fly":\n```php\n<?php\n\nnamespace App\\Tests;\n\nuse Hautelook\\AliceBundle\\PhpUnit\\RecreateDatabaseTrait;\nuse Symfony\\Bundle\\FrameworkBundle\\Test\\WebTestCase;\n\nclass NewsTest extends WebTestCase\n{\n    use RecreateDatabaseTrait;\n\n    // ...\n}\n```\n\n## Resources\n\n* Behat extension: [AliceBundleExtension](https://github.com/theofidry/AliceBundleExtension)\n* Bundle for generating AliceBundle compatible fixtures directly from Doctrine entities: [AliceGeneratorBundle](https://github.com/trappar/AliceGeneratorBundle)\n* [Upgrade guide](UPGRADE.md)\n  * [Upgrade from 0.X to 1.X](UPGRADE.md#from-0x-to-1x)\n* [Changelog](CHANGELOG.md)\n\n\n## Credits\n\nThis bundle was originaly developped by [Baldur RENSCH](https://github.com/baldurrensch) and [HauteLook](https://github.com/hautelook). It is now maintained by [Th\xc3\xa9o FIDRY](https://github.com/theofidry).\n\n[Other contributors](https://github.com/hautelook/AliceBundle/graphs/contributors).\n\n\n## License\n\n[![license](https://img.shields.io/badge/license-MIT-red.svg?style=flat-square)](LICENSE)\n'