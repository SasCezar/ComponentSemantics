b'<h1 align="center"><img src="panther.png" alt="Panther" width="250" height="250"></h1>\n\n**A browser testing and web scraping library for [PHP](https://php.net) and [Symfony](https://symfony.com)**\n\n[![Build Status](https://travis-ci.org/symfony/panther.svg?branch=master)](https://travis-ci.org/symfony/panther)\n[![Build status](https://ci.appveyor.com/api/projects/status/bunoc4ufud4oie45?svg=true)](https://ci.appveyor.com/project/fabpot/panther)\n[![SymfonyInsight](https://insight.symfony.com/projects/9ea7e78c-998a-4489-9815-7449ce8291ef/mini.png)](https://insight.symfony.com/projects/9ea7e78c-998a-4489-9815-7449ce8291ef)\n\n*Panther* is a convenient standalone library to scrape websites and to run end-to-end tests **using real browsers**.\n\nPanther is super powerful. It leverages [the W3C\'s WebDriver protocol](https://www.w3.org/TR/webdriver/) to drive native web browsers such as Google Chrome and Firefox.\n\nPanther is very easy to use, because it implements Symfony\'s popular [BrowserKit](https://symfony.com/doc/current/components/browser_kit.html) and\n[DomCrawler](https://symfony.com/doc/current/components/dom_crawler.html) APIs, and contains\nall the features you need to test your apps. It will sound familiar if you have ever created [a functional test for a Symfony app](https://symfony.com/doc/current/testing.html#functional-tests):\nas the API is exactly the same!\nKeep in mind that Panther can be used in every PHP project, as it is a standalone library.\n\nPanther automatically finds your local installation of Chrome and launches it (thanks to [ChromeDriver](https://sites.google.com/a/chromium.org/chromedriver/)),\nso you don\'t need to install anything on your computer, neither Selenium server nor any other obscure driver.\n\nIn test mode, Panther automatically starts your application using [the PHP built-in web-server](http://php.net/manual/en/features.commandline.webserver.php).\nYou can focus on writing your tests or web-scraping scenario and Panther will take care of everything else.\n\n## Features\n\nUnlike testing and web scraping libraries you\'re used to, Panther:\n\n* executes the JavaScript code contained in webpages\n* supports everything that Chrome (or Firefox) implements\n* allows screenshots taking\n* can wait for asynchronously loaded elements to show up\n* lets you run your own JS code or XPath queries in the context of the loaded page\n* supports custom [Selenium server](https://www.seleniumhq.org) installations\n* supports remote browser testing services including [SauceLabs](https://saucelabs.com/) and [BrowserStack](https://www.browserstack.com/)\n\n## Documentation\n\n### Install\n\nUse [Composer](https://getcomposer.org/) to install Panther in your project. You may want to use the `--dev` flag if you want to use Panther for testing only and not for web scraping in a production environment:\n\n    composer req symfony/panther\n\n    composer req --dev symfony/panther\n\n**Warning:** On \\*nix systems, the `unzip` command must be installed or you will encounter an error similar to `RuntimeException: sh: 1: exec: /app/vendor/symfony/panther/src/ProcessManager/../../chromedriver-bin/chromedriver_linux64: Permission denied` (or `chromedriver_linux64: not found`).\nThe underlying reason is that PHP\'s `ZipArchive` doesn\'t preserve UNIX executable permissions.\n\n#### Registering the PHPUnit Extension\n\nIf you intend to use Panther to test your application, we strongly recommended to register the Panther PHPUnit extension.\nWhile not strictly mandatory, this extension dramatically improves the testing experience by boosting the performance and\nallowing to use the [interactive debugging mode](#interactive-mode).\n\nTo register the Panther extension, add the following lines to `phpunit.xml.dist`:\n\n```xml\n<!-- phpunit.xml.dist -->\n    <extensions>\n        <extension class="Symfony\\Component\\Panther\\ServerExtension" />\n    </extensions>\n```\n\nWithout the extension, the web server used by Panther to serve the application under test is started on demand and\nstopped when called `tearDownAfterClass()` is called.\nOn the other hand, when the extension is registered, the web server will be stopped only after the very last test.\n\nTo use the Panther extension, PHPUnit 7.3+ is required. Nonetheless, a listener is provided for older versions:\n\n```xml\n<!-- phpunit.xml.dist -->\n    <listeners>\n        <listener class="Symfony\\Component\\Panther\\ServerListener" />\n    </listeners>\n```\n\nThis listener will start the web server on demand like previously, but it will stop it after each test suite.\n\n### Basic Usage\n\n```php\n<?php\n\nrequire __DIR__.\'/vendor/autoload.php\'; // Composer\'s autoloader\n\n$client = \\Symfony\\Component\\Panther\\Client::createChromeClient();\n$client->request(\'GET\', \'https://api-platform.com\'); // Yes, this website is 100% written in JavaScript\n$client->clickLink(\'Support\');\n\n// Wait for an element to be rendered\n$crawler = $client->waitFor(\'.support\');\n\necho $crawler->filter(\'.support\')->text();\n$client->takeScreenshot(\'screen.png\'); // Yeah, screenshot!\n```\n\n### Testing Usage\n\nThe `PantherTestCase` class allows you to easily write E2E tests. It automatically starts your app using the built-in PHP\nweb server and let you crawl it using Panther.\nTo provides all of the testing tools you\'re used to, it extends [PHPUnit](https://phpunit.de/)\'s `TestCase`.\n\nIf you are testing a Symfony application, `PantherTestCase` automatically extends [the `WebTestCase` class](https://symfony.com/doc/current/testing.html#functional-tests).\nIt means you can easily create functional tests, which can directly execute the kernel of your application and access all\nyour existing services. In this case, you can use [all crawler test assertions](https://symfony.com/doc/current/testing/functional_tests_assertions.html#crawler)\nprovided by Symfony with Panther.\n\n```php\n<?php\n\nnamespace App\\Tests;\n\nuse Symfony\\Component\\Panther\\PantherTestCase;\n\nclass E2eTest extends PantherTestCase\n{\n    public function testMyApp(): void\n    {\n        $client = static::createPantherClient(); // Your app is automatically started using the built-in web server\n        $client->request(\'GET\', \'/mypage\');\n\n        // Use any PHPUnit assertion, including the ones provided by Symfony\n        $this->assertPageTitleContains(\'My Title\');\n        $this->assertSelectorTextContains(\'#main\', \'My body\');\n    }\n}\n```\n\nTo run this test:\n\n    phpunit tests/E2eTest.php\n\n### A Polymorphic Feline\n\nPanther also gives you instant access to other BrowserKit-based implementations of `Client` and `Crawler`.\nUnlike Panther\'s native client, these alternative clients don\'t support JavaScript, CSS and screenshot capturing,\nbut they are **super-fast**!\n\nTwo alternative clients are available:\n\n* The first directly manipulates the Symfony kernel provided by `WebTestCase`. It is the fastest client available,\n  but it is only available for Symfony apps.\n* The second leverages the [Goutte](https://github.com/FriendsOfPHP/Goutte) web scraping library.\n  It is an intermediate between Symfony\'s and Panther\'s test clients. Goutte sends real HTTP requests. \n  It is fast and is able to browse any webpage, not only the ones of the application under test.\n  However, Goutte doesn\'t support JavaScript and other advanced features because it is entirely written in PHP.\n  This one is available even for non-Symfony apps!\n\nThe fun part is that the 3 clients implement the exact same API, so you can switch from one to another just by calling\nthe appropriate factory method, resulting in a good trade-off for every single test case (Do I need JavaScript? Do I need\nto authenticate with an external SSO server? Do I want to access the kernel of the current request? ... etc).\n\nHere is how to retrieve instances of these clients:\n\n```php\n<?php\n\nnamespace App\\Tests;\n\nuse Symfony\\Component\\Panther\\PantherTestCase;\nuse Symfony\\Component\\Panther\\Client;\n\nclass E2eTest extends PantherTestCase\n{\n    public function testMyApp()\n    {\n        $symfonyClient = static::createClient(); // A cute kitty: Symfony\'s functional test tool\n        $goutteClient = static::createGoutteClient(); // An agile lynx: Goutte\n        $pantherClient = static::createPantherClient(); // A majestic Panther\n        // Both Goutte and Panther benefits from the built-in HTTP server\n\n        $customChromeClient = Client::createChromeClient(null, null, [], \'https://example.com\'); // Create a custom Chrome client\n        $customSeleniumClient = Client::createSeleniumClient(\'http://127.0.0.1:4444/wd/hub\', null, \'https://example.com\'); // Create a custom Selenium client\n        // When initializing a custom client, the integrated web server IS NOT started automatically.\n        // Use PantherTestCase::startWebServer() or WebServerManager if you want to start it manually.\n\n        // enjoy the same API for the 3 felines\n        // $*client->request(\'GET\', \'...\')\n\n        $kernel = static::createKernel(); // If you are testing a Symfony app, you also have access to the kernel\n\n        // ...\n    }\n}\n```\n\n### Creating Isolated Browsers to Test Apps Using [Mercure](https://mercure.rocks) or WebSocket\n\nPanther provides a convenient way to test applications with real-time capabilities which use [Mercure](https://symfony.com/doc/current/mercure.html), [WebSocket](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API)\nand similar technologies.\n\n`PantherTestCase::createAdditionalPantherClient()` creates additional, isolated browsers which can interact with each other.\nFor instance, this can be useful to test a chat application having several users connected simultaneously:\n\n```php\n<?php\n\nuse Symfony\\Component\\Panther\\PantherTestCase;\n\nclass ChatTest extends PantherTestCase\n{\n    public function testChat(): void\n    {\n        $client1 = self::createPantherClient();\n        $client1->request(\'GET\', \'/chat\'); \n \n        // Connect a 2nd user using an isolated browser and say hi!\n        $client2 = self::createAdditionalPantherClient();\n        $client2->request(\'GET\', \'/chat\');\n        $client2->submitForm(\'Post message\', [\'message\' => \'Hi folks \xf0\x9f\x91\x8b\xf0\x9f\x98\xbb\']);\n\n        // Wait for the message to be received by the first client\n        $client1->waitFor(\'.message\');\n\n        // Symfony Assertions are always executed in the **primary** browser\n        $this->assertSelectorTextContains(\'.message\', \'Hi folks \xf0\x9f\x91\x8b\xf0\x9f\x98\xbb\');\n    }\n}\n```\n\n## Additional Documentation\n\nSince Panther implements the API of popular libraries, it already has extensive documentation:\n\n* For the `Client` class, read [the BrowserKit documentation](https://symfony.com/doc/current/components/browser_kit.html)\n* For the `Crawler` class, read [the DomCrawler documentation](https://symfony.com/doc/current/components/dom_crawler.html)\n* For WebDriver, read [the Facebook PHP WebDriver documentation](https://github.com/facebook/php-webdriver)\n\n### Environment Variables\n\nThe following environment variables can be set to change some Panther\'s behaviour:\n\n* `PANTHER_NO_HEADLESS`: to disable browser\'s headless mode (will display the testing window, useful to debug)\n* `PANTHER_NO_SANDBOX`: to disable [Chrome\'s sandboxing](https://chromium.googlesource.com/chromium/src/+/b4730a0c2773d8f6728946013eb812c6d3975bec/docs/design/sandbox.md) (unsafe, but allows to use Panther in containers)\n* `PANTHER_WEB_SERVER_DIR`: to change the project\'s document root (default to `public/`)\n* `PANTHER_CHROME_DRIVER_BINARY`: to use another `chromedriver` binary, instead of relying on the ones already provided by Panther\n* `PANTHER_CHROME_ARGUMENTS`: to customize `chromedriver` arguments. You need to set `PANTHER_NO_HEADLESS` to fully customize.\n* `PANTHER_WEB_SERVER_PORT`: to change the web server\'s port (default to `9080`)\n* `PANTHER_WEB_SERVER_ROUTER`:  to use a web server router script which is run at the start of each HTTP request\n* `PANTHER_EXTERNAL_BASE_URI`: to use an external web server (the PHP built-in web server will not be started)\n* `PANTHER_CHROME_BINARY`: to use another `google-chrome` binary\n* `PANTHER_APP_ENV`: to override the `APP_ENV` variable passed to the web server running the PHP app\n\n### Accessing To Hidden Text\n\nAccording to the spec, WebDriver implementations return only the **displayed** text by default.\nWhen you filter on a `head` tag (like `title`), the method `text()` returns an empty string. Use the method `html()` to get\nthe complete contents of the tag, including the tag itself.\n\n### Interactive Mode\n\nPanther can make a pause in your tests suites after a failure.\nIt is a break time really appreciated for investigating the problem through the web browser.\nFor enabling this mode, you need the `--debug` PHPUnit option without the headless mode:\n\n    $ export PANTHER_NO_HEADLESS=1\n    $ phpunit --debug\n    \n    Test \'App\\AdminTest::testLogin\' started\n    Error: something is wrong.\n    \n    Press enter to continue...\n\nTo use the interactive mode, the [PHPUnit extension](#registering-the-phpunit-extension) **must** be registered.\n\n### Using an External Web Server\n\nSometimes, it\'s convenient to reuse an existing web server configuration instead of starting the built-in PHP one.\nTo do so, set the `external_base_uri` option:\n\n```php\n<?php\n\nnamespace App\\Tests;\n\nuse Symfony\\Component\\Panther\\PantherTestCase;\n\nclass E2eTest extends PantherTestCase\n{\n    public function testMyApp()\n    {\n        $pantherClient = static::createPantherClient([\'external_base_uri\' => \'https://localhost\']);\n        // the PHP integrated web server will not be started\n    }\n}\n```\n\n### Using a Proxy \n\nTo use a proxy server, set the following environment variable: `PANTHER_CHROME_ARGUMENTS=\'--proxy-server=socks://127.0.0.1:9050\'`\n\n### Accepting Self-signed SSL Certificates\n\nTo force Chrome to accept invalid and self-signed certificates, set the following environment variable: `PANTHER_CHROME_ARGUMENTS=\'--ignore-certificate-errors\'`\n**This option is insecure**, use it only for testing in development environments, never in production (e.g. for web crawlers).\n\n### Docker Integration\n\nHere is a minimal Docker image that can run Panther:\n\n```\nFROM php:latest\n\nRUN apt-get update && apt-get install -y libzip-dev zlib1g-dev chromium && docker-php-ext-install zip\nENV PANTHER_NO_SANDBOX 1\n```\n\nBuild it with `docker build . -t myproject`\nRun it with `docker run -it -v "$PWD":/srv/myproject -w /srv/myproject myproject bin/phpunit`\n\nIf you are using **Alpine Linux**, you may need to use another `chromedriver` binary.\n\n```\nRUN apk add --no-cache \\\n        chromium \\\n        chromium-chromedriver\nENV PANTHER_CHROME_DRIVER_BINARY /usr/lib/chromium/chromedriver\n```\n\n### Travis CI Integration\n\nPanther will work out of the box with Travis if you add the Chrome addon. Here is a minimal `.travis.yml` file to run\nPanther tests:\n\n```yaml\nlanguage: php\naddons:\n  chrome: stable\n\nphp:\n  - 7.1\n  - 7.2\n\nscript:\n  - phpunit\n```\n\n### Gitlab CI Integration\n\nHere is a minimal `.gitlab-ci.yml` file to run:\n\n```yaml\nimage: ubuntu:bionic\n\nservices:\n  - postgres:11\n\nvariables:\n  POSTGRES_PASSWORD: root\n  POSTGRES_USER: root\n  POSTGRES_DB: db\n\nbefore_script:\n    - apt-get update\n    - apt-get install software-properties-common -y\n    - ln -sf /usr/share/zoneinfo/Asia/Tokyo /etc/localtime\n    - apt-get install curl wget php php-cli php7.2 php7.2-common php7.2-curl php7.2-pgsql php7.2-mysql php7.2-intl php7.2-gd php7.2-xml php7.2-opcache php7.2-mbstring php7.2-zip libfontconfig1 fontconfig libxrender-dev libfreetype6 libxrender1 zlib1g-dev xvfb chromium-browser chromium-chromedriver -y -qq\n    - export PANTHER_CHROME_DRIVER_BINARY="/usr/lib/chromium-browser/chromedriver"\n    - export PANTHER_NO_SANDBOX=1\n    - export PANTHER_WEB_SERVER_PORT=9800\n    - php -r "copy(\'https://getcomposer.org/installer\', \'composer-setup.php\');"\n    - php composer-setup.php --install-dir=/usr/local/bin --filename=composer\n    - php -r "unlink(\'composer-setup.php\');"\n    - composer\n    - chromedriver --version\n    - php -v\n    - php -m\n    - composer install --ignore-platform-reqs\n    - bin/console doctrine:schema:update --force\n    - bin/console doctrine:schema:validate\n    - bin/console doctrine:fixtures:load\n\nstages:\n- test\n\ntest:\n  script:\n    - vendor/bin/simple-phpunit tests/Controller/E2eTest.php\n```\n\n\n### AppVeyor Integration\n\nPanther will work out of the box with AppVeyor as long as Google Chrome is installed. Here is a minimal `appveyor.yml`\nfile to run Panther tests:\n\n```yaml\nbuild: false\nplatform: x86\nclone_folder: c:\\projects\\myproject\n\ncache:\n  - \'%LOCALAPPDATA%\\Composer\\files\'\n\ninstall:\n  - ps: Set-Service wuauserv -StartupType Manual\n  - cinst -y php composer googlechrome\n  - refreshenv\n  - cd c:\\tools\\php73\n  - copy php.ini-production php.ini /Y\n  - echo date.timezone="UTC" >> php.ini\n  - echo extension_dir=ext >> php.ini\n  - echo extension=php_openssl.dll >> php.ini\n  - echo extension=php_mbstring.dll >> php.ini\n  - echo extension=php_curl.dll >> php.ini\n  - echo memory_limit=3G >> php.ini\n  - cd %APPVEYOR_BUILD_FOLDER%\n  - composer install --no-interaction --no-progress\n\ntest_script:\n  - cd %APPVEYOR_BUILD_FOLDER%\n  - php vendor\\phpunit\\phpunit\\phpunit\n```\n\n### Usage with Other Testing Tools\n\nIf you want to use Panther with other testing tools like [LiipFunctionalTestBundle](https://github.com/liip/LiipFunctionalTestBundle) or if you just need to use a different base class, Panther has got you covered. It provides you with the `Symfony\\Component\\Panther\\PantherTestCaseTrait` and you can use it to enhance your existing test-infrastructure with some Panther awesomeness:\n\n```php\n<?php\n\nnamespace App\\Tests\\Controller;\n\nuse Liip\\FunctionalTestBundle\\Test\\WebTestCase;\nuse Symfony\\Component\\HttpFoundation\\Response;\nuse Symfony\\Component\\Panther\\PantherTestCaseTrait;\n\nclass DefaultControllerTest extends WebTestCase\n{\n    use PantherTestCaseTrait; // this is the magic. Panther is now available.\n\n    public function testWithFixtures()\n    {\n        $this->loadFixtures([]); // load your fixtures\n        $client = self::createPantherClient(); // create your panther client\n\n        $client->request(\'GET\', \'/\');\n    }\n}\n```\n\n## Limitations\n\nThe following features are not currently supported:\n\n* Crawling XML documents (only HTML is supported)\n* Updating existing documents (browsers are mostly used to consume data, not to create webpages)\n* Setting form values using the multidimensional PHP array syntax\n* Methods returning an instance of `\\DOMElement` (because this library uses `WebDriverElement` internally)\n* Selecting invalid choices in select\n\nPull Requests are welcome to fill the remaining gaps!\n\n## Save the Panthers\n\nMany of the wild cat species are highly threatened.\nIf you like this software, help save the (real) panthers by [donating to the Panthera organization](https://www.panthera.org/donate).\n\n## Credits\n\nCreated by [K\xc3\xa9vin Dunglas](https://dunglas.fr). Sponsored by [Les-Tilleuls.coop](https://les-tilleuls.coop).\n\nPanther is built on top of [PHP WebDriver](https://github.com/facebook/php-webdriver) and [several other FOSS libraries](https://symfony.com/blog/introducing-symfony-panther-a-browser-testing-and-web-scrapping-library-for-php#thank-you-open-source). It has been inspired by [Nightwatch.js](http://nightwatchjs.org/), a WebDriver-based testing tool for JavaScript.\n'