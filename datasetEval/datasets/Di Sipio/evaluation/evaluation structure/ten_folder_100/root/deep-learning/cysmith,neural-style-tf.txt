b'# neural-style-tf\n\nThis is a TensorFlow implementation of several techniques described in the papers: \n* [Image Style Transfer Using Convolutional Neural Networks](http://www.cv-foundation.org/openaccess/content_cvpr_2016/papers/Gatys_Image_Style_Transfer_CVPR_2016_paper.pdf)\nby Leon A. Gatys, Alexander S. Ecker, Matthias Bethge\n* [Artistic style transfer for videos](https://arxiv.org/abs/1604.08610)\nby Manuel Ruder, Alexey Dosovitskiy, Thomas Brox\n* [Preserving Color in Neural Artistic Style Transfer](https://arxiv.org/abs/1606.05897)\nby Leon A. Gatys, Matthias Bethge, Aaron Hertzmann, Eli Shechtman  \n\nAdditionally, techniques are presented for semantic segmentation and multiple style transfer.\n\nThe Neural Style algorithm synthesizes a [pastiche](https://en.wikipedia.org/wiki/Pastiche) by separating and combining the content of one image with the style of another image using convolutional neural networks (CNN). Below is an example of transferring the artistic style of [The Starry Night](https://en.wikipedia.org/wiki/The_Starry_Night) onto a photograph of an African lion:\n\n<p align="center">\n<img src="examples/lions/42_output.png" width="512"/>\n<img src="examples/lions/content_style.png" width="290"/>\n</p>\n\nTransferring the style of various artworks to the same content image produces qualitatively convincing results:\n<p align="center">\n<img src="examples/lions/32_output.png" width="192">\n<img src="examples/lions/styles/matisse_crop.jpg" width="192"/>\n<img src="examples/lions/33_output.png" width="192"/>\n<img src="examples/lions/styles/water_lilies_crop.jpg" width="192"/>\n\n<img src="examples/lions/wave_output.png" width="192"/>\n<img src="examples/lions/styles/wave_crop.jpg" width="192"/>\n<img src="examples/lions/basquiat_output.png" width="192"/>\n<img src="examples/lions/styles/basquiat_crop.jpg" width="192"/>  \n\n<img src="examples/lions/calliefink_output.png" width="192"/>\n<img src="examples/lions/styles/calliefink_crop.jpg" width="192"/>\n<img src="examples/lions/giger_output.png" width="192"/>\n<img src="examples/lions/styles/giger_crop.jpg" width="192"/>\n</p>\n\nHere we reproduce Figure 3 from the first paper, which renders a photograph of the Neckarfront in T\xc3\xbcbingen, Germany in the style of 5 different iconic paintings [The Shipwreck of the Minotaur](http://www.artble.com/artists/joseph_mallord_william_turner/paintings/the_shipwreck_of_the_minotaur), [The Starry Night](https://www.wikiart.org/en/vincent-van-gogh/the-starry-night-1889), [Composition VII](https://www.wikiart.org/en/wassily-kandinsky/composition-vii-1913), [The Scream](https://www.wikiart.org/en/edvard-munch/the-scream-1893), [Seated Nude](http://www.pablopicasso.org/seated-nude.jsp):\n<p align="center">\n<img src="examples/gatys_figure/tubingen.png" height="192px">\n<img src="examples/gatys_figure/tubingen_shipwreck.png" height="192px">\n<img src="examples/initialization/init_style.png" height="192px">\n\n<img src="examples/gatys_figure/tubingen_picasso.png" height="192px">\n<img src="examples/gatys_figure/tubingen_scream.png" height="192px">\n<img src="examples/gatys_figure/tubingen_kandinsky.png" height="192px">\n</p>\n\n### Content / Style Tradeoff\nThe relative weight of the style and content can be controlled.\n\nHere we render with an increasing style weight applied to [Red Canna](http://www.georgiaokeeffe.net/red-canna.jsp):\n<p align="center">\n<img src="examples/style_content_tradeoff/okeffe.jpg" height="160px">\n<img src="examples/style_content_tradeoff/okeffe_10.png" width="160px">\n<img src="examples/style_content_tradeoff/okeffe_100.png" width="160px">\n<img src="examples/style_content_tradeoff/okeffe_10000.png" width="160px">\n<img src="examples/style_content_tradeoff/output_1000000.png" width="160px">\n</p>\n\n### Multiple Style Images\nMore than one style image can be used to blend multiple artistic styles.\n\n<p align="center">\n<img src="examples/multiple_styles/tubingen_starry_scream.png" height="192px">\n<img src="examples/multiple_styles/tubingen_scream_kandinsky.png" height="192px">\n<img src="examples/multiple_styles/tubingen_starry_seated.png" height="192px">  \n\n<img src="examples/multiple_styles/tubingen_seated_kandinsky.png.png" height="192px">\n<img src="examples/multiple_styles/tubingen_afremov_grey.png" height="192px">\n<img src="examples/multiple_styles/tubingen_basquiat_nielly.png" height="192px">\n</p>\n\n*Top row (left to right)*: [The Starry Night](https://www.wikiart.org/en/vincent-van-gogh/the-starry-night-1889) + [The Scream](https://www.wikiart.org/en/edvard-munch/the-scream-1893), [The Scream](https://www.wikiart.org/en/edvard-munch/the-scream-1893) + [Composition VII](https://www.wikiart.org/en/wassily-kandinsky/composition-vii-1913), [Seated Nude](http://www.pablopicasso.org/seated-nude.jsp) + [Composition VII](https://www.wikiart.org/en/wassily-kandinsky/composition-vii-1913)  \n*Bottom row (left to right)*: [Seated Nude](http://www.pablopicasso.org/seated-nude.jsp) + [The Starry Night](https://www.wikiart.org/en/vincent-van-gogh/the-starry-night-1889), [Oversoul](http://alexgrey.com/art/paintings/soul/oversoul/) + [Freshness of Cold](https://afremov.com/FRESHNESS-OF-COLD-PALETTE-KNIFE-Oil-Painting-On-Canvas-By-Leonid-Afremov-Size-30-x40.html), [David Bowie](http://www.francoise-nielly.com/index.php/galerie/index/56) + [Skull](https://www.wikiart.org/en/jean-michel-basquiat/head) \n\n### Style Interpolation\nWhen using multiple style images, the degree of blending between the images can be controlled.\n\n<p align="center">\n<img src="image_input/taj_mahal.jpg" height="178px">\n<img src="examples/style_interpolation/taj_mahal_scream_2_starry_8.png" height="178px">\n<img src="examples/style_interpolation/taj_mahal_scream_8_starry_2.png" height="178px">\n\n<img src="examples/style_interpolation/taj_mahal_afremov_grey_8_2.png" height="178px">\n<img src="examples/style_interpolation/taj_mahal_afremov_grey_5_5.png" height="178px">\n<img src="examples/style_interpolation/taj_mahal_afremov_grey_2_8.png" height="178px">\n</p>\n\n*Top row (left to right)*: content image, .2 [The Starry Night](https://www.wikiart.org/en/vincent-van-gogh/the-starry-night-1889) + .8 [The Scream](https://www.wikiart.org/en/edvard-munch/the-scream-1893), .8 [The Starry Night](https://www.wikiart.org/en/vincent-van-gogh/the-starry-night-1889) + .2 [The Scream](https://www.wikiart.org/en/edvard-munch/the-scream-1893)  \n*Bottom row (left to right)*: .2 [Oversoul](http://alexgrey.com/art/paintings/soul/oversoul/) + .8 [Freshness of Cold](https://afremov.com/FRESHNESS-OF-COLD-PALETTE-KNIFE-Oil-Painting-On-Canvas-By-Leonid-Afremov-Size-30-x40.html), .5 [Oversoul](http://alexgrey.com/art/paintings/soul/oversoul/) + .5 [Freshness of Cold](https://afremov.com/FRESHNESS-OF-COLD-PALETTE-KNIFE-Oil-Painting-On-Canvas-By-Leonid-Afremov-Size-30-x40.html), .8 [Oversoul](http://alexgrey.com/art/paintings/soul/oversoul/) + .2 [Freshness of Cold](https://afremov.com/FRESHNESS-OF-COLD-PALETTE-KNIFE-Oil-Painting-On-Canvas-By-Leonid-Afremov-Size-30-x40.html)\n\n### Transfer style but not color\nThe color scheme of the original image can be preserved by including the flag `--original_colors`. Colors are transferred using either the [YUV](https://en.wikipedia.org/wiki/YUV), [YCrCb](https://en.wikipedia.org/wiki/YCbCr), [CIE L\\*a\\*b\\*](https://en.wikipedia.org/wiki/Lab_color_space), or [CIE L\\*u\\*v\\*](https://en.wikipedia.org/wiki/CIELUV) color spaces.\n\nHere we reproduce Figure 1 and Figure 2 in the third paper using luminance-only transfer:\n<p align="center">\n<img src="examples/original_colors/new_york.png" height="165px">\n<img src="examples/original_colors/stylized.png" height="165px">\n<img src="examples/original_colors/stylized_original_colors.png" height="165px">\n\n<img src="examples/original_colors/garden.png" height="165px">\n<img src="examples/original_colors/garden_starry.png" height="165px">\n<img src="examples/original_colors/garden_starry_yuv.png" height="165px">\n</p>\n\n*Left to right*: content image, stylized image, stylized image with the original colors of the content image\n\n### Textures\nThe algorithm is not constrained to artistic painting styles.  It can also be applied to photographic textures to create [pareidolic](https://en.wikipedia.org/wiki/Pareidolia) images.\n<p align="center">\n<img src="examples/pareidolic/flowers_output.png" width="192px">\n<img src="examples/pareidolic/styles/flowers_crop.jpg" width="192px"/>\n<img src="examples/pareidolic/oil_output.png" width="192px">\n<img src="examples/pareidolic/styles/oil_crop.jpg" width="192px">\n\n<img src="examples/pareidolic/dark_matter_output.png" width="192px">\n<img src="examples/pareidolic/styles/dark_matter_bw.png" width="192px">\n<img src="examples/pareidolic/ben_giles_output.png" width="192px">\n<img src="examples/pareidolic/styles/ben_giles.png" width="192px">\n</p>\n\n### Segmentation\nStyle can be transferred to semantic segmentations in the content image.\n<p align="center">\n<img src="examples/segmentation/00110.jpg" height="180px">\n<img src="examples/segmentation/00110_mask.png" height="180px">\n<img src="examples/segmentation/00110_output.png" height="180px">  \n<img src="examples/segmentation/00017.jpg" height="180px">\n<img src="examples/segmentation/00017_mask.png" height="180px">\n<img src="examples/segmentation/00017_output.png" height="180px">  \n\n<img src="examples/segmentation/00768.jpg" height="180px">\n<img src="examples/segmentation/00768_mask.png" height="180px">\n<img src="examples/segmentation/00768_output.png" height="180px">\n<img src="examples/segmentation/02630.png" height="180px">\n<img src="examples/segmentation/02630_mask.png" height="180px">\n<img src="examples/segmentation/02630_output.png" height="180px"> \n</p>\n\nMultiple styles can be transferred to the foreground and background of the content image.\n<p align="center">\n<img src="examples/segmentation/02390.jpg" height="180px">\n<img src="examples/segmentation/basquiat.png" height="180px">\n<img src="examples/segmentation/frida.png" height="180px">\n<img src="examples/segmentation/02390_mask.png" height="180px">\n<img src="examples/segmentation/02390_mask_inv.png" height="180px">\n<img src="examples/segmentation/02390_output.png" height="180px">\n\n<img src="examples/segmentation/02270.jpg" height="180px">\n<img src="examples/segmentation/okeffe_red_canna.png" height="180px">\n<img src="examples/segmentation/okeffe_iris.png" height="180px">\n<img src="examples/segmentation/02270_mask_face.png" height="180px">\n<img src="examples/segmentation/02270_mask_face_inv.png" height="180px">\n<img src="examples/segmentation/02270_output.png" height="180px">\n</p>\n\n*Left to right*: content image, foreground style, background style, foreground mask, background mask, stylized image\n\n### Video\nAnimations can be rendered by applying the algorithm to each source frame.  For the best results, the gradient descent is initialized with the previously stylized frame warped to the current frame according to the optical flow between the pair of frames.  Loss functions for temporal consistency are used to penalize pixels excluding disoccluded regions and motion boundaries.\n\n<p align="center">\n<img src="examples/video/input.gif">\n<img src="examples/video/opt_flow.gif">\n<br>\n<img src="examples/video/weights.gif">\n<img src="examples/video/output.gif">\n</p>  \n\n*Top row (left to right)*: source frames, ground-truth optical flow visualized      \n*Bottom row (left to right)*: disoccluded regions and motion boundaries, stylized frames\n\nBig thanks to Mike Burakoff\tfor finding a bug in the video rendering.\n\n### Gradient Descent Initialization\nThe initialization of the gradient descent is controlled using `--init_img_type` for single images and `--init_frame_type` or `--first_frame_type` for video frames.  White noise allows an arbitrary number of distinct images to be generated.  Whereas, initializing with a fixed image always converges to the same output.\n\nHere we reproduce Figure 6 from the first paper:\n<p align="center">\n<img src="examples/initialization/init_content.png" height="192">\n<img src="examples/initialization/init_style.png" height="192">\n<img src="examples/initialization/init_random_1.png" height="192">\n\n<img src="examples/initialization/init_random_2.png" height="192">\n<img src="examples/initialization/init_random_3.png" height="192">\n<img src="examples/initialization/init_random_4.png" height="192">\n</p>\n\n*Top row (left to right)*: Initialized with the content image, the style image, white noise (RNG seed 1)  \n*Bottom row (left to right)*: Initialized with white noise (RNG seeds 2, 3, 4)\n\n### Layer Representations\nThe feature complexities and receptive field sizes increase down the CNN heirarchy.\n\nHere we reproduce Figure 3 from [the original paper](https://arxiv.org/abs/1508.06576):\n<table align=\'center\'>\n<tr align=\'center\'>\n<td></td>\n<td>1 x 10^-5</td>\n<td>1 x 10^-4</td>\n<td>1 x 10^-3</td>\n<td>1 x 10^-2</td>\n</tr>\n<tr>\n<td>conv1_1</td>\n<td><img src="examples/layers/conv1_1_1e5.png" width="192"></td>\n<td><img src="examples/layers/conv1_1_1e4.png" width="192"></td>\n<td><img src="examples/layers/conv1_1_1e3.png" width="192"></td>\n<td><img src="examples/layers/conv1_1_1e2.png" width="192"></td>\n</tr>\n<tr>\n<td>conv2_1</td>\n<td><img src="examples/layers/conv2_1_1e5.png" width="192"></td>\n<td><img src="examples/layers/conv2_1_1e4.png" width="192"></td>\n<td><img src="examples/layers/conv2_1_1e3.png" width="192"></td>\n<td><img src="examples/layers/conv2_1_1e2.png" width="192"></td>\n</tr>\n<tr>\n<td>conv3_1</td>\n<td><img src="examples/layers/conv3_1_1e5.png" width="192"></td>\n<td><img src="examples/layers/conv3_1_1e4.png" width="192"></td>\n<td><img src="examples/layers/conv3_1_1e3.png" width="192"></td>\n<td><img src="examples/layers/conv3_1_1e2.png" width="192"></td>\n</tr>\n<tr>\n<td>conv4_1</td>\n<td><img src="examples/layers/conv4_1_1e5.png" width="192"></td>\n<td><img src="examples/layers/conv4_1_1e4.png" width="192"></td>\n<td><img src="examples/layers/conv4_1_1e3.png" width="192"></td>\n<td><img src="examples/layers/conv4_1_1e2.png" width="192"></td>\n</tr>\n<tr>\n<td>conv5_1</td>\n<td><img src="examples/layers/conv5_1_1e5.png" width="192"></td>\n<td><img src="examples/layers/conv5_1_1e4.png" width="192"></td>\n<td><img src="examples/layers/conv5_1_1e3.png" width="192"></td>\n<td><img src="examples/layers/conv5_1_1e2.png" width="192"></td>\n</tr>\n</table>\n\n*Rows*: increasing subsets of CNN layers; i.e. \'conv4_1\' means using \'conv1_1\', \'conv2_1\', \'conv3_1\', \'conv4_1\'.   \n*Columns*: alpha/beta ratio of the the content and style reconstruction (see Content / Style Tradeoff).\n\n## Setup\n#### Dependencies:\n* [tensorflow](https://github.com/tensorflow/tensorflow)\n* [opencv](http://opencv.org/downloads.html)\n\n#### Optional (but recommended) dependencies:\n* [CUDA](https://developer.nvidia.com/cuda-downloads) 7.5+\n* [cuDNN](https://developer.nvidia.com/cudnn) 5.0+\n\n#### After installing the dependencies: \n* Download the [VGG-19 model weights](http://www.vlfeat.org/matconvnet/pretrained/) (see the "VGG-VD models from the *Very Deep Convolutional Networks for Large-Scale Visual Recognition* project" section). More info about the VGG-19 network can be found [here](http://www.robots.ox.ac.uk/~vgg/research/very_deep/).\n* After downloading, copy the weights file `imagenet-vgg-verydeep-19.mat` to the project directory.\n\n## Usage\n### Basic Usage\n\n#### Single Image\n1. Copy 1 content image to the default image content directory `./image_input`\n2. Copy 1 or more style images to the default style directory `./styles`\n3. Run the command:\n```\nbash stylize_image.sh <path_to_content_image> <path_to_style_image>\n```\n*Example*:\n```\nbash stylize_image.sh ./image_input/lion.jpg ./styles/kandinsky.jpg\n```\n*Note*: Supported image formats include: `.png`, `.jpg`, `.ppm`, `.pgm`\n\n*Note*: Paths to images should not contain the `~` character to represent your home directory; you should instead use a relative path or the absolute path.\n\n#### Video Frames\n1. Copy 1 content video to the default video content directory `./video_input`\n2. Copy 1 or more style images to the default style directory `./styles`\n3. Run the command:\n```\nbash stylize_video.sh <path_to_video> <path_to_style_image>\n```\n*Example*:\n```\nbash stylize_video.sh ./video_input/video.mp4 ./styles/kandinsky.jpg\n```\n\n*Note*: Supported video formats include: `.mp4`, `.mov`, `.mkv`\n\n### Advanced Usage\n#### Single Image or Video Frames\n1. Copy content images to the default image content directory `./image_input` or copy video frames to the default video content directory `./video_input`  \n2. Copy 1 or more style images to the default style directory `./styles`  \n3. Run the command with specific arguments:\n```\npython neural_style.py <arguments>\n```\n*Example (Single Image)*:\n```\npython neural_style.py --content_img golden_gate.jpg \\\n                       --style_imgs starry-night.jpg \\\n                       --max_size 1000 \\\n                       --max_iterations 100 \\\n                       --original_colors \\\n                       --device /cpu:0 \\\n                       --verbose;\n```\n\nTo use multiple style images, pass a *space-separated* list of the image names and image weights like this:\n\n`--style_imgs starry_night.jpg the_scream.jpg --style_imgs_weights 0.5 0.5`\n\n*Example (Video Frames)*:\n```\npython neural_style.py --video \\\n                       --video_input_dir ./video_input/my_video_frames \\\n                       --style_imgs starry-night.jpg \\\n                       --content_weight 5 \\\n                       --style_weight 1000 \\\n                       --temporal_weight 1000 \\\n                       --start_frame 1 \\\n                       --end_frame 50 \\\n                       --max_size 1024 \\\n                       --first_frame_iterations 3000 \\\n                       --verbose;\n```\n*Note*:  When using `--init_frame_type prev_warp` you must have previously computed the backward and forward optical flow between the frames.  See `./video_input/make-opt-flow.sh` and `./video_input/run-deepflow.sh`\n\n#### Arguments\n* `--content_img`: Filename of the content image. *Example*: `lion.jpg`\n* `--content_img_dir`: Relative or absolute directory path to the content image. *Default*: `./image_input`\n* `--style_imgs`: Filenames of the style images. To use multiple style images, pass a *space-separated* list.  *Example*: `--style_imgs starry-night.jpg`\n* `--style_imgs_weights`: The blending weights for each style image.  *Default*: `1.0` (assumes only 1 style image)\n* `--style_imgs_dir`: Relative or absolute directory path to the style images. *Default*: `./styles`\n* `--init_img_type`: Image used to initialize the network. *Choices*: `content`, `random`, `style`. *Default*: `content`\n* `--max_size`: Maximum width or height of the input images. *Default*: `512`\n* `--content_weight`: Weight for the content loss function. *Default*: `5e0`\n* `--style_weight`: Weight for the style loss function. *Default*: `1e4`\n* `--tv_weight`: Weight for the total variational loss function. *Default*: `1e-3`\n* `--temporal_weight`: Weight for the temporal loss function. *Default*: `2e2`\n* `--content_layers`: *Space-separated* VGG-19 layer names used for the content image. *Default*: `conv4_2`\n* `--style_layers`: *Space-separated* VGG-19 layer names used for the style image. *Default*: `relu1_1 relu2_1 relu3_1 relu4_1 relu5_1`\n* `--content_layer_weights`: *Space-separated* weights of each content layer to the content loss. *Default*: `1.0`\n* `--style_layer_weights`: *Space-separated* weights of each style layer to loss. *Default*: `0.2 0.2 0.2 0.2 0.2`\n* `--original_colors`: Boolean flag indicating if the style is transferred but not the colors.\n* `--color_convert_type`: Color spaces (YUV, YCrCb, CIE L\\*u\\*v\\*, CIE L\\*a\\*b\\*) for luminance-matching conversion to original colors. *Choices*: `yuv`, `ycrcb`, `luv`, `lab`. *Default*: `yuv`\n* `--style_mask`: Boolean flag indicating if style is transferred to masked regions.\n* `--style_mask_imgs`: Filenames of the style mask images (example: `face_mask.png`). To use multiple style mask images, pass a *space-separated* list.  *Example*: `--style_mask_imgs face_mask.png face_mask_inv.png`\n* `--noise_ratio`: Interpolation value between the content image and noise image if network is initialized with `random`. *Default*: `1.0`\n* `--seed`: Seed for the random number generator. *Default*: `0`\n* `--model_weights`: Weights and biases of the VGG-19 network.  Download [here](http://www.vlfeat.org/matconvnet/pretrained/). *Default*:`imagenet-vgg-verydeep-19.mat`\n* `--pooling_type`: Type of pooling in convolutional neural network. *Choices*: `avg`, `max`. *Default*: `avg`\n* `--device`: GPU or CPU device.  GPU mode highly recommended but requires NVIDIA CUDA. *Choices*: `/gpu:0` `/cpu:0`. *Default*: `/gpu:0`\n* `--img_output_dir`: Directory to write output to.  *Default*: `./image_output`\n* `--img_name`: Filename of the output image. *Default*: `result`\n* `--verbose`: Boolean flag indicating if statements should be printed to the console.\n\n#### Optimization Arguments\n* `--optimizer`: Loss minimization optimizer.  L-BFGS gives better results.  Adam uses less memory. *Choices*: `lbfgs`, `adam`. *Default*: `lbfgs`\n* `--learning_rate`: Learning-rate parameter for the Adam optimizer. *Default*: `1e0`  \n\n<p align="center">\n<img src="examples/equations/plot.png" width="360px">\n</p>\n\n* `--max_iterations`: Max number of iterations for the Adam or L-BFGS optimizer. *Default*: `1000`\n* `--print_iterations`: Number of iterations between optimizer print statements. *Default*: `50`\n* `--content_loss_function`: Different constants K in the content loss function. *Choices*: `1`, `2`, `3`. *Default*: `1` \n\n<p align="center">\n<img src="examples/equations/content.png" width="321px">\n</p>\n\n#### Video Frame Arguments\n* `--video`: Boolean flag indicating if the user is creating a video.\n* `--start_frame`: First frame number. *Default*: `1`\n* `--end_frame`: Last frame number. *Default*: `1` \n* `--first_frame_type`: Image used to initialize the network during the rendering of the first frame. *Choices*: `content`, `random`, `style`. *Default*: `random`\n* `--init_frame_type`: Image used to initialize the network during the every rendering after the first frame. *Choices*: `prev_warped`, `prev`, `content`, `random`, `style`. *Default*: `prev_warped`\n* `--video_input_dir`: Relative or absolute directory path to input frames. *Default*: `./video_input`\n* `--video_output_dir`: Relative or absolute directory path to write output frames to. *Default*: `./video_output`\n* `--content_frame_frmt`: Format string of input frames. *Default*: `frame_{}.png`\n* `--backward_optical_flow_frmt`: Format string of backward optical flow files. *Default*: `backward_{}_{}.flo`\n* `--forward_optical_flow_frmt`: Format string of forward optical flow files. *Default*: `forward_{}_{}.flo`\n* `--content_weights_frmt`: Format string of optical flow consistency files. *Default*: `reliable_{}_{}.txt`\n* `--prev_frame_indices`: Previous frames to consider for longterm temporal consistency. *Default*: `1`\n* `--first_frame_iterations`: Maximum number of optimizer iterations of the first frame. *Default*: `2000`\n* `--frame_iterations`: Maximum number of optimizer iterations for each frame after the first frame. *Default*: `800`\n\n## Questions and Errata\n\nSend questions or issues:  \n<img src="examples/equations/email.png">\n\n## Memory\nBy default, `neural-style-tf` uses the NVIDIA cuDNN GPU backend for convolutions and L-BFGS for optimization.\nThese produce better and faster results, but can consume a lot of memory. You can reduce memory usage with the following:\n\n* **Use Adam**: Add the flag `--optimizer adam` to use Adam instead of L-BFGS. This should significantly\n  reduce memory usage, but will require tuning of other parameters for good results; in particular you should\n  experiment with different values of `--learning_rate`, `--content_weight`, `--style_weight`\n* **Reduce image size**: You can reduce the size of the generated image with the `--max_size` argument.\n\n## Implementation Details\nAll images were rendered on a machine with:\n* **CPU:** Intel Core i7-6800K @ 3.40GHz \xc3\x97 12 \n* **GPU:** NVIDIA GeForce GTX 1080/PCIe/SSE2\n* **OS:** Linux Ubuntu 16.04.1 LTS 64-bit\n* **CUDA:** 8.0\n* **python:** 2.7.12\n* **tensorflow:** 0.10.0rc\n* **opencv:** 2.4.9.1\n\n## Acknowledgements\n\nThe implementation is based on the projects: \n* Torch (Lua) implementation \'neural-style\' by [jcjohnson](https://github.com/jcjohnson)\n* Torch (Lua) implementation \'artistic-videos\' by [manuelruder](https://github.com/manuelruder)\n\nSource video frames were obtained from:\n* [MPI Sintel Flow Dataset](http://sintel.is.tue.mpg.de/)\n\nArtistic images were created by the modern artists:\n* [Alex Grey](http://alexgrey.com/)\n* [Minjae Lee](http://www.grenomj.com/)\n* [Leonid Afremov](https://afremov.com/)\n* [Fran\xc3\xa7oise Nielly](http://www.francoise-nielly.com/)\n* [James Jean](http://www.jamesjean.com/)\n* [Ben Giles](https://benlewisgiles.format.com/)\n* [Callie Fink](http://calliefink.deviantart.com/)\n* [H.R. Giger](https://en.wikipedia.org/wiki/H._R._Giger)\n* [Voka](http://www.voka.at/)\n\nArtistic images were created by the popular historical artists:\n* [Vincent Van Gogh](https://www.wikiart.org/en/vincent-van-gogh)\n* [Wassily Kandinsky](https://www.wikiart.org/en/wassily-kandinsky)\n* [Georgia O\'Keeffe](http://www.georgiaokeeffe.net/)\n* [Jean-Michel Basquiat](http://basquiat.com/)\n* [\xc3\x89douard Manet](http://www.manet.org/)\n* [Pablo Picasso](https://www.wikiart.org/en/pablo-picasso)\n* [Joseph Mallord William Turner](https://en.wikipedia.org/wiki/J._M._W._Turner)\n* [Frida Kahlo](https://en.wikipedia.org/wiki/Frida_Kahlo)\n\nBash shell scripts for testing were created by my brother [Sheldon Smith](http://www.imdb.com/name/nm4328496/).\n\n## Citation\n\nIf you find this code useful for your research, please cite:\n\n```\n@misc{Smith2016,\n  author = {Smith, Cameron},\n  title = {neural-style-tf},\n  year = {2016},\n  publisher = {GitHub},\n  journal = {GitHub repository},\n  howpublished = {\\url{https://github.com/cysmith/neural-style-tf}},\n}\n```\n'