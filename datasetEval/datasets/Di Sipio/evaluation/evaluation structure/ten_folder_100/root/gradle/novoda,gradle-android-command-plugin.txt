b'gradle-android-command-plugin\n=============================\n[![Build](https://ci.novoda.com/buildStatus/icon?job=gradle-android-command-plugin)](https://ci.novoda.com/job/gradle-android-command-plugin/lastSuccessfulBuild/console) \n[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](http://www.apache.org/licenses/LICENSE-2.0)\n[![Bintray](https://api.bintray.com/packages/novoda-oss/maven/gradle-android-command-plugin/images/download.svg)](https://bintray.com/novoda-oss/maven/gradle-android-command-plugin/_latestVersion)\n\nUse gradle tasks to run specific `adb` commands.\n\n\nDescription\n-----------\n\nYou can use this plugin to do things such as:\n\n  - Find all devices attached and get basic info about them\n  - Select the first one that complies with a custom rule\n  - Install a specific APK from the available build types + flavours\n  - Clear preferences or do something related to the APK to prepare for tests\n  - Run monkey for that specific APK on that specific device\n  - Uninstall the APK\n\nThis is particularly useful for CI servers but could be used to speed up development as well.\n\n\nAdding to your project\n----------------------\n\nTo start using this library, add these lines to the `build.gradle` of your project:\n\n```groovy\napply plugin: \'com.android.application\'\napply plugin: \'com.novoda.android-command\'\n\nbuildscript {\n    repositories {\n        jcenter()\n    }\n    dependencies {\n        classpath \'com.novoda:gradle-android-command-plugin:2.1.0\'\n    }\n}\n```\n\n\nSimple usage\n------------\n\nThe plugin creates new tasks that you can use:\n\n  * `installDevice<Variant>` [`com.novoda.gradle.command.InstallDevice`] - installs the app on a specific device.\n  * `uninstallDevice<Variant>` [`com.novoda.gradle.command.UninstallDevice`] - uninstalls the app from a specific device.\n  * `run<Variant>` [`com.novoda.gradle.command.Run`] - installs and launches the app on a specific device.\n  * `start<Variant>` [`com.novoda.gradle.command.Run`] - launches an already installed app on a specific device.\n  * `stop<Variant>` [`com.novoda.gradle.command.Stop`] - Forcibly stops the app on a specific device.\n  * `monkey<Variant>` [`com.novoda.gradle.command.Monkey`] - installs and runs monkey on a specific device.\n  * `clearPrefs<Variant>` [`com.novoda.gradle.command.ClearPreferences`] - clears app preferences on a specific device.\n  * `[enable|disable]SystemAnimations` - Enables/Disables system animations on the device.\n  * `[enable|disable]DemoMode` - Enables/Disables demo mode on the device.\n  * `com.novoda.gradle.command.Files` - enables basic file copy via `push` and `pull`, wrapping the respective adb calls.\n\nFor advanced usage please take a look into the sample project [build.gradle](sample/app/build.gradle) file.\n\nConfiguration\n-------------\n\n### Command Extension\n\nThe plugin provides `command` extension under the official `android` extension for configuration. \n\n```groovy\ncommand {\n    // Optional adb and aapt path. By default, $ANDROID_HOME will be used \n    adb \'~/full/path/to/adb\'\n    aapt \'~/full/path/to/aapt\'\n    \n    // Optional device id\n    // By default, the first device will be used \n    // Can be overridden at any time with `-DdeviceId` command line argument\n    // Can be a closure (for lazy evaluation) or just a String.\n    deviceId = "DEVICE_SERIAL"\n    // or\n    deviceId {\n        // some lazy script to evaluate deviceId \n    }\n    \n    // Categorize plugin tasks by task type or by variant names\n    sortBySubtasks false\n    \n    // Additional methods to utilize in custom closures:\n    List<Device> devices = devices()        // connected devices \n    List<String> deviceIds = deviceIds()    // connected device ids\n    \n    // Sub-extensions. More info below \xe2\xac\x87\xef\xb8\x8f\n    monkey {\n        // Configure monkey task\n    }\n    \n    scripts {\n        // named scripts for device input automation\n    }\n    \n    demoMode {\n        // configure Android Marshmallow\'s demo mode\n    }\n    \n    install {\n        // named install tasks with custom flags\n    }\n    \n    start {\n        // named run/start tasks\n    }\n}\n```\n\n### Device class\n\nCurrent connected devices can be retrieved via `devices()`. Here are the methods available on a `Device` object.\nThese can be useful if used in other configurations. Examples can be found in the sample.\n\n```groovy\nInteger sdkVersion()\nString androidVersion()\nString brand()\nString model()\nString manufacturer()\nString screenDensity()\nString country()\nString language()\nString timezone()\nString deviceProperty(String key) // Possible keys: https://developer.android.com/studio/test/monkeyrunner/MonkeyDevice.html#table1\n```\n\n### Input Scripting\n\nThe plugin provides an extension called `scripts` which allows to perform simple scripting automation. It wraps `adb shell input` tool.\n \nHere is an example called `autoLogin` which will input the test username and password into the sample app.\n\n```groovy\nscripts {\n    autoLogin {\n        execute {\n          2.times {\n              text \'bob\'\n              enter()\n          }\n          enter()\n        }\n    }\n}\n```\n\nThis config will create a gradle task called `autoLogin`. Running `./gradlew autoLogin` will try to input `bob` then press `enter`. This will be done 2 times and then another `enter` will be pressed.\n\nYou may have a custom groovy closure to do scripting as you like. The following input methods are available:\n\n```\ntext(String value)\ntap(int x, int y)\nswipe(int startX, int startY, int endX, int endY)\nkey(int code)\nhome()\nback()\nup()\ndown()\nleft()\nright()\nclear()\ntab()\nenter()\npower()\nunlock()\n```\n\n### Demo Mode\n\n`[enable|disable]DemoMode` tasks are create to control demo mode on Android Marshmallow (API level 23) devices.\n\nBy default these tasks setup the demo mode with most common used default values. And they can be controlled with `demoMode` DSL.\n\n```groovy          \ndemoMode {\n    battery {\n        level \'100\'\n        plugged \'false\'\n    }\n    network {\n        wifi \'show\'\n        level \'4\'\n    }\n    clock.hhmm \'0810\'\n    notifications.visible \'false\'\n}\n``` \n\nAll possible values can be found in [the official Android documentation](https://android.googlesource.com/platform/frameworks/base/+/master/packages/SystemUI/docs/demo_mode.md)\n\n### Install\n\n`installDevice<Variant>` tasks are available by default just to install the app. The plugin also supports an `install` DSL to define custom installation tasks.\n\n**customFlags**\n\nHere is an extension called `fromGooglePlay` which will create `installFromGooglePlay<Variant>` tasks.\n\n```groovy\ninstall {\n    fromGooglePlay {\n        description "Installs with flag Play Store"\n        customFlags {\n            [\'-i\', \'com.android.vending\']\n        }\n    }\n}\n```\n\n**Note:** `customFlags` also supports any custom Closure to be lazily evaluated.\n\nMore flags can be found in the `install` section of [the official adb document](https://developer.android.com/studio/command-line/adb.html#pm).\n\n### Start\n\n`start<Variant>` and `run<Variant>` tasks are available by default. Start tasks just start an already installed application. Run tasks first install the app before starting.\n \nJust like the `install` DSL, it is possible to specify a device id. Doing this will create corresponding `start` and `run` tasks. \n\n```groovy\nstart {\n    amazon {\n        deviceId {\n            def kindle = devices().find { it.brand() == \'Amazon\' }\n            if (!kindle) {\n                throw new GroovyRuntimeException(\'No Amazon device found\')\n            }\n            kindle.id\n        }\n    }\n}\n``` \n\nThis configuration creates `startAmazon<Variant>` and `runAmazon<Variant>` tasks.\n\n## Snapshots\n[![CI status](https://ci.novoda.com/buildStatus/icon?job=gradle-android-command-plugin)](https://ci.novoda.com/job/gradle-android-command-plugin/lastBuild/console) [![Download from Bintray](https://api.bintray.com/packages/novoda-oss/snapshots/gradle-android-command-plugin/images/download.svg)](https://bintray.com/novoda-oss/snapshots/gradle-android-command-plugin/_latestVersion)\n\nSnapshot builds from [`develop`](https://github.com/novoda/gradle-android-command-plugin/compare/master...develop) are automatically deployed to a [repository](https://bintray.com/novoda-oss/snapshots/gradle-android-command-plugin/_latestVersion) that is **not** synced with JCenter.\nTo consume a snapshot build add an additional maven repo as follows:\n```\nrepositories {\n    maven {\n        url \'https://dl.bintray.com/novoda-oss/snapshots/\'\n    }\n}\n```\n\nYou can find the latest snapshot version following this [link](https://bintray.com/novoda-oss/snapshots/gradle-android-command-plugin/_latestVersion).\n\nLinks\n-----\n\nHere are a list of useful links:\n\n * We always welcome people to contribute new features or bug fixes, [here is how](https://github.com/novoda/novoda/blob/master/CONTRIBUTING.md)\n * For more info on how start working on this project, [see this wiki page](https://github.com/novoda/gradle-android-command-plugin/wiki/Development-&-Contributing)\n * If you have a problem check the [Issues Page](https://github.com/novoda/gradle-android-command-plugin/issues) first to see if we are working on it\n * For further usage or to delve more deeply checkout the [Project Wiki](https://github.com/novoda/gradle-android-command-plugin/wiki)\n * Looking for community help, browse the already asked [Stack Overflow Questions](http://stackoverflow.com/questions/tagged/support-android-command) or use the tag: `support-android-command` when posting a new question\n'