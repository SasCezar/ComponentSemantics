b'# Description\n\nMagma was originally designed and developed by Ladar Levison for lavabit.com. The current release is currently under heavy development, and some of the features and functions contained herein are unstable. The SMTP, POP, and IMAP protocol handlers are reasonably mature. The DMTP, DMAP and HTTP implementations (along with the bundled webmail system) are still in development. Happy hacking.\n\n# Downloads\n\n##### Magma\n\nhttps://github.com/lavabit/magma/archive/develop.tar.gz\n\n##### Magma Development Machine, v1.0.0\n\nThe development machine is a pre-built virtual machine with a graphical desktop and various development tools, and dependencies installed.\n\nhttps://darkmail.info/downloads/dark-mail-development-machine-1.0.0.tar.gz    \nhttps://darkmail.info/downloads/dark-mail-development-machine-1.0.0.tar.gz.sha256    \n\n33808e4ed81859cb076ae879fed7ad85164a2561a1b1cd96f66f65f7e3bf7bd7\n\n##### Magma Build Machines\n\nFor those looking for a slim virtual machine pre-configured to build and run magma, consider the following Vagrant boxes which have been created specifically for that purpose. Images have been created to support the VirtualBox, Hyper-V, VMware, and libvirt Vagrant providers. An official Docker image is on the roadmap, but for the time being you might want to consider one of the community supported images. Use the appropriate command below to download and provision a Vagrant instance.\n\n```shell\n# VMware\nvagrant init lavabit/magma; vagrant up --provider vmware_desktop\n\n# VirtualBox\nvagrant init lavabit/magma; vagrant up --provider virtualbox\n\n# libvirt\nvagrant init lavabit/magma; vagrant up --provider libvirt\n\n# Hyper-V\nvagrant init lavabit/magma; vagrant up --provider hyperv\n```\n\nImages are available for alternate platforms [here](https://atlas.hashicorp.com/lavabit).\n\n# Credits\n\n- Ladar Levison\n- Greg Brown\n- Ivan Tolkachev\n- Princess Levison\n- Ryan Crites\n- Sean Benson\n- Stephen Watt\n- Jacob Adkins\n\nAnd the army of Kickstarter supporters who contributed to this project.\n\n# Tarball Contents\n\n```\nmagma/\n\tcheck/\n\tdev/\n\t\tdocs/\n\t\tscripts/\n\t\ttools/\n\t\t\tcryptex/\n\t\t\tmason/\n\t\t\tpwtool/\n\t\t\trand/\n\t\t\trunner/\n\t\t\tstringer/\n\t\t\ttestde/\n\tlib/\n\tres/\n\tsandbox/\n\tsrc/\n\tweb/\n\tCOPYRIGHT\n\tINSTALL\n\tLICENSE\n\tMakefile\n\tREADME.md\n```\n\n# Installation Instructions\n\nThese instructions are targeted at systems running CentOS 6.\n\n### Prerequisites\n\nInstall the dependencies (make sure that EPEL is enabled):\n\n```shell\nyum -y install gcc make autoconf automake binutils bison flex gcc-c++ gettext libtool make patch pkgconfig mysql-server memcached gettext-devel patch perl perl-Time-HiRes check check-devel ncurses-devel libbsd-devel zlib-devel valgrind valgrind-devel\n```\n\n**MySQL**\n\nTo start MySQL and configure the magma username run the commands below. The supplied password should be replaced with value unique to your environment. You may also want to limit the permissions of the magma database user to the database it will need to access. The global permission is only needed to setup the table schema.\n\n```shell\nchkconfig mysqld on && service mysqld start\n\necho "CREATE USER \'magma\'@\'localhost\' IDENTIFIED BY \'volcano\';" | mysql -u root\necho "GRANT ALL PRIVILEGES ON *.* TO \'magma\'@\'localhost\' WITH GRANT OPTION;" | mysql -u root\n```\n\n**Memcached**\n\nTo start Memcached run the commands below.\n\n```shell\nchkconfig memcached on && service memcached start\n```\n### Compiling (The Short Way)\n\n```shell\nmake all\n```\n\n### Compiling (The Long Way)\n\nTo link up the development and build scripts run the linkup.sh. This will create a bin folder in your home directory, if it doesn\'t already exist, and create symbolic links to the scripts and tools used to build, run and test magma. The commands below assume the bin directory is in your PATH. If it isn\'t, or you simply don\'t want to create the symbolic links, you can also run the shell scripts directly from their location in the dev/scripts folder. To execute the linkup.sh script:\n\n```shell\nmagma/dev/scripts/linkup.sh\n```\n\nTo build the dependencies and create the magmad.so library separately, run the build.lib script. Run the script without any parameters to see the possible command line options. To compile and combine all of dependencies in a single operation:\n\n```shell\nbuild.lib all\n```\n\nThe bundled Makefile can be used to compile magma. It will detect when the dependencies haven\'t been compiled and run the preceeding step automatically, if necessary, as the Makefile looks for required header files in folders created by the previous step. If the Makefile has trouble finding the necessary include files, odds are its because the previous step didn\'t run properly. Assuming the dependencies are available, you can compile magmad and magmad.check using:\n\n```shell\nbuild.magma\nbuild.check\n```\n\nTo setup a sandbox database which can be used to run the unit tests, or experiment with magma, run (assuming the development userid is setup with permission to your database):\n\n```shell\nschema.reset\n```\n\nTo launch the magma unit tests, or magma using the sandbox configuration, run:\n\n```shell\ncheck.run\nmagma.run\n```\n\nTo download the ClamAV virus definitions into the sandbox environment, run:\n\n```shell\nfreshen.clamav\n```\n\n### Deploying\n\nTo deploy magma, run the INSTALL script. Note the INSTALL script is out of date, and will need to tweaking to operate perfectly against a copy of the current magma development branch cloned directly via git. Pull requests welcome.\n\n```shell\n./INSTALL -d ~/ -u magma -p volcano -s Lavabit\n```\n\n### Development\n\nThe best way to get an issue fixed is to create a pull request with a unit test added to the check folder which reproduces the issue and checks for the expected output. In general, please be sure to run the check.vg and magma.vg scripts before creating a pull request to make sure the newly submitted code doesn\'t introduce a memory leak, or invalid memory operation.\n\n\n# Webmail\n\nInside the res/pages/webmail directory is a compiled copy of the webmail code. Locate script.js file and change the magma.portalUrl = true variable to false, and it will use a set of hard coded test requests/responses. These hard coded requests, and responses are useful for checking/developing the webmail code without a running version of the magma server. Currently the files are configured to access the JSON-RPC interface using the hostname "localhost" and the HTTP port 10000. This should work using the default magma.config and magma.sandbox.config files.\n\nThe static files inside the res/pages/webmail folder are compiled using the files inside the web directory. See the web/WORKFLOW.md file for details.\n\n\n\n\n'