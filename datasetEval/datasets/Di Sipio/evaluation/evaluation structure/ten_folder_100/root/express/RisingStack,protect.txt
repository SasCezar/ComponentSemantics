b"## Protect by RisingStack\n\n[![Build Status](https://travis-ci.org/RisingStack/protect.svg?branch=master)](https://travis-ci.org/RisingStack/protect)\n[![Known Vulnerabilities](https://snyk.io/test/npm/protect/badge.svg)](https://snyk.io/test/npm/protect)\n\n*Works on Node.js v6 and newer.*\n\nThe purpose of this module is to provide out-of-box, proactive protection for common security problems, like\nSQL injection attacks, XSS attacks, brute force, etc...\n\n*This module is not a silver bullet, and is not a substitute for security-minded engineering work. But it can help you to achieve your goals.*\n\n![protect by risingstack](https://blog-assets.risingstack.com/2017/05/lock.png)\n\n### Basic usage\n\n```bash\nnpm i @risingstack/protect --save\n```\n\n#### With Express\n\n```javascript\nconst protect = require('@risingstack/protect')\nconst express = require('express')\nconst bodyParser = require('body-parser')\nconst redis = require('redis')\n\nconst client = redis.createClient()\n\nconst app = express()\n\napp.use(bodyParser.json({\n  extended: false\n}))\n\napp.use(protect.express.sqlInjection({\n  body: true,\n  loggerFunction: console.error\n}))\n\napp.use(protect.express.xss({\n  body: true,\n  loggerFunction: console.error\n}))\n\napp.use(protect.express.rateLimiter({\n  db: client,\n  id: (request) => request.connection.remoteAddress\n}))\n\napp.get('/', (request, response) => {\n  response.send('hello protect!')\n})\n\napp.post('/login', protect.express.rateLimiter({\n  db: client,\n  id: (request) => request.body.email,\n  // max 10 tries per 2 minutes\n  max: 10,\n  duration: 120000\n}), (request, response) => {\n  response.send('wuut logged in')\n})\n\napp.listen(3000)\n```\n\n### API\n\n#### `protect.express.sqlInjection([options])`\n\nReturns an Express middleware, which checks for SQL injections.\n\n* `options.body`: if this options is set (`true`), the middleware will check for request bodies as well\n  * default: `false`\n  * prerequisite: you must have the [body-parser](https://github.com/expressjs/body-parser) module used before adding the protect middleware\n* `options.loggerFunction`: you can provide a logger function for the middleware to log attacks\n  * default: `noop`\n\n#### `protect.express.xss([options])`\n\nReturns an Express middleware, which checks for XSS attacks.\n\n* `options.body`: if this options is set (`true`), the middleware will check for request bodies\n  * default: `false`\n  * prerequisite: you must have the [body-parser](https://github.com/expressjs/body-parser) module used before adding the protect middleware\n* `options.loggerFunction`: you can provide a logger function for the middleware to log attacks\n  * default: `noop`\n\n#### `protect.express.rateLimiter([options])`\n\nReturns an Express middleware, which ratelimits\n\n* `options.id`: function that returns the id used for ratelimiting - gets the `request` as its' first parameter\n  * required\n  * example: `(request) => request.connection.remoteAddress`\n* `options.db`: redis connection instance\n  * required\n* `options.max`: max requests within `options.duration`\n  * default: 2500\n* `options.max`: of limit in milliseconds\n  * default: 3600000\n* `options.loggerFunction`: you can provide a logger function for the middleware to log attacks\n  * default: `noop`\n\n#### `protect.express.headers([options])`\n\nThe headers object is a reference to the main `helmet` object exported. \nFor docs on the options object, please refer to the [helmet documentation](https://github.com/helmetjs/helmet).\n\n### Roadmap\n\n* block security scanners\n* schell / code injection protection\n* [what would you add?](https://github.com/RisingStack/protect/issues)\n\n### Security Recommendations\n\nAs mentioned, this module isn't a silver bullet to solve your security issues completely.  The following information is provided to hopefully point you in the right direction for solving other security concerns or alternatives that may be useful based on your budget or scale.\n\n#### Other Aspects\n\nThere are plenty of other areas that you should be concerned about when it comes to security, that this module doesn't cover (yet or won't) for various reasons.  Here are a few that are worth researching:\n\n* [Password Hashing](https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet)\n  * Bcrypt modules: [bcrypt](https://www.npmjs.com/package/bcrypt),[bcryptjs](https://www.npmjs.com/package/bcryptjs), [bcrypt-as-promised](https://www.npmjs.com/package/bcrypt-as-promised) \n  * Scrypt modules: [scrypt](https://www.npmjs.com/package/scrypt), [scryptsy](https://www.npmjs.com/package/scryptsy), [scrypt-async](https://www.npmjs.com/package/scrypt-async)\n* [NoSQL Injection](https://www.owasp.org/index.php/Testing_for_NoSQL_injection)\n* [Session management](https://www.owasp.org/index.php/Session_Management_Cheat_Sheet)\n* [CSRF - Cross Site Request Forgery](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet)\n  * [CSURF Express Module](https://www.npmjs.com/package/csurf)\n* Signed Cookies: [cookie-parser Express Module](https://expressjs.com/en/resources/middleware/cookie-parser.html)\n\n#### Resources\n\n* [OWASP -Open Web Application Security Project](https://www.owasp.org/index.php/Main_Page)\n* [Express: Production Best Practices](https://expressjs.com/en/advanced/best-practice-security.html)\n* [RisingStack: Node.js Security Checklist](https://blog.risingstack.com/node-js-security-checklist/)\n\n#### Dedicated WAF\n\nIf you have the resources available (budget or hosting environment), a dedicated WAF (Web Application Firewall) can offer a robust solution to various security issues, such as blocking potential attackers and flagging their activity.\n\n* [OWASP WAF information](https://www.owasp.org/index.php/Web_Application_Firewall)\n* Hosting providers:\n  * [AWS WAF](https://aws.amazon.com/waf/)\n  * [Microsoft Azure WAF](https://docs.microsoft.com/en-us/azure/application-gateway/application-gateway-web-application-firewall-overview)\n* [ModSecurity]() - Apache, nginX and other web servers.\n* [CloudFlare](https://www.cloudflare.com/) - External WAF features.\n\n"