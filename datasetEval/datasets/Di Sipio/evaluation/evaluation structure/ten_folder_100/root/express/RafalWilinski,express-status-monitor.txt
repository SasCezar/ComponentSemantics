b'# express-status-monitor\n\n[![Dependency Status](https://david-dm.org/RafalWilinski/express-status-monitor/status.svg?style=flat)](https://david-dm.org/RafalWilinski/express-status-monitor) [![devDependencies Status](https://david-dm.org/RafalWilinski/express-status-monitor/dev-status.svg)](https://david-dm.org/RafalWilinski/express-status-monitor?type=dev)\n[![Gitter](https://badges.gitter.im/Join%20Chat.svg)](https://gitter.im/express-status-monitor/Lobby/?utm_source=badge&utm_medium=badge&utm_campaign=pr-badge)\n[![express-status-monitor on npm](https://img.shields.io/npm/v/express-status-monitor.svg)](https://www.npmjs.com/express-status-monitor)\n[![npm](https://img.shields.io/npm/dt/express-status-monitor.svg)](https://img.shields.io/npm/dt/express-status-monitor.svg)\n[![CircleCI](https://img.shields.io/circleci/project/github/RafalWilinski/express-status-monitor/master.svg)](https://circleci.com/gh/RafalWilinski/express-status-monitor)\n[![Open Source Helpers](https://www.codetriage.com/rafalwilinski/express-status-monitor/badges/users.svg)](https://www.codetriage.com/rafalwilinski/express-status-monitor)\n\nSimple, self-hosted module based on Socket.io and Chart.js to report realtime server metrics for Express-based node servers.\n\n![Monitoring Page](http://i.imgur.com/AHizEWq.gif "Monitoring Page")\n\n## Demo\n\n[Demo available here](https://hackathon-starter.walcony.com/status)\n\n## Support for other Node.js frameworks\n\n* [koa-monitor](https://github.com/capaj/koa-monitor) for Koa\n* [hapijs-status-monitor](https://github.com/ziyasal/hapijs-status-monitor) for hapi.js\n\n## Installation & setup\n\n1. Run `npm install express-status-monitor --save`\n2. Before any other middleware or router add following line:\n`app.use(require(\'express-status-monitor\')());`\n3. Run server and go to `/status`\n\nNote: This plugin works on Node versions > 4.x\n\n## Run examples\n\n1. Go to `cd examples/`\n2. Run `npm i`\n3. Run server `npm start`\n4. Go to `http://0.0.0.0:3000`\n\n## Options\n\nMonitor can be configured by passing options object into `expressMonitor` constructor.\n\nDefault config:\n```javascript\ntitle: \'Express Status\',  // Default title\ntheme: \'default.css\',     // Default styles\npath: \'/status\',\nsocketPath: \'/socket.io\', // In case you use a custom path\nwebsocket: existingSocketIoInstance,\nspans: [{\n  interval: 1,            // Every second\n  retention: 60           // Keep 60 datapoints in memory\n}, {\n  interval: 5,            // Every 5 seconds\n  retention: 60\n}, {\n  interval: 15,           // Every 15 seconds\n  retention: 60\n}],\nchartVisibility: {\n  cpu: true,\n  mem: true,\n  load: true,\n  responseTime: true,\n  rps: true,\n  statusCodes: true\n},\nhealthChecks: [],\nignoreStartsWith: \'/admin\'\n\n```\n\n## Health Checks\n\nYou can add a series of health checks to the configuration that will appear below the other stats. The health check will be considered successful if the endpoint returns a 200 status code.\n\n```javascript\n// config\nhealthChecks: [{\n  protocol: \'http\',\n  host: \'localhost\',\n  path: \'/admin/health/ex1\',\n  port: \'3000\'\n}, {\n  protocol: \'http\',\n  host: \'localhost\',\n  path: \'/admin/health/ex2\',\n  port: \'3000\'\n}]\n```\n\n![Health Checks](https://i.imgur.com/6tY4OhA.png "Health Checks")\n\n## Securing endpoint\n\nThe HTML page handler is exposed as a `pageRoute` property on the main\nmiddleware function.  So the middleware is mounted to intercept all requests\nwhile the HTML page handler will be authenticated.\n\nExample using https://www.npmjs.com/package/connect-ensure-login\n```javascript\nconst ensureLoggedIn = require(\'connect-ensure-login\').ensureLoggedIn()\n\nconst statusMonitor = require(\'express-status-monitor\')();\napp.use(statusMonitor);\napp.get(\'/status\', ensureLoggedIn, statusMonitor.pageRoute)\n```\n\nCredits to [@mattiaerre](https://github.com/mattiaerre)\n\nExample using [http-auth](https://www.npmjs.com/package/http-auth)\n```javascript\nconst auth = require(\'http-auth\');\nconst basic = auth.basic({realm: \'Monitor Area\'}, function(user, pass, callback) {\n  callback(user === \'username\' && pass === \'password\');\n});\n\n// Set \'\' to config path to avoid middleware serving the html page (path must be a string not equal to the wanted route)\nconst statusMonitor = require(\'express-status-monitor\')({ path: \'\' });\napp.use(statusMonitor.middleware); // use the "middleware only" property to manage websockets\napp.get(\'/status\', auth.connect(basic), statusMonitor.pageRoute); // use the pageRoute property to serve the dashboard html page\n```\n\n## Using module with socket.io in project\n\nIf you\'re using socket.io in your project, this module could break your project because this module by default will spawn its own socket.io instance. To mitigate that, fill websocket parameter with your main socket.io instance as well as port parameter.\n\n## Tests and coverage\n\nIn order to run test and coverage use the following npm commands:\n```\nnpm test\nnpm run coverage\n```\n\n## License\n\n[MIT License](https://opensource.org/licenses/MIT) \xc2\xa9 Rafal Wilinski\n'